(window.webpackJsonp=window.webpackJsonp||[]).push([[175],{490:function(t,s,a){"use strict";a.r(s);var n=a(7),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"gitea-k8s-jenkins-master-slave-webhooké’©å­"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gitea-k8s-jenkins-master-slave-webhooké’©å­"}},[t._v("#")]),t._v(" Gitea+K8s-Jenkins-master-slave(webhooké’©å­)")]),t._v(" "),s("h2",{attrs:{id:"èŠ‚ç‚¹è§„åˆ’"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#èŠ‚ç‚¹è§„åˆ’"}},[t._v("#")]),t._v(" èŠ‚ç‚¹è§„åˆ’")]),t._v(" "),s("p",[t._v("æœåŠ¡å™¨è§„åˆ’ï¼šcentos7.9.2009æœ€å°åŒ–å®‰è£…")]),t._v(" "),s("p",[t._v("å½“å‰çš„k8så®¹å™¨åº•å±‚ä¸º "),s("code",[t._v("containerd")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("ä¸»æœºåç§°")]),t._v(" "),s("th",[t._v("IPåœ°å€")]),t._v(" "),s("th",[t._v("èŠ‚ç‚¹")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("k8s-master")]),t._v(" "),s("td",[t._v("10.11.121.111")]),t._v(" "),s("td",[t._v("Jenkins")])]),t._v(" "),s("tr",[s("td",[t._v("k8s-node1")]),t._v(" "),s("td",[t._v("10.11.121.112")]),t._v(" "),s("td",[t._v("node")])]),t._v(" "),s("tr",[s("td",[t._v("k8s-node2")]),t._v(" "),s("td",[t._v("10.11.121.113")]),t._v(" "),s("td",[t._v("Gitea/NFSå­˜å‚¨")])])])]),t._v(" "),s("h2",{attrs:{id:"éƒ¨ç½²jenkinså’Œgitea"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#éƒ¨ç½²jenkinså’Œgitea"}},[t._v("#")]),t._v(" éƒ¨ç½²Jenkinså’ŒGitea")]),t._v(" "),s("h3",{attrs:{id:"_1-éƒ¨ç½²åŠ¨æ€ä¾›åº”"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-éƒ¨ç½²åŠ¨æ€ä¾›åº”"}},[t._v("#")]),t._v(" 1.éƒ¨ç½²åŠ¨æ€ä¾›åº”")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://cn-zhangyh.gitee.io/cn-zhangyh/2022/02/02/Kubernetes/NFS%E5%81%9AK8S%E5%90%8E%E7%AB%AF%E5%AD%98%E5%82%A8/",target:"_blank",rel:"noopener noreferrer"}},[t._v("éƒ¨ç½²NFSåŠ¨æ€ä¾›åº”"),s("OutboundLink")],1),t._v("   ðŸ‘ˆ")]),t._v(" "),s("h3",{attrs:{id:"_2-éƒ¨ç½²gitea"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-éƒ¨ç½²gitea"}},[t._v("#")]),t._v(" 2.éƒ¨ç½²Gitea")]),t._v(" "),s("p",[t._v("1.æŸ¥çœ‹å½“å‰çš„StorageClassçš„å­˜å‚¨æƒ…å†µï¼š")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kubectl get sc ")]),t._v("\nNAME                    PROVISIONER       RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE\nstorage-nfs "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   storage.pri/nfs   Delete          Immediate           "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("                  5h23m\n")])])]),s("p",[t._v("2.ä½¿ç”¨Dockerå¯åŠ¨ä¸€ä¸ªGiteaçš„å®¹å™¨")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run -d \\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" gitea  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("222")]),t._v(":22 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),t._v(":3000 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /etc/timezone:/etc/timezone:ro "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /etc/localtime:/etc/localtime:ro "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /data/gitea:/data "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\ngitea/gitea:latest\n")])])]),s("p",[t._v("3.ä¿®æ”¹gietaçš„é…ç½®æ–‡ä»¶å¹¶ä¸”é‡å¯giteaå®¹å™¨")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vim /data/gitea/gitea/conf/app.ini")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#åœ¨app.inié…ç½®æ–‡ä»¶æœ€åŽæ·»åŠ ä¸‹é¢è¿™ä¸ªé…ç½®")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("webhook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nALLOWED_HOST_LIST "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" *\n")])])]),s("p",[t._v("3.è®¿é—®Giteaï¼š http://10.11.121.113:3000")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281611425.png",alt:"image-20220428161101095"}})]),t._v(" "),s("p",[t._v("æ³¨å†Œä¸€ä¸ªè´¦å·è®¾ç½®ç”¨æˆ·åå¯†ç ç»‘å®šé‚®ç®±")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281612449.png",alt:"image-20220428161255840"}})]),t._v(" "),s("p",[t._v("åˆ›å»ºä¸€ä¸ªé¡¹ç›®ä»“åº“ï¼Œä»“åº“çš„åç§°å«åšdevopsã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281614793.png",alt:"image-20220428161433529"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281614050.png",alt:"image-20220428161453722"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281615328.png",alt:"image-20220428161511332"}})]),t._v(" "),s("h3",{attrs:{id:"_3-éƒ¨ç½²jenkins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-éƒ¨ç½²jenkins"}},[t._v("#")]),t._v(" 3.éƒ¨ç½²Jenkins")]),t._v(" "),s("p",[t._v("æœ€æ–°ç‰ˆé•œåƒ")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("jenkins/jenkins:lts")])])]),t._v(" "),s("p",[t._v("å½“å‰ä½¿ç”¨çš„é•œåƒ")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("jenkins/jenkins:lts-jdk11")])])]),t._v(" "),s("p",[t._v("å…³é—­Jenkinsçš„CSRF")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("Dhudson.security.csrf.GlobalCrumbIssuerConfiguration.DISABLE_CSRF_PROTECTION=true")])])]),t._v(" "),s("p",[t._v("éƒ¨ç½²è¦æ±‚ï¼š")]),t._v(" "),s("ol",[s("li",[t._v("åˆ›å»ºRBACç­–ç•¥ï¼Œç»‘å®šJenkins")]),t._v(" "),s("li",[t._v("åˆ›å»ºDeploymentä½œä¸ºJenkinså®¹å™¨æŽ§åˆ¶å™¨")]),t._v(" "),s("li",[t._v("åˆ›å»ºServiceçš„æœåŠ¡æš´éœ²Jenkinsçš„ç«¯å£")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("master ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mkdir /opt/jenkins && cd /opt/jenkins/")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("master jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat > Jenkins-rbac.yaml << EOF")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Namespace\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ServiceAccount\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" rbac.authorization.k8s.io/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ClusterRole\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("annotations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rbac.authorization.kubernetes.io/autoupdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kubernetes.io/bootstrapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" rbac"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("defaults\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiGroups")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("resources")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" statefulsets\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" services\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" replicationcontrollers\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" replicasets\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" podtemplates\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" podsecuritypolicies\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" pods\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" pods/log\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" pods/exec\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" podpreset\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" poddisruptionbudget\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" persistentvolumes\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" persistentvolumeclaims\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" jobs\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" endpoints\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" deployments\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" deployments/scale\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" daemonsets\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" cronjobs\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" configmaps\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" namespaces\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" events\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" secrets\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("verbs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" create\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" get\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" watch\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" delete\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" list\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" patch\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" update\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiGroups")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("resources")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" nodes\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("verbs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" get\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" list\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" watch\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" update\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" rbac.authorization.k8s.io/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ClusterRoleBinding\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("annotations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rbac.authorization.kubernetes.io/autoupdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kubernetes.io/bootstrapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" rbac"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("defaults\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("roleRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiGroup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" rbac.authorization.k8s.io\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ClusterRole\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("subjects")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiGroup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" rbac.authorization.k8s.io\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Group\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" system"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("serviceaccounts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("jenkins\nEOF\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("master jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat > Jenkins-Deployment.yaml << EOF")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" apps/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deployment\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("replicas")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matchLabels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins/jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("lts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("jdk11\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containerPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" web\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("protocol")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TCP\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containerPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50000")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" agent\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("protocol")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TCP\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#resources:")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#limits:")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#memory: 4Gi")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#cpu: "2000m"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#requests:")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#memory: 4Gi")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#cpu: "2000m"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" LIMITS_MEMORY\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("valueFrom")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("resourceFieldRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("resource")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" limits.memory\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("divisor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 1Mi\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" JAVA_OPTS\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Dhudson.security.csrf.GlobalCrumbIssuerConfiguration.DISABLE_CSRF_PROTECTION=true\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumeMounts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("home\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mountPath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /var/jenkins_home\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("home\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("persistentVolumeClaim")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("claimName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("home\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  PersistentVolumeClaim\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("home\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storageClassName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"storage-nfs"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("accessModes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ReadWriteOnce"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("resources")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("requests")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 20Gi\nEOF\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("master jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat > Jenkins-Service.yaml << EOF")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Service\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkins\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" NodePort\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" web\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targetPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" web\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nodePort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("31000")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" agent\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50000")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targetPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" agent\nEOF\n")])])]),s("p",[t._v("åˆ›å»ºæ‰€æœ‰çš„yamlæ–‡ä»¶ã€‚")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  kubectl apply -f Jenkins-rbac.yaml -f Jenkins-Deployment.yaml -f Jenkins-Service.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kubectl get -n jenkins all ")]),t._v("\nNAME                           READY   STATUS    RESTARTS   AGE\npod/jenkins-746b5b5d65-tllqz   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          30s\n\nNAME              TYPE       CLUSTER-IP      EXTERNAL-IP   PORT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("S"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("                          AGE\nservice/jenkins   NodePort   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.96")]),t._v(".213.109   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v(":31000/TCP,50000:31204/TCP   24s\n\nNAME                      READY   UP-TO-DATE   AVAILABLE   AGE\ndeployment.apps/jenkins   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("           30s\n\nNAME                                 DESIRED   CURRENT   READY   AGE\nreplicaset.apps/jenkins-746b5b5d65   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("       30s\n")])])]),s("h3",{attrs:{id:"_4-é…ç½®jenkins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-é…ç½®jenkins"}},[t._v("#")]),t._v(" 4.é…ç½®Jenkins")]),t._v(" "),s("p",[t._v("å®‰è£…Jenkinsæ’ä»¶")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("Localization: Chinese (Simplified)")])]),t._v(" "),s("p",[s("strong",[t._v("Pipeline")])]),t._v(" "),s("p",[s("strong",[t._v("Kubernetes")])])]),t._v(" "),s("p",[t._v("1ã€ä½¿ç”¨å‘½ä»¤ "),s("code",[t._v("kubectl exec -it $jenkins-pod cat /var/jenkins_home/secrets/initialAdminPassword")]),t._v("æŸ¥çœ‹å¯†ç ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281629183.png",alt:"image-20220428162947367"}})]),t._v(" "),s("p",[t._v("2ã€é€‰æ‹©æ’ä»¶æ¥å®‰è£…")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281634537.png",alt:"image-20220428163450111"}})]),t._v(" "),s("p",[t._v("3ã€è¿™é‡Œå‹¾é€‰æ— ï¼Œåªéœ€è¦å†åŽé¢é€‰æ‹©çš„æ—¶å€™å†å®‰è£…æ’ä»¶å³å¯ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281635414.png",alt:"image-20220428163519250"}})]),t._v(" "),s("p",[t._v("4ã€åˆ›å»ºä¸€ä¸ªç”¨æˆ·ç™»å½•ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281636813.png",alt:"image-20220428163601694"}})]),t._v(" "),s("p",[t._v("5ã€é…ç½®Jenkinsä½¿ç”¨å›½å†…çš„æº")]),t._v(" "),s("p",[t._v("é…ç½®æ’ä»¶æº é»˜è®¤ä»Žå›½å¤–ç½‘ç»œä¸‹è½½æ’ä»¶ï¼Œä¼šæ¯”è¾ƒæ…¢ï¼Œå»ºè®®ä¿®æ”¹æˆå›½å†…æºï¼š")]),t._v(" "),s("p",[t._v("åªéœ€è¦åˆ°nfsä¸Šï¼Œä¿®æ”¹PVCæŒ‚è½½çš„å†…å®¹å³å¯")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master nfsmount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd jenkins-jenkins-home-pvc-1175cde6-4c32-45b1-bed2-7c90ac173972/")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master jenkins-jenkins-home-pvc-1175cde6-4c32-45b1-bed2-7c90ac173972"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd updates/")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master updates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls ")]),t._v("\ndefault.json  hudson.tasks.Maven.MavenInstaller\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'å…ˆå¤‡ä»½å¥½é…ç½®æ–‡ä»¶'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master updates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cp default.json default.json.bak  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ä¿®æ”¹æ’ä»¶çš„ä¸‹è½½åœ°å€ä¸ºå›½å†…çš„åœ°å€'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master updates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sed -i s#https://updates.jenkins.io/download#https://mirrors.tuna.tsinghua.edu.cn/jenkins#g default.json")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ä¿®æ”¹jenkinså¯åŠ¨æ—¶æ£€æµ‹çš„URLç½‘å€ï¼Œæ”¹ä¸ºå›½å†…baiduçš„åœ°å€'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master updates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sed -i s#http://www.google.com#https://www.baidu.com#g default.json default.json")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'åˆ é™¤podé‡å»ºï¼ˆpodåç§°æ”¹æˆä½ å®žé™…çš„ï¼‰'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master updates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kubectl delete pod -n jenkins jenkins-746b5b5d65-tllqz ")]),t._v("\npod "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jenkins-746b5b5d65-tllqz"')]),t._v(" deleted\n")])])]),s("p",[t._v("6ã€å®‰è£…éœ€è¦çš„æ’ä»¶ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281637805.png",alt:"image-20220428163722651"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281644931.png",alt:"image-20220428164417284"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281648388.png",alt:"image-20220428164845529"}})]),t._v(" "),s("p",[t._v("7ã€é…ç½®jenkinsè¿žæŽ¥k8s")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("https://kubernetes.default\nhttp://jenkins.jenkins:8080\n")])])]),s("p",[t._v("æˆ–è€…")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¯ä»¥æ˜¯apiserverçš„åœ°å€")]),t._v("\nhttps://kubernetes.default.svc.cluster.local\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è¿™é‡Œæ˜¯jenkinså‘½åç©ºé—´ä¸‹çš„jenkinsåœ°å€")]),t._v("\nhttp://jenkins.jenkins.svc.cluster.local:8080\n")])])]),s("p",[t._v("é€‰æ‹© "),s("code",[t._v("ç³»ç»Ÿç®¡ç† > èŠ‚ç‚¹ç®¡ç†")]),t._v(" æ‰¾åˆ°"),s("code",[t._v("Config cloud")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281651387.png",alt:"image-20220428165131338"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281652416.png",alt:"image-20220428165213779"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281653338.png",alt:"image-20220428165312671"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281654698.png",alt:"image-20220428165414797"}})]),t._v(" "),s("p",[t._v("8ã€åœ¨å…¨å±€å®‰å…¨é…ç½®ä¸­å¼€å¯ï¼ˆåŒ¿åç”¨æˆ·å…·æœ‰å¯è¯»æƒé™ ï¼‰")]),t._v(" "),s("blockquote",[s("p",[t._v("åœ¨å…¨å±€å®‰å…¨é…ç½®ä¸­çš„æŽˆæƒç­–ç•¥ æŠŠç™»å½•ç”¨æˆ·å¯ä»¥åšä»»ä½•äº‹ ä¸‹çš„åŒ¿åç”¨æˆ·å…·æœ‰å¯è¯»æƒé™ å‹¾ä¸Š")]),t._v(" "),s("p",[t._v("åœ¨å…¨å±€å®‰å…¨é…ç½®ä¸­å…³é—­è·¨ç«™è¯·æ±‚ä¼ªé€ ä¿æŠ¤ ï¼ˆåœ¨å®‰è£…Jenkinså…³é—­ï¼‰")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281656035.png",alt:"image-20220428165621671"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281657769.png",alt:"image-20220428165704227"}})]),t._v(" "),s("p",[t._v("9ã€ç»™jenkinsç”¨æˆ·æ·»åŠ æ–°Tokenï¼ˆç‚¹å‡»å³ä¸Šè§’jenkinsç”¨æˆ·ï¼Œç„¶åŽç‚¹è®¾ç½®å°±å¯ä»¥è·³è½¬åˆ°é…ç½®Tokené¡µé¢ï¼‰")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281658697.png",alt:"image-20220428165800549"}})]),t._v(" "),s("h3",{attrs:{id:"_5-pipeline-åŠ¨æ€pod"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-pipeline-åŠ¨æ€pod"}},[t._v("#")]),t._v(" 5.Pipelineï¼ˆåŠ¨æ€podï¼‰")]),t._v(" "),s("p",[t._v("åˆ›å»ºä¸€ä¸ªpipelineæµæ°´çº¿æµ‹è¯•")]),t._v(" "),s("blockquote",[s("p",[t._v("åœ¨æž„å»ºè§¦å‘å™¨ ä¸­å‹¾ä¸Š ï¼šè§¦å‘è¿œç¨‹æž„å»º (ä¾‹å¦‚,ä½¿ç”¨è„šæœ¬)")]),t._v(" "),s("p",[t._v("èº«ä»½éªŒè¯ä»¤ç‰Œ å°±å¡«ä¸Šé¢åˆ›å»ºçš„Token")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[t._v("pipeline "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    agent "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        kubernetes "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            yaml '''\napiVersion"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" v1\nkind"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Pod\nmetadata"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" jenkins-slave\n  namespace"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" jenkins\nspec"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  containers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  - name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" jnlp\n    image"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" jenkins/inbound-agent"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("latest\n    volumeMounts"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n'''\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    stages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        stage('"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("ã€æ‹‰å–ä»£ç ') "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            steps "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                echo 'Hello World'\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        stage('"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("ã€ä»£ç ç¼–è¯‘') "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            steps "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                echo 'Hello World'\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        stage('"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("ã€å•å…ƒæµ‹è¯•') "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            steps "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                echo 'Hello World'\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        stage('"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("ã€éƒ¨ç½²') "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            steps "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                echo 'Hello World'\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("1ã€æ–°å»ºä¸€ä¸ªæµæ°´çº¿é¡¹ç›®")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281700145.png",alt:"image-20220428170019107"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281700064.png",alt:"image-20220428170057187"}})]),t._v(" "),s("p",[t._v("2ã€é…ç½®æµæ°´çº¿çš„è„šæœ¬ï¼Œæµ‹è¯•åŠ¨æ€Podã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281701777.png",alt:"image-20220428170129138"}})]),t._v(" "),s("p",[t._v("3ã€ä¿å­˜é€€å‡ºä¹‹åŽï¼Œå•å‡»ç«‹å³æž„å»ºã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281702584.png",alt:"image-20220428170238496"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204281703991.png",alt:"image-20220428170301767"}})]),t._v(" "),s("h3",{attrs:{id:"_6-åˆ›å»ºä¸€ä¸ªä»“åº“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-åˆ›å»ºä¸€ä¸ªä»“åº“"}},[t._v("#")]),t._v(" 6.åˆ›å»ºä¸€ä¸ªä»“åº“")]),t._v(" "),s("p",[t._v("åœ¨giteaåˆ›å»ºä¸€ä¸ªåå­—ä¸ºdevopsä»“åº“ï¼Œåœ¨æ­¤ä¹‹å‰æˆ‘ä»¬å·²ç»åˆ›å»ºå¥½äº†ï¼ŒçŽ°åœ¨åªéœ€è¦ä¸Šä¼ å°±å¥½ã€‚")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master demo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# echo  add index.html  > README.md")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master demo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git init ")]),t._v("\nInitialized empty Git repository "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /root/demo/.git/\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master demo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git add README.md")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master demo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# git commit -m "first commit"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("master "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("root-commit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" 315edf5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" first commit\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" changed, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" insertion"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("+"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n create mode "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100644")]),t._v(" README.md\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master demo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  git remote add origin http://10.11.121.113:3000/devops/devops.git")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master demo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git push -u origin master")]),t._v("\nUsername "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://10.11.121.113:3000'")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" devops\nPassword "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://devops@10.11.121.113:3000'")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" \nCounting objects: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(", done.\nWriting objects: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("% "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("/3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("224")]),t._v(" bytes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" bytes/s, done.\nTotal "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", reused "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nremote: "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" Processing "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" references\nremote: Processed "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" references "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" total\nTo http://10.11.121.113:3000/devops/devops.git\n * "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("new branch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("      master -"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" master\nBranch master "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" up to track remote branch master from origin.\n")])])]),s("p",[t._v("æŸ¥çœ‹å½“å‰çš„ä»“åº“æºç ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204282010035.png",alt:"image-20220428201010960"}})]),t._v(" "),s("h3",{attrs:{id:"_7-é…ç½®webhooké’©å­"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-é…ç½®webhooké’©å­"}},[t._v("#")]),t._v(" 7.é…ç½®webhooké’©å­")]),t._v(" "),s("p",[t._v("1.è®¾ç½®giteaçš„Webhookçš„è®¾ç½®ï¼Œé…ç½®webhookçš„é’©å­ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204282013376.png",alt:"image-20220428201350078"}})]),t._v(" "),s("p",[t._v("2.æŸ¥çœ‹å½“å‰çš„Jenkinsçš„æµæ°´çº¿é…ç½®ï¼Œè®¾ç½®å¼€å¯è§¦å‘è¿œç¨‹æž„å»ºã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204282026159.png",alt:"image-20220428202634071"}})]),t._v(" "),s("p",[t._v("æµ‹è¯•ä¸€ä¸‹æŽ¨é€ä»£ç ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204282027819.png",alt:"image-20220428202747917"}})]),t._v(" "),s("h3",{attrs:{id:"_8-æŽ¨ä»£ç æµ‹è¯•é’©å­"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-æŽ¨ä»£ç æµ‹è¯•é’©å­"}},[t._v("#")]),t._v(" 8.æŽ¨ä»£ç æµ‹è¯•é’©å­")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master demo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git clone http://10.11.121.113:3000/devops/devops.git   #å…ˆå…‹éš†ä»“åº“")]),t._v("\nCloning into "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'devops'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nremote: Enumerating objects: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(", done.\nremote: Counting objects: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("% "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("/3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", done.\nremote: Total "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", reused "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", pack-reused "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nUnpacking objects: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("% "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("/3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", done.\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master demo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd devops/         #è¿›å…¥ä»“åº“")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master devops"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# echo  abc > index.html #åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æ¥æ¨¡æ‹Ÿä»“åº“ä»£ç æ”¹åŠ¨")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master devops"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git add .")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master devops"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# git commit -m "add index.html two"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("master 91cc098"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" index.html two\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" changed, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" insertion"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("+"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n create mode "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100644")]),t._v(" index.html\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@k8s-master devops"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git push  origin master")]),t._v("\nUsername "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://10.11.121.113:3000'")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" devops\nPassword "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://devops@10.11.121.113:3000'")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" \nCounting objects: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(", done.\nDelta compression using up to "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" threads.\nCompressing objects: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("% "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("/2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", done.\nWriting objects: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("% "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("/3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("284")]),t._v(" bytes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" bytes/s, done.\nTotal "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", reused "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nremote: "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" Processing "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" references\nremote: Processed "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" references "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" total\nTo http://10.11.121.113:3000/devops/devops.git\n   315edf5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("91cc098  master -"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" master\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æäº¤åŽï¼Œå›žåˆ°jenkinsé¡µé¢ï¼ŒæŸ¥çœ‹æ˜¯å¦æˆåŠŸè‡ªåŠ¨è§¦å‘æž„å»ºä»£ç ")]),t._v("\n")])])]),s("p",[t._v("ä»¥ä¸‹æ˜¯è‡ªåŠ¨è§¦å‘æž„å»ºã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204282032967.png",alt:"image-20220428203202702"}})])])}),[],!1,null,null,null);s.default=e.exports}}]);