(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{337:function(s,t,a){"use strict";a.r(t);var n=a(7),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"基于docker容器的web应用系统部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基于docker容器的web应用系统部署"}},[s._v("#")]),s._v(" 基于Docker容器的Web应用系统部署")]),s._v(" "),t("p",[s._v("创建一个项目叫做Work的在里面完成任务，分别再创建redis,mariabd,kafka,zookeeper,nginx,docker-compose。")]),s._v(" "),t("h3",{attrs:{id:"【题目1】redis容器化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目1】redis容器化"}},[s._v("#")]),s._v(" 【题目1】Redis容器化")]),s._v(" "),t("p",[s._v("在master节点上编写/root/redis/Dockerfile文件构建chinaskill-redis:v1.1镜像，具体要求如下：")]),s._v(" "),t("p",[s._v("（1）基础镜像：centos:centos7.5.1804；")]),s._v(" "),t("p",[s._v("（2）作者：Chinaskill；")]),s._v(" "),t("p",[s._v("（3）修改配置文件中的bind 127.0.0.1为bind 0.0.0.0；")]),s._v(" "),t("p",[s._v("（4）设置Redis免密，并关闭保护模式；")]),s._v(" "),t("p",[s._v("（5）开放端口：6379；")]),s._v(" "),t("p",[s._v("（6）设置服务开机自启。")]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Chinaskill")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" rm -rf /etc/yum.repos.d/*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" local.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum install -y redis")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 6379")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" sed -i -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s/^bind 127.0.0.1/bind 0.0.0.0/g"')]),s._v(" /etc/redis.conf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" sed -i -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s/^protected-mode yes/protected-mode no/g"')]),s._v(" /etc/redis.conf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/redis-server"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/redis.conf"')]),s._v("]")]),s._v("\n\n[root@master redis]# docker build -t='chinaskill-redis:v1.1' .\n")])])]),t("h3",{attrs:{id:"【题目2】mariadb容器化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目2】mariadb容器化"}},[s._v("#")]),s._v(" 【题目2】Mariadb容器化")]),s._v(" "),t("p",[s._v("在master节点上编写/root/mariadb/Dockerfile文件构建chinaskill-mariadb:v1.1镜像，具体要求如下：")]),s._v(" "),t("p",[s._v("（1）基础镜像：centos:centos7.5.1804；")]),s._v(" "),t("p",[s._v("（2）作者：Chinaskill；")]),s._v(" "),t("p",[s._v("（3）设置数据库密码：123456；")]),s._v(" "),t("p",[s._v("（4）创建数据库gpmall并导入数据库文件gpmall.sql；")]),s._v(" "),t("p",[s._v("（5）设置数据库字符编码：UTF-8；")]),s._v(" "),t("p",[s._v("（6）开放端口：3306；")]),s._v(" "),t("p",[s._v("（7）设置服务开机自启。")]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Chinaskill")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" rm -rf /etc/yum.repos.d/*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" local.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum install -y mariadb mariadb-server")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" run.sh /root/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" gpmall.sql /root/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" chmod a+x /root/run.sh && /root/run.sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" LC_ALL en_US.UTF-8")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 3306")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" mysqld_safe")]),s._v("\n\n\n[root@master mariadb]# cat run.sh  \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash  ")]),s._v("\nsleep 5  \nmysqld_safe &  \nsleep 5  \nmysqladmin  -uroot password 123456\nmysql -uroot -p123456 -e \"grant all on *.* to root@'%' identified by '123456'; \"\nmysql -uroot -p123456 -e \"create database gpmall;use gpmall;source /root/gpmall.sql; \"\n\n\n[root@master redis]# docker build -t='chinaskill-mariadb:v1.1' .\n")])])]),t("h3",{attrs:{id:"【题目3】zookeeper容器化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目3】zookeeper容器化"}},[s._v("#")]),s._v(" 【题目3】Zookeeper容器化")]),s._v(" "),t("p",[s._v("在master节点上编写/root/zookeeper/Dockerfile文件构建chinaskill-zookeeper:v1.1镜像，具体要求如下：")]),s._v(" "),t("p",[s._v("（1）基础镜像：centos:centos7.5.1804；")]),s._v(" "),t("p",[s._v("（2）作者：Chinaskill；")]),s._v(" "),t("p",[s._v("（3）开放端口：2181；")]),s._v(" "),t("p",[s._v("（4）设置服务开机自启。")]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Chinaskill")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" rm -rf /etc/yum.repos.d/*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" local.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum install -y java-1.8.0-openjdk java-1.8.0-openjdk-devel")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" mkdir /opt/zookeeper")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" zookeeper-3.4.14.tar.gz /opt/zookeeper/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"source /root/.bash_profile"')]),s._v(" > /opt/zookeeper/start.sh &&"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cp /opt/zookeeper/zookeeper-3.4.14/conf/zoo_sample.cfg /opt/zookeeper/zookeeper-3.4.14/conf/zoo.cfg"')]),s._v(" >> /opt/zookeeper/start.sh &&"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/zookeeper/zookeeper-3.4.14/bin/zkServer.sh start-foreground"')]),s._v(" >> /opt/zookeeper/start.sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 2181")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sh"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/zookeeper/start.sh"')]),s._v("]")]),s._v("\n \n\n[root@master zookeeper]# docker build -t='chinaskill-zookeeper:v1.1' .\n")])])]),t("h3",{attrs:{id:"【题目4】kafka容器化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目4】kafka容器化"}},[s._v("#")]),s._v(" 【题目4】Kafka容器化")]),s._v(" "),t("p",[s._v("在master节点上编写/root/kafka/Dockerfile文件构建chinaskill-kafka:v1.1镜像，具体要求如下：")]),s._v(" "),t("p",[s._v("（1）基础镜像：centos:centos7.5.1804；")]),s._v(" "),t("p",[s._v("（2）作者：Chinaskill；")]),s._v(" "),t("p",[s._v("（3）开放端口：9092；")]),s._v(" "),t("p",[s._v("（4）设置服务开机自启。")]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Chinaskill")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" rm -rf /etc/yum.repos.d/*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" local.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum install -y java-1.8.0-openjdk java-1.8.0-openjdk-devel")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" mkdir /opt/kafka")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" kafka_2.11-1.1.1.tgz /opt/kafka")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" sed -i -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s/num.partitions.*$/num.partitions=3/g"')]),s._v(" /opt/kafka/kafka_2.11-1.1.1/config/server.properties")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"source /root/.bash_profile"')]),s._v(" > /opt/kafka/start.sh &&"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cd /opt/kafka/kafka_2.11-1.1.1"')]),s._v(">> /opt/kafka/start.sh &&"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"sed -i 's%zookeeper.connect=.*$%zookeeper.connect=zookeeper:2181%g'  /opt/kafka/kafka_2.11-1.1.1/config/server.properties\"")]),s._v(" >> /opt/kafka/start.sh &&"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bin/kafka-server-start.sh config/server.properties"')]),s._v(" >> /opt/kafka/start.sh &&"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    chmod a+x /opt/kafka/start.sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 9092")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sh"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/kafka/start.sh"')]),s._v("]")]),s._v("\n\n\n[root@master zookeeper]# docker build -t='chinaskill-kafka:v1.1' .\n")])])]),t("h3",{attrs:{id:"【题目5】nginx容器化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目5】nginx容器化"}},[s._v("#")]),s._v(" 【题目5】Nginx容器化")]),s._v(" "),t("p",[s._v("在master节点上编写/root/nginx/Dockerfile文件构建chinaskill-nginx:v1.1镜像，具体要求如下：")]),s._v(" "),t("p",[s._v("（1）基础镜像：centos:centos7.5.1804；")]),s._v(" "),t("p",[s._v("（2）作者：Chinaskill；")]),s._v(" "),t("p",[s._v("（3）编写/etc/nginx/conf.d/default.conf文件，配置反向代理，将80端口请求转发到8081、8082和8083；")]),s._v(" "),t("p",[s._v("（4）将dist中的文件复制到/usr/share/nginx/html/目录下；")]),s._v(" "),t("p",[s._v("（5）复制所有的jar包到镜像中；")]),s._v(" "),t("p",[s._v("（6）开放端口：80、443、8081、8082、8083；")]),s._v(" "),t("p",[s._v("（7）设置服务开机自启。")]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[s._v("[root@master nginx]# ll\ntotal 199340\n-rw-r--r--.  1 root root     1312 May  5 10:19 default.conf\ndrwxr-xr-x.  3 root root       38 May  5 10:20 dist\n-rw-r--r--.  1 root root      673 May  5 10:19 Dockerfile\n-rw-r--r--.  1 root root      177 May  5 10:08 ftp.repo\n-rw-r--r--.  1 root root 47765224 Nov 11 11:22 gpmall-shopping-0.0.1-SNAPSHOT.jar\n-rw-r--r--.  1 root root 39005468 Nov 11 11:22 gpmall-user-0.0.1-SNAPSHOT.jar\n-rw-r--r--.  1 root root      727 Nov 10 17:14 index.html\n-rw-r--r--.  1 root root      270 Nov 11 11:27 run.sh\n-rw-r--r--.  1 root root 54936064 Nov 11 11:22 shopping-provider-0.0.1-SNAPSHOT.jar\ndrwxr-xr-x. 10 root root      101 Nov 10 17:14 static\n-rw-r--r--.  1 root root 62386947 Nov 11 11:22 user-provider-0.0.1-SNAPSHOT.jar\n\n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Chinaskill")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" mv /etc/yum.repos.d/* /media")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" ftp.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum -y install nginx java-1.8.0-openjdk java-1.8.0-openjdk-devel")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" mv /usr/share/nginx/html/* /media/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" index.html /usr/share/nginx/html/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" static/ /usr/share/nginx/html/static")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"daemon off;"')]),s._v("  >> /etc/nginx/nginx.conf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" default.conf /etc/nginx/conf.d/default.conf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v("  *.jar /opt/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 80 443 8081 8082 8083")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" run.sh /opt/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" chmod +x /opt/run.sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/run.sh"')]),s._v("]")]),s._v("\n\n\n[root@master nginx]# cat run.sh  \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\ncd /opt/\nnohup java -jar shopping-provider-0.0.1-SNAPSHOT.jar &\nsleep 5\nnohup java -jar user-provider-0.0.1-SNAPSHOT.jar &  \nsleep 5\nnohup java -jar gpmall-shopping-0.0.1-SNAPSHOT.jar &\nsleep 5  \nnohup java -jar gpmall-user-0.0.1-SNAPSHOT.jar &\nsleep 5\nnginx\n\n\n\n[root@master nginx]# cat default.conf  \nserver {\n    listen       80;\n    server_name  localhost;\n\n    location / {\n        root   /usr/share/nginx/html;\n        index  index.html index.htm;\n    }\n    location /user {\n            proxy_pass http://127.0.0.1:8082;\n        }\n    location /shopping {\n            proxy_pass http://127.0.0.1:8081;\n        }\n    location /cashier {\n            proxy_pass http://127.0.0.1:8083;\n        }\n}\n\n[root@master nginx]# docker build -t='chinaskill-nginx:v1.1' .\n")])])]),t("h3",{attrs:{id:"【题目6】docker-compose编排"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目6】docker-compose编排"}},[s._v("#")]),s._v(" 【题目6】docker-compose编排")]),s._v(" "),t("p",[s._v("在master节点上编写/root/chinaskillmall/docker-compose.yaml文件部署，具体要求如下：")]),s._v(" "),t("p",[s._v("（1）容器1名称：mall-mysql；镜像：chinaskill-mariadb:v1.1；端口映射：13306:3306；")]),s._v(" "),t("p",[s._v("（2）容器2名称：mall-redis；镜像：chinaskill-redis:v1.1；端口映射：16379:6379；")]),s._v(" "),t("p",[s._v("（3）容器3名称：mall-kafka；镜像：chinaskill-kafka:v1.1；端口映射：19092:9092；")]),s._v(" "),t("p",[s._v("（4）容器4名称：mall-zookeeper；镜像：chinaskill-zookeeper:v1.1；端口映射：12181:2181；")]),s._v(" "),t("p",[s._v("（5）容器5名称：mall-nginx；镜像：chinaskill-nginx:v1.1；端口映射：83:80，1443:443；自启动所有的jar包程序。")]),s._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat docker-compose.yaml  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mysql.mall")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mysql\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" chinaskill"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mariadb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.1\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3306:3306"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis.mall")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mysql.mall\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" chinaskill"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("redis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.1\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6379:6379"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("zookeeper.mall")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mysql.mall\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" redis.mall\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" zookeeper\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" chinaskill"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("zookeeper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.1\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2181:2181"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kafka.mall")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("links")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" zookeeper.mall\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mysql.mall\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" redis.mall\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" zookeeper.mall\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kafka\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" chinaskill"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("kafka"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.1\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9092:9092"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mall")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" chinaskill"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.1\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("links")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mysql.mall\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" redis.mall\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" zookeeper.mall\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" kafka.mall\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mysql.mall\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" redis.mall\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" zookeeper.mall\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" kafka.mall\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"80:80"')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"443:443"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("privileged")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n    command： "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/run.sh"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master gpmall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("ok"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose up ")]),s._v("\n")])])]),t("h2",{attrs:{id:"基于docker容器的情感分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基于docker容器的情感分析"}},[s._v("#")]),s._v(" 基于Docker容器的情感分析")]),s._v(" "),t("h3",{attrs:{id:"【题目1】构建-sa-logic-镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目1】构建-sa-logic-镜像"}},[s._v("#")]),s._v(" 【题目1】构建 sa-logic 镜像")]),s._v(" "),t("ul",[t("li",[s._v("编写yum文件")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd sentiment-analyzer/ ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master sentiment-analyzer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi local.repo")]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sa\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("baseurl")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("file:///opt/sa-repo \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgcheck")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("enabled")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])])]),t("ul",[t("li",[s._v("编写构建sa-logic镜像的Dockerfile文件")])]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[s._v("[root@master sentiment-analyzer]# cat Dockerfile-logic\n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Guo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /root")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" sa-repo /opt/sa-repo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" rm -rf /etc/yum.repos.d/*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" local.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" sa-logic/app.py /root/app.py")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" sa-logic/requirements.txt /root/requirements.txt")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" sa-logic/python-packages.tar.gz /root")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum -y install python3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" pip3 install --user --find-links=python-packages -r /root/requirements.txt")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 5000")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"python3"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"app.py"')]),s._v("]")]),s._v("\n\n[root@master sentiment-analyzer]# docker build -t sa-logic:v1.0 -f Dockerfile-logic .\n")])])]),t("h3",{attrs:{id:"【题目2】构建-sa-webapp-镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目2】构建-sa-webapp-镜像"}},[s._v("#")]),s._v(" 【题目2】构建 sa-webapp 镜像")]),s._v(" "),t("ul",[t("li",[s._v("编写构建sa-webapp镜像的Dockerfile文件")])]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[s._v("[root@master sentiment-analyzer]# cat Dockerfile-webapp \n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Guo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /root")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" sa-repo /opt/sa-repo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" rm -rf /etc/yum.repos.d/*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" local.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" sa-webapp/go-packages.tar.gz /root")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum -y install golang")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" go build -o webapp .")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 8080")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/root/webapp"')]),s._v("]")]),s._v("\n\n[root@master sentiment-analyzer]# docker build -t sa-webapp:v1.0 -f Dockerfile-webapp .\n")])])]),t("h3",{attrs:{id:"【题目3】构建-sa-frontend-镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目3】构建-sa-frontend-镜像"}},[s._v("#")]),s._v(" 【题目3】构建 sa-frontend 镜像")]),s._v(" "),t("ul",[t("li",[s._v("编写构建sa-frontend镜像的Dockerfile文件")])]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[s._v("[root@master sentiment-analyzer]# cat Dockerfile-frontend \n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Guo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /root")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" sa-repo /opt/sa-repo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" rm -rf /etc/yum.repos.d/*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" local.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" sa-frontend/sa-frontend.tar.gz /root")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" VUE_APP_API_HOST=http://192.168.200.10:9002")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum -y install nodejs nginx")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" npm run build && rm -rf /usr/share/nginx/html/* && cp -rf dist/* /usr/share/nginx/html/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 80")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-g"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"daemon off;"')]),s._v("]")]),s._v("\n\n[root@master sentiment-analyzer]# docker build -t sa-frontend:v1.0 -f Dockerfile-frontend .\n")])])]),t("h3",{attrs:{id:"【题目4】编排部署-sentiment-analyzer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目4】编排部署-sentiment-analyzer"}},[s._v("#")]),s._v(" 【题目4】编排部署 sentiment-analyzer")]),s._v(" "),t("ul",[t("li",[s._v("编写 docker-compose.yaml 文件")])]),s._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master sentiment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("analyzer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat docker-compose.yaml  ")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sa-logic")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("logic\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("logic"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9001:5000"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sa-webapp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("webapp\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("webapp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9002:8080"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("  \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" sa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("logic\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" API_HOST=http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//sa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("logic"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sa-frontend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("frontend\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("frontend"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9003:80"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("  \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" sa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("webapp\n")])])]),t("ul",[t("li",[s._v("启动服务")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master sentiment-analyzer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose up -d")]),s._v("\nCreating network "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sentiment-analyzer_default"')]),s._v(" with the default driver \nCreating sa-logic "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v(" \nCreating sa-webapp "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v(" \nCreating sa-frontend "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master sentiment-analyzer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose ps ")]),s._v("\n Name     Command         State           Ports \n ------------------------------------------------------------------- \nsa-frontend nginx "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" daemon off"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:9003-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp  \nsa-logic python3 app.py Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:9001-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("/tcp \nsa-webapp /root/webapp Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:9002-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp\n")])])]),t("h2",{attrs:{id:"容器化编排mall-swarm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#容器化编排mall-swarm"}},[s._v("#")]),s._v(" 容器化编排mall-swarm")]),s._v(" "),t("p",[s._v("云梦公司开发了一套基于SpringBoot+MyBatis微服务架构的ChinaSkillsMall电商系统， 并实现全容器化部署，ChinaSkillsMall 电商应用系统架构如图 1 所示，系统说明如表 2 所示。")]),s._v(" "),t("p",[s._v("将 MariaDB 数据库组件、Redis 消息组件、RabbitMQ 消息组件、Nacos-Registry 注册 中心服务组件和前端 Nginx 组件按照要求进行容器化。（所需要的软件包 mall-swarm.tar.gz 在 http服务中）")]),s._v(" "),t("img",{staticStyle:{zoom:"67%"},attrs:{src:"C:\\Users\\zyh\\AppData\\Roaming\\Typora\\typora-user-images\\image-20211123105512801.png",alt:"image-20211123105512801"}}),s._v(" "),t("h3",{attrs:{id:"【题目1】容器化部署mariadb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目1】容器化部署mariadb"}},[s._v("#")]),s._v(" 【题目1】容器化部署MariaDB")]),s._v(" "),t("p",[s._v("在 master 节 点 上 编 写 /root/mall-swarm/Dockerfile-mariadb文件构建chinaskillmall-mariadb:v1.1镜像，具体要求如下：")]),s._v(" "),t("p",[s._v("（1）基础镜像：centos:centos7.5.1804；")]),s._v(" "),t("p",[s._v("（2）作者：Chinaskill；")]),s._v(" "),t("p",[s._v("（3）安装并初始化 mariadb，密码：root；")]),s._v(" "),t("p",[s._v("（4）设置数据库编码为 UTF-8；")]),s._v(" "),t("p",[s._v("（5）开放端口：3306")]),s._v(" "),t("p",[s._v("（6）设置 mariadb 开机自启")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar -zxvf mall-swarm.tar.gz ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd mall-swarm/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-swarm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("303292")]),s._v("\ndrwxr-xr-x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127")]),s._v(" Apr "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(" images\n-r--r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("183246769")]),s._v(" Apr "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(" jdk-8u121-linux-x64.tar.gz\n-rw-r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("73")]),s._v(" Nov "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" 08:47 local.repo\n-rw-r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("68323707")]),s._v(" Apr "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(" mall-admin-web.tar.gz\ndrwxr-xr-x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root root        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("38")]),s._v(" Apr "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(" mall-repo\n-rw-r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("220900")]),s._v(" Apr "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(" mall.sql\n-rw-r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("44698307")]),s._v(" Apr "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(" nacos-server-1.1.0.tar.gz\n-rw-r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("896")]),s._v(" Apr "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(" nginx.conf\n-rw-r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14065831")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v(" node-v6.17.1-linux-x64.tar.gz\n")])])]),t("p",[t("strong",[s._v("配置yum源")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-swarm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat local.repo  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mall \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("baseurl")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("file:///opt/mall-repo \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgcheck")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("enabled")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])])]),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[s._v("[root@master mall-swarm]# cat  run.sh \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash ")]),s._v("\n\nmysql_install_db --user=root \nmysqld_safe --user=root & \nsleep 5 \nmysqladmin -uroot password root \nmysql -uroot -proot -e \"grant all on *.* to 'reader'@'%' identified by '123456';\"\nmysql -uroot -proot -e \"create database mall;use mall;source /opt/mall.sql;\"\n\n\n[root@master mall-swarm]# cat  Dockerfile-mysql \n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Guo ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" rm -rf /etc/yum.repos.d/* ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" local.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" mall-repo /opt/mall-repo ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" mall.sql /opt/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" run.sh /opt/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" LC_ALL en_US.UTF-8 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum install -y mariadb mariadb-server  && bash /opt/run.sh ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 3306 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mysqld_safe"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--user=root"')]),s._v("]")]),s._v("\n\n\n[root@master mall-swarm]# docker build -t mall-mysql:v1.0 -f Dockerfile-mysql .           \n")])])]),t("h3",{attrs:{id:"【题目2】容器化部署redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目2】容器化部署redis"}},[s._v("#")]),s._v(" 【题目2】容器化部署Redis")]),s._v(" "),t("p",[s._v("在 master 节点上编写/root/mall-swarm/Dockerfile-redis 文件构建 chinaskillmall-redis:v1.1 镜像，具体要求如下：")]),s._v(" "),t("p",[s._v("（1）基础镜像：centos:centos7.5.1804；")]),s._v(" "),t("p",[s._v("（2）作者：Chinaskill；")]),s._v(" "),t("p",[s._v("（3）安装 redis 服务；")]),s._v(" "),t("p",[s._v("（4）修改配置文件中的 bind 127.0.0.1 为 bind 0.0.0.0；")]),s._v(" "),t("p",[s._v("（5）设置 redis 免密，并关闭保护模式；")]),s._v(" "),t("p",[s._v("（6）开放端口：6379；")]),s._v(" "),t("p",[s._v("（7）设置服务开机自启。")]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[s._v("[root@master mall-swarm]# cat Dockerfile-redis  \n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Guo ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" rm -rf /etc/yum.repos.d/* ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" local.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" mall-repo /opt/mall-repo ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum install -y redis && \\ ")]),s._v("\n        sed -i 's/127.0.0.1/0.0.0.0/g' /etc/redis.conf && \\\n        sed -i 's/protected-mode yes/protected-mode no/g' /etc/redis.conf \n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 6379 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/redis-server"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/redis.conf"')]),s._v("]")]),s._v("\n\n[root@master mall-swarm]# docker build -t mall-redis:v1.0 -f Dockerfile-redis  .\n")])])]),t("h3",{attrs:{id:"【题目3】容器化部署rabbitmq"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目3】容器化部署rabbitmq"}},[s._v("#")]),s._v(" 【题目3】容器化部署rabbitmq")]),s._v(" "),t("p",[s._v("在 master 节点上编写/root/mall-swarm/Dockerfile-rabbit 文件构建 chinaskillmall-rabbit:v1.1 镜像，具体要求如下：")]),s._v(" "),t("p",[s._v("（1）基础镜像：centos:centos7.5.1804；")]),s._v(" "),t("p",[s._v("（2）作者：Chinaskill；")]),s._v(" "),t("p",[s._v("（3）安装 rabbitmq 服务；")]),s._v(" "),t("p",[s._v("（4）创建rabbitmq的mall用户给administrator权限")]),s._v(" "),t("p",[s._v("（5）开启rabbitmq的图形化界面")]),s._v(" "),t("p",[s._v("（6）开放端口：5672 15672；")]),s._v(" "),t("p",[s._v("（7）设置服务开机自启。")]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[s._v("[root@master mall-swarm]# cat rabbit-user.sh \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n/usr/lib/rabbitmq/bin/rabbitmq-server restart\nsleep 8\n/usr/lib/rabbitmq/bin/rabbitmqctl add_vhost mall\n/usr/lib/rabbitmq/bin/rabbitmqctl add_user mall mall\n/usr/lib/rabbitmq/bin/rabbitmqctl set_user_tags mall administrator\n/usr/lib/rabbitmq/bin/rabbitmqctl set_permissions -p mall mall '.*' '.*' '.*'\n/usr/lib/rabbitmq/bin/rabbitmq-plugins enable rabbitmq_management\n/usr/lib/rabbitmq/bin/rabbitmq-server restart\n\n[root@master mall-swarm]# cat Dockerfile-rabbit\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Guo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" rm -rf /etc/yum.repos.d/*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" local.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" rabbit-user.sh /opt/rabbit-user.sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" mall-repo /opt/mall-repo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum -y install rabbitmq-server")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 5672 15672")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/rabbit-user.sh"')]),s._v("]")]),s._v("\n\n\n[root@master mall-swarm]# docker build -t mall-rabbitmq:v1.0 -f Dockerfile-rabbitmq  . \n")])])]),t("h3",{attrs:{id:"【题目4】容器化部署nacos-registry"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目4】容器化部署nacos-registry"}},[s._v("#")]),s._v(" 【题目4】容器化部署Nacos-Registry")]),s._v(" "),t("p",[s._v("在 master 节 点 上 编 写 /root/mall-swarm/Dockerfile-nacos 文 件 构 建 chinaskillmall-nacos:v1.1 镜像，具体要求如下：")]),s._v(" "),t("p",[s._v("（1）基础镜像：centos:centos7.5.1804；")]),s._v(" "),t("p",[s._v("（2）作者：Chinaskill；")]),s._v(" "),t("p",[s._v("（3）安装 jdk 工具和 nacos-server 工具；")]),s._v(" "),t("p",[s._v("（4）设置 nacos 服务开机自启。")]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[s._v("[root@master mall-swarm]# cat start.sh \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n/usr/local/bin/nacos/bin/startup.sh -m standalone\ntail -f /usr/local/bin/nacos/logs/start.out\n\n[root@master mall-swarm]# car Dockerfile-nacos \n-bash: car: command not found\n[root@master mall-swarm]# cat Dockerfile-nacos  \n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Guo ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" rm -rf /etc/yum.repos.d/* ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" local.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" mall-repo /opt/mall-repo ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" start.sh /opt/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" jdk-8u121-linux-x64.tar.gz /usr/local/bin/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" nacos-server-1.1.0.tar.gz /usr/local/bin/ ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" JAVA_HOME /usr/local/bin/jdk1.8.0_121 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 8848 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/start.sh"')]),s._v("]")]),s._v("\n\n\n[root@master mall-swarm]# docker build -t mall-nacos:v1.0 -f Dockerfile-nacos  . \n")])])]),t("h3",{attrs:{id:"【题目5】容器化部署前端服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目5】容器化部署前端服务"}},[s._v("#")]),s._v(" 【题目5】容器化部署前端服务")]),s._v(" "),t("p",[s._v("在 master节点上安装node工具 ，对mall-admin-web项目进行打包 ， 然 后 编 写 /root/mall-swarm/Dockerfile-nginx 文件构建 chinaskillmall-nginx:v1.1 镜像，具体要求如下：")]),s._v(" "),t("p",[s._v("（1）基础镜像：centos:centos7.5.1804；")]),s._v(" "),t("p",[s._v("（2）作者：Chinaskill；")]),s._v(" "),t("p",[s._v("（3）安装 nginx 服务；")]),s._v(" "),t("p",[s._v("（4）将 mall-admin-web 项目打包后的文件拷贝到/usr/share/nginx/html 目录下；")]),s._v(" "),t("p",[s._v("（5）设置 nginx 服务开机自启。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-swarm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar -zxvf mall-admin-web.tar.gz ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-swarm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd mall-admin-web/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-admin-web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi config/prod.env.js ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'use strict'")]),s._v("\nmodule.exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  NODE_ENV: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\"production\"'")]),s._v(",\n  BASE_API: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\"http://172.25.253.11:8201/mall-admin\"'")]),s._v("\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改成自己的IP")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-admin-web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd ../")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-swarm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar zxvf node-v6.17.1-linux-x64.tar.gz")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-swarm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mv node-v6.17.1-linux-x64 /usr/local/node ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-swarm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /etc/profile")]),s._v("\n···\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NODE_HOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/node \n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NODE_HOME")]),s._v("/bin:"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-swarm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd mall-admin-web/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-admin-web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# npm run build ")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mall-admin-web@1.0.0 build /root/mall-swarm/mall-admin-web\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" build/build.js\n\n⠴ building "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" production"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-admin-web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mv dist/ ../ ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall-admin-web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd ..")]),s._v("\n")])])]),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[s._v("[root@master mall-swarm]# cat Dockerfile-nginx \n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:centos7.5.1804 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" Guo ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" rm -rf /etc/yum.repos.d/* ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" local.repo /etc/yum.repos.d/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" mall-repo /opt/mall-repo ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum install -y nginx ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" dist/ /usr/share/nginx/html/ ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 80")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-g"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"daemon off;"')]),s._v("]")]),s._v("\n")])])]),t("h3",{attrs:{id:"【题目6】编排部署chinaskillsmall商城"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【题目6】编排部署chinaskillsmall商城"}},[s._v("#")]),s._v(" 【题目6】编排部署ChinaSkillsMall商城")]),s._v(" "),t("p",[s._v("在 master 节点上编写/root/mall-swarm/docker-compose.yaml 文件，具体要求如下：")]),s._v(" "),t("p",[s._v("（1）容器 1 名称：chinaskillmall-admin；镜像：mall/mall-admin:1.0-SNAPSHOT；端口 映射：8080:8080；")]),s._v(" "),t("p",[s._v("（2）容器 2 名称： chinaskillmall-auth；镜像：mall/mall-auth:1.0-SNAPSHOT；端口映 射：8401:8401；")]),s._v(" "),t("p",[s._v("（3）容器 3 名称：chinaskillmall-gateway；镜像：mall/mall-gateway:1.0-SNAPSHOT； 端口映射：8201:8201；")]),s._v(" "),t("p",[s._v("（4）容器 4 名称：chinaskillmall-mysql；镜像：chinaskillmall-mariadb:v1.1；端口映射： 3306:3306；")]),s._v(" "),t("p",[s._v("（5）容器 5 名称：chinaskillmall-nacos；镜像：chinaskillmall-nacos:v1.1；端口映射： 8848:8848；")]),s._v(" "),t("p",[s._v("（6）容器 6 名称：chinaskillmall-nginx；镜像：chinaskillmall-nginx:v1.1；端口映射： 8888:80；")]),s._v(" "),t("p",[s._v("（7）容器 7 名称：chinaskillmall-redis；镜像：chinaskillmall-redis:v1.1；端口映射： 6379:6379。")]),s._v(" "),t("p",[s._v("（7）容器 8 名称：chinaskillmall-rabbit；镜像：chinaskillmall-rabbit:v1.1；端口映射： 5672 15672。")]),s._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("swarm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat docker-compose.yaml ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mall-mysql")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0 \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mysql \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always  \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"13306:3306"')]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mall-redis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("redis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0 \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("redis \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"16379:16379"')]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mall-nginx")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0 \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8888:80"')]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mall-rabbit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("rabbit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0 \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("rabbit\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5672:5672"')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"15672:15672"')]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nacos-registry")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nacos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0 \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nacos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("registry \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8848:8848"')]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mall-admin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall/mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("admin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("1.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("SNAPSHOT\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("admin \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8082:8080"')]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("links")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("db \n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mall-gateway")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall/mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("gateway"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("1.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("SNAPSHOT\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("  mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("gateway \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8201:8201"')]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("links")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("redis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("redis\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" nacos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("registry"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("nacos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("registry\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mall-auth")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall/mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("auth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("1.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("SNAPSHOT\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("auth\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8401:8401"')]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("links")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" nacos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("registry"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("nacos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("registry\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);