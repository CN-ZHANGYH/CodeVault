(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{352:function(s,t,a){"use strict";a.r(t);var e=a(7),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"网络高可用设计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#网络高可用设计"}},[s._v("#")]),s._v(" 网络高可用设计")]),s._v(" "),t("h3",{attrs:{id:"掌握要点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#掌握要点"}},[s._v("#")]),s._v(" 掌握要点")]),s._v(" "),t("blockquote",[t("p",[s._v("（1）熟悉 bonding 的工作模式、功能、使用场景等。")]),s._v(" "),t("p",[s._v("（2）熟悉 bonding 模式的工作原理。")]),s._v(" "),t("p",[s._v("（3）熟悉各个 bonding 模式的配置方法。")])]),s._v(" "),t("h3",{attrs:{id:"节点规划"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#节点规划"}},[s._v("#")]),s._v(" 节点规划")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[s._v("IP")]),s._v(" 地址")]),s._v(" "),t("th",[s._v("网卡名称")]),s._v(" "),t("th",[t("strong",[s._v("bond")]),s._v(" 名称")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("192.168.100.10")]),s._v(" "),t("td",[s._v("ens33、ens34")]),s._v(" "),t("td",[s._v("bond")])])])]),s._v(" "),t("h3",{attrs:{id:"网卡做-bond0-模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#网卡做-bond0-模式"}},[s._v("#")]),s._v(" 网卡做 "),t("strong",[s._v("bond0")]),s._v(" 模式")]),s._v(" "),t("h5",{attrs:{id:"_1-ens33-网卡配置信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-ens33-网卡配置信息"}},[s._v("#")]),s._v(" 1.ens33 网卡配置信息")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /etc/sysconfig/network-scripts/ifcfg-ens33 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TYPE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ethernet"')]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BOOTPROTO")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"none"')]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ens33"')]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DEVICE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ens33"')]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ONBOOT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v("  \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MASTER")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bond"')]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SLAVE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v(" \n")])])]),t("h5",{attrs:{id:"_2-ens34-网卡配置信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-ens34-网卡配置信息"}},[s._v("#")]),s._v(" 2.ens34 网卡配置信息")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /etc/sysconfig/network-scripts/ifcfg-ens34 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TYPE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ethernet"')]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BOOTPROTO")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"none"')]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ens34"')]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DEVICE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ens34"')]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ONBOOT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MASTER")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bond"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SLAVE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v(" \n")])])]),t("h5",{attrs:{id:"_3-创建-bond0-网卡配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-创建-bond0-网卡配置文件"}},[s._v("#")]),s._v(" 3.创建 bond0 网卡配置文件")]),s._v(" "),t("p",[s._v("需要用到什么模式在mode中可以修改相应的数字。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /etc/sysconfig/network-scripts/ifcfg-bond ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DEVICE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bond \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TYPE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Bond \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("IPADDR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.10 \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NETMASK")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),s._v(".255.0 \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GATEWAY")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.1 \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("USERCTL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("no \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BOOTPROTO")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("none \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ONBOOT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BONDING_MASTER")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BONDING_OPTS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mode=0 miimon=100"')]),s._v(" \n")])])]),t("h5",{attrs:{id:"_4-重启网卡服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-重启网卡服务"}},[s._v("#")]),s._v(" 4.重启网卡服务")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl restart network ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ip a ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": lo: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("LOOPBACK,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v(" qdisc noqueue state UNKNOWN qlen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 \n    inet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1/8 scope "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" lo        valid_lft forever preferred_lft forever \n    inet6 ::1/128 scope "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("         valid_lft forever preferred_lft forever \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(": ens33: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc pfifo_fast master bond state UP qlen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("     \n\tlink/ether 00:0c:29:5b:43:41 brd ff:ff:ff:ff:ff:ff \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(": ens34: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc pfifo_fast master bond state UP qlen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("     \n\tlink/ether 00:0c:29:5b:43:41 brd ff:ff:ff:ff:ff:ff \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(": bond: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,MASTER,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc noqueue state UP qlen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("     \n\tlink/ether 00:0c:29:5b:43:41 brd ff:ff:ff:ff:ff:ff     \n\tinet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.10/24 brd "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.255 scope global bond        \n\tvalid_lft forever preferred_lft forever     \n\tinet6 fe80::20c:29ff:fe5b:4341/64 scope "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v(" tentative dadfailed         \n\tvalid_lft forever preferred_lft forever \n")])])]),t("h5",{attrs:{id:"_5-查看-bond-状态信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-查看-bond-状态信息"}},[s._v("#")]),s._v(" 5.查看 bond 状态信息")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /proc/net/bonding/bond  ")]),s._v("\nEthernet Channel Bonding Driver: v3.7.1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("April "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2011")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n \nBonding Mode: load balancing "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("round-robin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \nMII Status: up \nMII Polling Interval "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ms"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" \nUp Delay "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ms"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \nDown Delay "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ms"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \n \nSlave Interface: ens33 \nMII Status: up \nSpeed: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" Mbps \nDuplex: full \nLink Failure Count: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \nPermanent HW addr: 00:0c:29:5b:43:41 \nSlave queue ID: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \n \nSlave Interface: ens34 \nMII Status: up \nSpeed: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" Mbps \nDuplex: full \nLink Failure Count: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \nPermanent HW addr: 00:0c:29:5b:43:4b \nSlave queue ID: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);