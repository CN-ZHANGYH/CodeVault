(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{495:function(s,a,t){"use strict";t.r(a);var e=t(7),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"服务器制作raid磁盘阵列并管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器制作raid磁盘阵列并管理"}},[s._v("#")]),s._v(" 服务器制作RAID磁盘阵列并管理")]),s._v(" "),a("h3",{attrs:{id:"raid磁盘阵列要点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#raid磁盘阵列要点"}},[s._v("#")]),s._v(" RAID磁盘阵列要点")]),s._v(" "),a("blockquote",[a("p",[s._v("（1）掌握 RAID 的构建，挂载和使用。")]),s._v(" "),a("p",[s._v("（2）掌握 RAID 的基础运维")])]),s._v(" "),a("h3",{attrs:{id:"规划节点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#规划节点"}},[s._v("#")]),s._v(" 规划节点")]),s._v(" "),a("p",[s._v("基础环境CentOS7，准备5个硬盘，大小是20GB")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[s._v("IP")])]),s._v(" "),a("th",[s._v("主机名")]),s._v(" "),a("th",[s._v("节点")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("192.168.100.10")]),s._v(" "),a("td",[s._v("Localhost")]),s._v(" "),a("td",[s._v("控制节点")])])])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lsblk ")]),s._v("\nNAME   MAJ:MIN RM SIZE RO TYPE MOUNTPOINT\nvda    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":0    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  40G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk \n└─vda1 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":1    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  40G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part /\nvdb    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":16   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  20G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk \nvdc    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":32   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  20G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk \nvdd    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":48   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  20G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk \nvde    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":64   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  20G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk \nvdf    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":80   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  20G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk \n")])])]),a("h3",{attrs:{id:"创建raid-0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建raid-0"}},[s._v("#")]),s._v(" 创建RAID 0")]),s._v(" "),a("h5",{attrs:{id:"_1、创建-raid-0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、创建-raid-0"}},[s._v("#")]),s._v(" "),a("strong",[s._v("1、创建 RAID 0")])]),s._v(" "),a("p",[s._v("⚫利用lsblk查看磁盘分区，每个大小为 20 GB。用这 2 个 20 GB 的分区来模拟 1 个 40 GB 的硬盘。")]),s._v(" "),a("p",[s._v("⚫安装工具 mdadm，使用已有 YUM 源进行安装。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install -y mdadm")]),s._v("\n")])])]),a("p",[s._v("创建一个 RAID 0 设备：这里使用/dev/vdb 和/dev/vdc 做实验。 将/dev/vdb 和/dev/vdc 建立RAID等级为RAID 0的md0（"),a("strong",[s._v("设备名")]),s._v("）。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm -C -v /dev/md0 -l 0 -n 2 /dev/vdb /dev/vdc ")]),s._v("\nmdadm: chunk size defaults to 512K\nmdadm: Defaulting to version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v(" metadata\nmdadm: array /dev/md0 started.\n")])])]),a("p",[s._v("命令解析：")]),s._v(" "),a("p",[s._v("⚫ "),a("strong",[s._v("-C")]),s._v(" v：创建设备，并显示信息。")]),s._v(" "),a("p",[s._v("⚫ "),a("strong",[s._v("-l")]),s._v("  0：RAID 的等级为 RAID 0。")]),s._v(" "),a("p",[s._v("⚫ "),a("strong",[s._v("-n")]),s._v(" 2：创建 RAID 的设备为 2 块。")]),s._v(" "),a("p",[s._v("查看系统上的 RAID，命令及返回结果如下。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /proc/mdstat ")]),s._v("\nPersonalities "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("raid0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \nmd0 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" active raid0 vdc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" vdb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41908224")]),s._v(" blocks super "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v(" 512k chunks\n      \nunused devices: "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("h5",{attrs:{id:"_2、查看当前raid信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、查看当前raid信息"}},[s._v("#")]),s._v(" "),a("strong",[s._v("2、查看当前RAID信息")])]),s._v(" "),a("p",[s._v("查看 RAID 详细信息，命令及返回结果如下。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm -Ds")]),s._v("\nARRAY /dev/md0 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("localhost:0 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("841c4f62:269f1d1e:5a990fb3:86a938e7\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm -D /dev/md0  ")]),s._v("\n/dev/md0:\n           Version "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v("\n     Creation Time "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Wed Feb  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":49:34 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("\n        Raid Level "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" raid0\n        Array Size "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41908224")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39.97")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("42.91")]),s._v(" GB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      Raid Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n     Total Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n       Persistence "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Superblock is persistent\n\n       Update Time "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Wed Feb  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":49:34 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("\n             State "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" clean \n    Active Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n   Working Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    Failed Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n     Spare Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n        Chunk Size "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 512K\n\nConsistency Policy "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" none\n\n              Name "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" localhost:0  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("local to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n              UUID "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 841c4f62:269f1d1e:5a990fb3:86a938e7\n            Events "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n    Number   Major   Minor   RaidDevice State\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      active "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("   /dev/vdb\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      active "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("   /dev/vdc\n")])])]),a("p",[s._v("生成配置文件 mdadm.conf，命令如下。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm -Ds >/etc/mdaadm.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/mdaadm.conf  ")]),s._v("\nARRAY /dev/md0 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("localhost:0 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("841c4f62:269f1d1e:5a990fb3:86a938e7\n")])])]),a("h5",{attrs:{id:"_3、对raid格式化挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、对raid格式化挂载"}},[s._v("#")]),s._v(" "),a("strong",[s._v("3、对RAID格式化挂载")])]),s._v(" "),a("p",[s._v("对创建的 RAID 进行文件系统创建并挂载，命令如下。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkfs.xfs /dev/md0 ")]),s._v("\nmeta-data"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/md0               "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("isize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("agcount")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("agsize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("654720")]),s._v(" blks\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sectsz")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("attr")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("projid32bit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("crc")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("finobt")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sparse")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndata     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10475520")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("imaxpct")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sunit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("swidth")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v(" blks\nnaming   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("              "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   ascii-ci"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ftype")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("internal log           "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5120")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sectsz")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sunit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" blks, lazy-count"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nrealtime "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("none                   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("extsz")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rtextents")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir md0 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount /dev/md0 md0/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -Th md0/")]),s._v("\nFilesystem     Type  Size  Used Avail Use% Mounted on\n/dev/md0       xfs    40G   33M   40G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /root/md0\n")])])]),a("p",[s._v("设置成开机自动挂载，以至于每次开机不需要再次重新挂载磁盘。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# blkid /dev/md0 ")]),s._v("\n/dev/md0: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"d7680766-fd86-434f-951e-9280334bc64a"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TYPE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xfs"')]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "UUID=d7680766-fd86-434f-951e-9280334bc64a /md0 xfs defaults 0 0 " >> /etc/fstab')]),s._v("\n")])])]),a("h5",{attrs:{id:"_4、删除raid-0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、删除raid-0"}},[s._v("#")]),s._v(" "),a("strong",[s._v("4、删除RAID 0")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# umount md0/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm -S /dev/md0 ")]),s._v("\nmdadm: stopped /dev/md0\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm -rf /etc/mdaadm.conf  ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm -rf md0/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm --zero-superblock /dev/vdb  ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm --zero-superblock /dev/vdc ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /etc/fstab ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("d7680766-fd86-434f-951e-9280334bc64a /md0 xfs defaults "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"删除这一行"')]),s._v("\n")])])]),a("h3",{attrs:{id:"创建raid-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建raid-5"}},[s._v("#")]),s._v(" 创建RAID 5")]),s._v(" "),a("h5",{attrs:{id:"_1、创建raid-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、创建raid-5"}},[s._v("#")]),s._v(" "),a("strong",[s._v("1、创建RAID 5")])]),s._v(" "),a("p",[s._v("⚫raid 5 运维操作使用当前的空磁盘，每个大小为 20 GB。用 3 个 20 GB 的分区来模拟 raid 5，加一个热备盘。")]),s._v(" "),a("p",[s._v("⚫添加热备盘的作用就是可以模拟故障，然后临时替换热备盘。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm -Cv /dev/md5 -l5 -n3 /dev/vdb /dev/vdc /dev/vdd --spare-devices=1 /dev/vde")]),s._v("\nmdadm: layout defaults to left-symmetric\nmdadm: layout defaults to left-symmetric\nmdadm: chunk size defaults to 512K\nmdadm: size "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" to 20954112K\nmdadm: Fail to create md5 when using /sys/module/md_mod/parameters/new_array, fallback to creation via "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v("\nmdadm: Defaulting to version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v(" metadata\nmdadm: array /dev/md5 started.\n")])])]),a("h5",{attrs:{id:"_2、查看当前raid的信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、查看当前raid的信息"}},[s._v("#")]),s._v(" "),a("strong",[s._v("2、查看当前RAID的信息")])]),s._v(" "),a("p",[s._v("使用"),a("code",[s._v("-D选项")]),s._v("，查看 RAID 的详细信息。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm  -D /dev/md5 ")]),s._v("\n/dev/md5:\n           Version "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v("\n     Creation Time "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Wed Feb  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":15:54 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("\n        Raid Level "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" raid5\n        Array Size "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41908224")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39.97")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("42.91")]),s._v(" GB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n     Used Dev Size "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20954112")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19.98")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21.46")]),s._v(" GB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      Raid Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n     Total Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n       Persistence "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Superblock is persistent\n\n       Update Time "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Wed Feb  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":17:24 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("\n             State "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" clean, degraded, recovering \n    Active Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n   Working Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n    Failed Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n     Spare Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n            Layout "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" left-symmetric\n        Chunk Size "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 512K\n\nConsistency Policy "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" resync\n\n    Rebuild Status "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v("% complete\n\n              Name "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" localhost:5  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("local to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n              UUID "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" dd49c7bc:5fcadcb4:36f0a7f8:d36671e6\n            Events "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n\n    Number   Major   Minor   RaidDevice State\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      active "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("   /dev/vdb\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      active "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("   /dev/vdc\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("48")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("      spare rebuilding   /dev/vdd\n\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("        -      spare   /dev/vde\n")])])]),a("h5",{attrs:{id:"_3、模拟硬盘故障"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、模拟硬盘故障"}},[s._v("#")]),s._v(" "),a("strong",[s._v("3、模拟硬盘故障")])]),s._v(" "),a("p",[s._v("使用"),a("code",[s._v("-f选项")]),s._v("模拟设备损坏")]),s._v(" "),a("p",[s._v("从以下结果可以发现原来的热备盘/dev/sde 正在参与 RAID 5 的重建，而原来的/dev/sdb 变成了坏盘。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm -f /dev/md5 /dev/vdb ")]),s._v("\nmdadm: "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" /dev/vdb faulty "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /dev/md5\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm -D /dev/md5 ")]),s._v("\n/dev/md5:\n           Version "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v("\n     Creation Time "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Wed Feb  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":15:54 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("\n        Raid Level "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" raid5\n        Array Size "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41908224")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39.97")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("42.91")]),s._v(" GB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n     Used Dev Size "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20954112")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19.98")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21.46")]),s._v(" GB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      Raid Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n     Total Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n       Persistence "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Superblock is persistent\n\n       Update Time "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Wed Feb  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":18:30 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("\n             State "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" clean, FAILED \n    Active Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n   Working Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n    Failed Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n     Spare Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n            Layout "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" left-symmetric\n        Chunk Size "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 512K\n\nConsistency Policy "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" resync\n\n              Name "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" localhost:5  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("local to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n              UUID "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" dd49c7bc:5fcadcb4:36f0a7f8:d36671e6\n            Events "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("44")]),s._v("\n\n    Number   Major   Minor   RaidDevice State\n       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      removed\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      active "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("   /dev/vdc\n       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("      removed\n\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("        -      faulty   /dev/vdb\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("        -      spare   /dev/vde\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("48")]),s._v("        -      spare   /dev/vdd\n")])])]),a("p",[s._v("使用"),a("code",[s._v("-r选项")]),s._v("，热移除故障硬盘，查看 RAID 的详细信息，命令如下")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm -r /dev/md5  /dev/vdb  ")]),s._v("\nmdadm: hot removed /dev/vdb from /dev/md5\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdadm -D /dev/md5 ")]),s._v("\n/dev/md5:\n           Version "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v("\n     Creation Time "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Wed Feb  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":15:54 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("\n        Raid Level "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" raid5\n        Array Size "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41908224")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39.97")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("42.91")]),s._v(" GB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n     Used Dev Size "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20954112")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19.98")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21.46")]),s._v(" GB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      Raid Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n     Total Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n       Persistence "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Superblock is persistent\n\n       Update Time "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Wed Feb  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":21:25 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("\n             State "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" clean, FAILED \n    Active Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n   Working Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n    Failed Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n     Spare Devices "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n            Layout "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" left-symmetric\n        Chunk Size "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 512K\n\nConsistency Policy "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" resync\n\n              Name "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" localhost:5  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("local to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n              UUID "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" dd49c7bc:5fcadcb4:36f0a7f8:d36671e6\n            Events "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v("\n\n    Number   Major   Minor   RaidDevice State\n       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      removed\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      active "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("   /dev/vdc\n       -       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("      removed\n\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("        -      spare   /dev/vde\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("48")]),s._v("        -      spare   /dev/vdd\n")])])]),a("h5",{attrs:{id:"_4、对raid格式化挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、对raid格式化挂载"}},[s._v("#")]),s._v(" "),a("strong",[s._v("4、对RAID格式化挂载")])]),s._v(" "),a("p",[s._v("格式化 RAID 为xfs的文件格式，并进行挂载")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkfs.xfs /dev/md5")]),s._v("\nmeta-data"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/md5               "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("isize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("agcount")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("agsize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("654720")]),s._v(" blks\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sectsz")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("attr")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("projid32bit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("crc")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("finobt")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sparse")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndata     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10475520")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("imaxpct")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sunit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("swidth")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v(" blks\nnaming   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("              "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   ascii-ci"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ftype")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("internal log           "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5120")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sectsz")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sunit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" blks, lazy-count"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nrealtime "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("none                   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("extsz")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rtextents")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@Localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount /dev/md5 /mnt/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -Th /mnt")]),s._v("\nFilesystem     Type  Size  Used Avail Use% Mounted on\n/dev/md5       xfs    40G   33M   40G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /mnt\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);