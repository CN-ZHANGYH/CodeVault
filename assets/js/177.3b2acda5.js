(window.webpackJsonp=window.webpackJsonp||[]).push([[177],{491:function(t,a,e){"use strict";e.r(a);var r=e(7),s=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"linux下firewalld命令管理详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux下firewalld命令管理详解"}},[t._v("#")]),t._v(" Linux下firewalld命令管理详解")]),t._v(" "),a("h2",{attrs:{id:"firewalld中的区域管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#firewalld中的区域管理"}},[t._v("#")]),t._v(" Firewalld中的区域管理")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("阻塞区域（block）")]),t._v(" "),a("th",[a("strong",[t._v("任何传入的网络数据包都将被阻止")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("工作区域（work）")]),t._v(" "),a("td",[t._v("相信网络上的其他计算机，不会损害你的计算机")])]),t._v(" "),a("tr",[a("td",[t._v("家庭区域（home）")]),t._v(" "),a("td",[t._v("相信网络上的其他计算机，不会损害你的计算机")])]),t._v(" "),a("tr",[a("td",[t._v("公共区域（public）")]),t._v(" "),a("td",[t._v("不相信网络上的任何计算机，只有选择接受传入的网络连接")])]),t._v(" "),a("tr",[a("td",[t._v("隔离区域（DMZ）")]),t._v(" "),a("td",[t._v("隔离区域也称为非军事区域，内外网络之间增加的一层网络，起到缓冲作用。对于隔离区域，只有选择接受传入的网络连接")])]),t._v(" "),a("tr",[a("td",[t._v("信任区域（trusted）")]),t._v(" "),a("td",[t._v("所有的网络连接都可以接受")])]),t._v(" "),a("tr",[a("td",[t._v("丢弃区域（drop）")]),t._v(" "),a("td",[t._v("任何传入的网络连接都被拒绝")])]),t._v(" "),a("tr",[a("td",[t._v("内部区域（internal）")]),t._v(" "),a("td",[t._v("信任网络上的其他计算机，不会损害你的计算机。只有选择接受传入的网络连接")])]),t._v(" "),a("tr",[a("td",[t._v("外部区域（external）")]),t._v(" "),a("td",[t._v("不相信网络上的其他计算机，不会损害你的计算机。只有选择接受传入的网络连接")])])])]),t._v(" "),a("h2",{attrs:{id:"常用区域管理方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用区域管理方法"}},[t._v("#")]),t._v(" 常用区域管理方法")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("firewall-config              \t\t    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##开启火墙的图形管理")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--state")]),t._v("\t\t\t\t \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看防火墙状态")]),t._v("\nfirewall-cmd --get-active-zones \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看正在生效的域")]),t._v("\nfirewall-cmd --get-default-zone \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看默认的域")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --list-all \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看public域里的设置，--zone指定域")]),t._v("\nfirewall-cmd --list-all \t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#列出默认域的火墙情况")]),t._v("\nfirewall-cmd --set-default-zone"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#把默认的域设为public")]),t._v("\nfirewall-cmd --get-zones \t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看所有的域")]),t._v("\nfirewall-cmd --get-services \t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看所有可以添加到火墙里的服务")]),t._v("\nfirewall-cmd --list-all-zones \t \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##查看所有域的所有设置")]),t._v("\n")])])]),a("blockquote",[a("p",[a("strong",[t._v("注：Firewalld的默认区域是public")])])]),t._v(" "),a("h2",{attrs:{id:"基本命令用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本命令用法"}},[t._v("#")]),t._v(" 基本命令用法")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("功能")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("--permanent")])]),t._v(" "),a("td",[a("strong",[t._v("永久设定")])])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("--zone")])]),t._v(" "),a("td",[a("strong",[t._v("指定域")])])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("--add-service")])]),t._v(" "),a("td",[a("strong",[t._v("添加服务")])])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("--remove-service")])]),t._v(" "),a("td",[a("strong",[t._v("删除服务")])])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("--add-source")])]),t._v(" "),a("td",[a("strong",[t._v("添加主机ip")])])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("--remove-source")])]),t._v(" "),a("td",[a("strong",[t._v("删除主机ip")])])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("--add-port")])]),t._v(" "),a("td",[a("strong",[t._v("添加端口")])])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("--remove-port")])]),t._v(" "),a("td",[a("strong",[t._v("删除端口")])])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("--add-interface")])]),t._v(" "),a("td",[a("strong",[t._v("添加网卡")])])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("--change-interface")])]),t._v(" "),a("td",[a("strong",[t._v("改变网卡")])])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("--remove-interface")])]),t._v(" "),a("td",[a("strong",[t._v("删除网卡")])])])])]),t._v(" "),a("h2",{attrs:{id:"参数用法示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参数用法示例"}},[t._v("#")]),t._v(" 参数用法示例")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("trusted --add-source"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.25")]),t._v(".0.1\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#添加外来主机ip到trusted域")]),t._v("\n$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("trusted --remove-source"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.25")]),t._v(".0.1\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#从trusted域中删除外来主机ip")]),t._v("\n$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("trusted --add-interface"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eth0\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#添加网卡到指定的域")]),t._v("\n$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("trusted --change-interface"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eth0\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#改变网卡所在的域")]),t._v("\n$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v(" --zone-trusted --remove-interface"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eth0\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#将网卡从指定域上面删除")]),t._v("\n$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-service"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("smtp\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#永久添加服务")]),t._v("\n$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --remove-service"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("smtp\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#永久移走服务")]),t._v("\n$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --list-ports\t\t\t\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#列出允许的端口")]),t._v("\n$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("/tcp\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#永久添加端口")]),t._v("\n$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --remove-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("/tcp\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#永久删除端口")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("注意：\n1.在设定火墙策略时，可以加"),a("code",[t._v("--permanent")]),t._v("参数永久设定；临时设定时则不加该参数\n2.永久设定后，火墙策略不会立即生效，需要进行重新加载，两种方式如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--reload")]),t._v(" \t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#重新加载使其生效，但是不会断开已经连接的")]),t._v("\n$ firewall-cmd --complete-relode \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#重新加载，并且断开所有的连接")]),t._v("\n")])])])]),t._v(" "),a("h2",{attrs:{id:"设定火墙规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设定火墙规则"}},[t._v("#")]),t._v(" 设定火墙规则")]),t._v(" "),a("p",[t._v("指定主机访问指定端口")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--direct")]),t._v(" --add-rule ipv4 filter INPUT "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.25")]),t._v(".254.1  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v("  tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dport")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" ACCEPT\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#添加只有主机172.25.254.1可以ssh访问本机")]),t._v("\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("注释：\nfilter\t\t\t（规则表） \nINPUT\t\t\t（链） \n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\t\t\t\t（写在第一条） \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v("\t\t\t\t（源ip） "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.25")]),t._v(".254.1  \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v("\t\t\t\t（协议类型） tcp \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dport")]),t._v("\t\t\t（目的端口） "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v("\t\t\t\t（动作） ACCEPT\n\n动作：\naccept \t接受客户端的请求\nreject \t拒绝请求，但是给客户端有回应，客户端不再访问\ndrop \t丢弃，没有回应，客户端会一直发数据包，加大负载\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--direct")]),t._v(" --get-all-rules\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看规则")]),t._v("\n$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--direct")]),t._v(" --remove-rule ipv4 filter INPUT "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.25")]),t._v(".254.1 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dport")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" ACCEPT"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#删除规则")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("注意：除了指定主机外的主机访问指定端口：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--direct")]),t._v(" --add-rule ipv4 filter INPUT "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.25")]),t._v(".254.1 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dport")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" ACCEPT\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#除了指定ip地址的主机不使用此策略，其他主机都使用此策略（指定的使用默认策略）")]),t._v("\n")])])])])])}),[],!1,null,null,null);a.default=s.exports}}]);