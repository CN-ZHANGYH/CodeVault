(window.webpackJsonp=window.webpackJsonp||[]).push([[184],{498:function(t,s,a){"use strict";a.r(s);var n=a(7),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"dhcp-服务与管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dhcp-服务与管理"}},[t._v("#")]),t._v(" DHCP 服务与管理")]),t._v(" "),s("h3",{attrs:{id:"掌握要点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#掌握要点"}},[t._v("#")]),t._v(" 掌握要点")]),t._v(" "),s("blockquote",[s("p",[t._v("（1）了解 DHCP 服务的安装与配置。")]),t._v(" "),s("p",[t._v("（2）使用 DHCP 服务完成主机 IP 的自动获取。")])]),t._v(" "),s("h3",{attrs:{id:"部署流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署流程"}},[t._v("#")]),t._v(" 部署流程")]),t._v(" "),s("h5",{attrs:{id:"_1-规划节点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-规划节点"}},[t._v("#")]),t._v(" 1.规划节点")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[s("strong",[t._v("IP")])]),t._v(" "),s("th",[t._v("主机名")]),t._v(" "),s("th",[t._v("节点")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("11.0.1.128   192.168.2.2(LAN1)")]),t._v(" "),s("td",[t._v("xnode1")]),t._v(" "),s("td",[t._v("DHCP 服务器")])]),t._v(" "),s("tr",[s("td",[t._v("11.0.1.129 （DHCP-LAN1）")]),t._v(" "),s("td",[t._v("client")]),t._v(" "),s("td",[t._v("DHCP 客户端")])])])]),t._v(" "),s("h5",{attrs:{id:"_2-添加网卡-两个节点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-添加网卡-两个节点"}},[t._v("#")]),t._v(" 2.添加网卡（两个节点）")]),t._v(" "),s("p",[t._v("⚫打开虚拟机设置添加网卡，单击“添加”按钮，如图")]),t._v(" "),s("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204111250466.png",alt:"image-20220211105731296"}}),t._v(" "),s("p",[t._v("⚫在弹出的对话框中，选择网络适配器，然后单击“完成”按钮")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204111250371.png",alt:"image-20220211105829688"}})]),t._v(" "),s("p",[t._v("⚫选择网络适配器 2，设置模式为 LAN 区段，选择 LAN 区段 1，如图 3-15-3 所示。如果没有 LAN 区段 1，单击下方“LAN 区段（S）”按钮，然后在弹出的对话框中单击“添加” 按钮，最后单击“确定”按钮")]),t._v(" "),s("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202204111250732.png",alt:"image-20220211105848890"}}),t._v(" "),s("p",[t._v("⚫使用 ip a 命令可以查看到新添加的网卡，但并没有相关配置文件")]),t._v(" "),s("h5",{attrs:{id:"_3-修改网卡配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-修改网卡配置"}},[t._v("#")]),t._v(" 3.修改网卡配置")]),t._v(" "),s("p",[t._v("⚫在DHCP服务端进入网卡配置文件目录，复制第一块网卡配置。")]),t._v(" "),s("p",[t._v("⚫修改网卡配置文件。")]),t._v(" "),s("p",[t._v("⚫启动网卡并查看。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@xnode1 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd /etc/sysconfig/network-scripts/ ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@xnode1 network-scripts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cp -rvf ifcfg-eno16777736 ifcfg-eno33554984 ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@xnode1 network-scripts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vi ifcfg-eno33554984  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TYPE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Ethernet \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("BOOTPROTO")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("static \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DEFROUTE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PEERDNS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PEERROUTES")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IPV4_FAILURE_FATAL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("no \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("NAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eno33554984 \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DEVICE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eno33554984 \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ONBOOT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IPADDR")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".2.2 \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PREFIX")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("GATEWAY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".2.1 \n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@xnode1 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ifup eno33554984")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@xnode1 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ip a")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": lo: "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("LOOPBACK,UP,LOWER_UP"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" mtu "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("65536")]),t._v(" qdisc noqueue state UNKNOWN \n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1/8 scope "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" \n       valid_lft forever preferred_lft forever\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(": eno16777736: "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("BROADCAST,MULTICAST,UP,LOWER_UP"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" mtu "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1500")]),t._v(" qdisc pfifo_fast state UP qlen "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n    link/ether 00:0c:29:8d:4e:69 brd ff:ff:ff:ff:ff:ff\n    inet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.0")]),t._v(".1.128/24 brd "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.0")]),t._v(".1.255 scope global dynamic eno16777736\n       valid_lft 1579sec preferred_lft 1579sec\n    inet6 fd15:4ba5:5a2b:1008:20c:29ff:fe8d:4e69/64 scope global noprefixroute dynamic \n       valid_lft 86395sec preferred_lft 14395sec\n    inet6 fe80::20c:29ff:fe8d:4e69/64 scope "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v(" \n       valid_lft forever preferred_lft forever\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(": eno33554984: "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("BROADCAST,MULTICAST,UP,LOWER_UP"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" mtu "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1500")]),t._v(" qdisc pfifo_fast state UP qlen "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n    link/ether 00:0c:29:8d:4e:73 brd ff:ff:ff:ff:ff:ff\n    inet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".2.2/24 brd "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".2.255 scope global eno33554984\n       valid_lft forever preferred_lft forever\n    inet6 fe80::20c:29ff:fe8d:4e73/64 scope "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v(" \n       valid_lft forever preferred_lft forever\n")])])]),s("h5",{attrs:{id:"_4-安装配置dhcp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-安装配置dhcp"}},[t._v("#")]),t._v(" 4.安装配置DHCP")]),t._v(" "),s("p",[t._v("⚫安装 DHCP 服务。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@xnode1 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# yum install -y  dhcp")]),t._v("\n")])])]),s("h5",{attrs:{id:"_5-dhcp的配置文件模板"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-dhcp的配置文件模板"}},[t._v("#")]),t._v(" 5.DHCP的配置文件模板")]),t._v(" "),s("p",[t._v("⚫可以在以下的模板中找到DHCP的配置文件，只需要找到对应需要的去更改就可以了。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@xnode1 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  cat /usr/share/doc/dhcp-4.2.5/dhcpd.conf.example")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# DHCP Server Configuration file.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   see /usr/share/doc/dhcp*/dhcpd.conf.example")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   see dhcpd.conf(5) man page")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# dhcpd.conf")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Sample configuration file for ISC dhcpd")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# option definitions common to all supported networks...")]),t._v("\noption domain-name "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.org"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\noption domain-name-servers ns1.example.org, ns2.example.org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\ndefault-lease-time "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#默认租约时间单位秒")]),t._v("\nmax-lease-time "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#最大租约时间单位秒")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Use this to enble / disable dynamic dns updates globally.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#ddns-update-style none;")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# If this DHCP server is the official DHCP server for the local")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# network, the authoritative directive should be uncommented.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#authoritative;")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Use this to send dhcp log messages to a different log file (you also")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# have to hack syslog.conf to complete the redirection).")]),t._v("\nlog-facility local7"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# No service will be given on this subnet, but declaring it helps the ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# DHCP server to understand the network topology.")]),t._v("\n\nsubnet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.152")]),t._v(".187.0 netmask "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255.255")]),t._v(".255.0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#定义子网")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This is a very basic subnet declaration.")]),t._v("\n\nsubnet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.254")]),t._v(".239.0 netmask "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255.255")]),t._v(".255.224 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  range "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.254")]),t._v(".239.10 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.254")]),t._v(".239.20"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("              "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#IP地址池")]),t._v("\n  option routers rtr-239-0-1.example.org, rtr-239-0-2.example.org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This declaration allows BOOTP clients to get dynamic addresses,")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# which we don't really recommend.")]),t._v("\n\nsubnet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.254")]),t._v(".239.32 netmask "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255.255")]),t._v(".255.224 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  range dynamic-bootp "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.254")]),t._v(".239.40 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.254")]),t._v(".239.60"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  option broadcast-address "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.254")]),t._v(".239.31"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  option routers rtr-239-32-1.example.org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# A slightly different configuration for an internal subnet.")]),t._v("\nsubnet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.5")]),t._v(".5.0 netmask "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255.255")]),t._v(".255.224 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  range "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.5")]),t._v(".5.26 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.5")]),t._v(".5.30"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  option domain-name-servers ns1.internal.example.org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#DNS服务器")]),t._v("\n  option domain-name "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"internal.example.org"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#可选 设置默认搜索域")]),t._v("\n  option routers "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.5")]),t._v(".5.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                                  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#网关")]),t._v("\n  option broadcast-address "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.5")]),t._v(".5.31"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#可选 备选广播地址")]),t._v("\n  default-lease-time "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  max-lease-time "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Hosts which require special configuration options can be listed in")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# host statements.   If no address is specified, the address will be")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# allocated dynamically (if possible), but the host-specific information")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# will still come from the host declaration.")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" passacaglia "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("                                \n  hardware ethernet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(":0:c0:5d:bd:95"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("              \n  filename "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vmunix.passacaglia"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  server-name "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"toccata.fugue.com"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Fixed IP addresses can also be specified for hosts.   These addresses")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# should not also be listed as being available for dynamic assignment.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Hosts for which fixed IP addresses have been specified can boot using")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# BOOTP or DHCP.   Hosts for which no fixed address is specified can only")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# be booted with DHCP, unless there is an address range on the subnet")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# to which a BOOTP client is connected which has the dynamic-bootp flag")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# set.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" fantasia "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("                                 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#主机")]),t._v("\n  hardware ethernet 08:00:07:26:c0:a5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#指定文件服务器MAC地址")]),t._v("\n  fixed-address fantasia.fugue.com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#指定IP地址")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# You can declare a class of clients and then do address allocation")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# based on that.   The example below shows a case where all clients")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# in a certain class get addresses on the 10.17.224/24 subnet, and all")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# other clients get addresses on the 10.0.29/24 subnet.")]),t._v("\n\nclass "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  match "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" substring "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("option vendor-class-identifier, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SUNW"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nshared-network "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("224")]),t._v("-29 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  subnet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.17")]),t._v(".224.0 netmask "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255.255")]),t._v(".255.0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    option routers rtr-224.example.org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  subnet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.0")]),t._v(".29.0 netmask "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255.255")]),t._v(".255.0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    option routers rtr-29.example.org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  pool "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    allow members of "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    range "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.17")]),t._v(".224.10 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.17")]),t._v(".224.250"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  pool "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    deny members of "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    range "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.0")]),t._v(".29.10 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.0")]),t._v(".29.230"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("⚫修改 DHCP 配置文件。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@xnode1 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vim /etc/dhcp/dhcpd.conf  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# DHCP Server Configuration file.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   see /usr/share/doc/dhcp*/dhcpd.conf.example")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   see dhcpd.conf(5) man page")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n\nsubnet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".2.0 netmask "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255.255")]),t._v(".255.0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n range "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".2.100 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".2.254"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n option domain-name-servers "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".2.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n option domain-name "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test.cn"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n option routers "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".2.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n option broadcast-address "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".2.255"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n default-lease-time "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n max-lease-time "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h5",{attrs:{id:"_6-重启服务测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-重启服务测试"}},[t._v("#")]),t._v(" 6.重启服务测试")]),t._v(" "),s("p",[t._v("⚫启动 DHCP 服务并设置开机自启，查看服务状态。")]),t._v(" "),s("p",[t._v("⚫Client 节点同样进行复制和修改网卡配置文件的操作。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@xnode1 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl start dhcpd ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@xnode1 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl enable dhcpd ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@xnode1 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl status dhcpd ")]),t._v("\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@client ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd /etc/sysconfig/network-scripts/ ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@client network-scripts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cp -rvf ifcfg-eno16777736 ifcfg-eno33554984 ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@client network-scripts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat ifcfg-eno33554984  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TYPE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Ethernet \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("BOOTPROTO")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("dhcp \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DEFROUTE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PEERDNS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PEERROUTES")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IPV4_FAILURE_FATAL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("no \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("NAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eno33554984 \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DEVICE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eno33554984 \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ONBOOT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@client ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl restart network ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@client ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ip a")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": lo: "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("LOOPBACK,UP,LOWER_UP"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" mtu "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("65536")]),t._v(" qdisc noqueue state UNKNOWN group default qlen "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1/8 scope "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" \n       valid_lft forever preferred_lft forever\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(": ens32: "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("BROADCAST,MULTICAST,UP,LOWER_UP"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" mtu "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1500")]),t._v(" qdisc pfifo_fast state UP group default qlen "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n    link/ether 00:0c:29:7c:32:c5 brd ff:ff:ff:ff:ff:ff\n    inet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".2.100/24 brd "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".2.255 scope global noprefixroute dynamic ens32\n       valid_lft 599sec preferred_lft 599sec\n    inet6 fe80::fade:7228:6397:cdb1/64 scope "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v(" noprefixroute \n       valid_lft forever preferred_lft forever\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);