(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{338:function(t,a,s){"use strict";s.r(a);var e=s(7),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"zabbix监控openstack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zabbix监控openstack"}},[t._v("#")]),t._v(" Zabbix监控OpenStack")]),t._v(" "),a("h2",{attrs:{id:"环境准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境准备"}},[t._v("#")]),t._v(" 环境准备")]),t._v(" "),a("h3",{attrs:{id:"_1-节点规划"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-节点规划"}},[t._v("#")]),t._v(" 1. 节点规划")]),t._v(" "),a("p",[t._v("安装单节点Linux操作系统，节点规划见表1。")]),t._v(" "),a("p",[t._v("表1 节点规划")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("IP")])]),t._v(" "),a("th",[a("strong",[t._v("主机名")])]),t._v(" "),a("th",[a("strong",[t._v("节点")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("10.24.195.48")]),t._v(" "),a("td",[t._v("zabbix-server")]),t._v(" "),a("td",[t._v("监控节点")])]),t._v(" "),a("tr",[a("td",[t._v("10.24.200.80")]),t._v(" "),a("td",[t._v("openstack")]),t._v(" "),a("td",[t._v("云平台控制节点")])]),t._v(" "),a("tr",[a("td",[t._v("10.24.196.82")]),t._v(" "),a("td",[t._v("Web访问节点")]),t._v(" "),a("td",[t._v("Web访问节点")])])])]),t._v(" "),a("h3",{attrs:{id:"_2-基础环境配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-基础环境配置"}},[t._v("#")]),t._v(" 2. 基础环境配置")]),t._v(" "),a("p",[t._v("使用线上平台分配主机，分别为zabbix-server节点使用centos7.5操作系统，openstack节点为已搭建完成的单节点OpenStack Allinone主机，地址根据实际地址进行配置。")]),t._v(" "),a("h2",{attrs:{id:"模块内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模块内容"}},[t._v("#")]),t._v(" 模块内容")]),t._v(" "),a("h3",{attrs:{id:"_1-环境配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-环境配置"}},[t._v("#")]),t._v(" 1.环境配置")]),t._v(" "),a("p",[t._v("修改主机名")]),t._v(" "),a("p",[t._v("修改节点的主机名为zabbix-server，命令如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# hostnamectl set-hostname zabbix-server")]),t._v("\n")])])]),a("p",[t._v("配置本地Yum源")]),t._v(" "),a("p",[t._v("从文件服务器拉取软件包下载至/root目录并配置本地yum源，命令如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# curl -O http://mirrors.douxuedu.com/newcloud/zabbix.tar.gz")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tar -zxvf zabbix.tar.gz")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\nzabbix zabbix.tar.gz\n")])])]),a("p",[t._v("将默认Yum源移至/media/目录，并创建本地Yum源文件，命令及文件内容如下。")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mv /etc/yum.repos.d/* /media/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat >> /etc/yum.repos.d/zabbix.repo << EOF")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("zabbix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zabbix\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("baseurl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("file:///root/zabbix\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("gpgcheck")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("enabled")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nEOF\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# yum repolist")]),t._v("\nrepo "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("id")]),t._v("      repo name     status\nzabbix      zabbix          "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("105")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-安装mariadb数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装mariadb数据库"}},[t._v("#")]),t._v(" 2.安装MariaDB数据库")]),t._v(" "),a("p",[t._v("安装MariaDB数据库，启动并设置开机自启，命令如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# yum install mariadb-server mariadb -y")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl start mariadb")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl enable mariadb --now")]),t._v("\n")])])]),a("p",[t._v("初始化数据库，命令如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mysql_secure_installation")]),t._v("\nEnter current password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" root "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enter "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":  //按Enter键\nSet root password? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" y            //输入y并按Enter键\nNew password:       //设置root登录数据库密码（000000）并按Enter键\nRe-enter new password:       //重复密码（000000）并按Enter键\nPassword updated successfully"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nReloading privilege tables"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". Success"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nRemove anonymous users? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" y        //输入y并按Enter键\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". Success"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nDisallow root login remotely? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" n     //输入n并按Enter键\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". skipping.\nRemove "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v(" database and access to it? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" y //输入y并按Entre键\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". Success"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nReload privilege tables now? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" y       //输入y并按Enter键\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". Success"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nThanks "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" using MariaDB"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n")])])]),a("p",[t._v("创建zabbix数据库及用户zabbix，并赋予用户远程访问数据库权限，命令如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# mysql -uroot -p000000 -e "create database zabbix character set utf8 collate utf8_bin;"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mysql -uroot -p000000 -e \"create user zabbix@localhost identified by '000000';\"")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# mysql -uroot -p000000 -e "grant all privileges on zabbix.* to zabbix@localhost;"')]),t._v("\n")])])]),a("h3",{attrs:{id:"_3-zabbix服务安装及配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-zabbix服务安装及配置"}},[t._v("#")]),t._v(" 3.Zabbix服务安装及配置")]),t._v(" "),a("p",[t._v("安装Zabbix主服务和Agent服务，命令如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# yum install zabbix-server-mysql zabbix-agent -y")]),t._v("\n")])])]),a("p",[t._v("安装SCL组件并导入Zabbix初始数据，命令如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# yum install centos-release-scl zabbix-web-mysql-scl zabbix-apache-conf-scl -y")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zcat /usr/share/doc/zabbix-server-mysql*/create.sql.gz | mysql -uzabbix -p000000 zabbix")]),t._v("\n")])])]),a("p",[t._v("修改Zabbix Server主配置文件，设置数据库密码，命令如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# echo "DBPassword=000000" >> /etc/zabbix/zabbix_server.conf')]),t._v("\n")])])]),a("p",[t._v("修改Zabbix的前端页面配置文件，设置PHP时区，并启动服务，设置服务开机自启，命令如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# echo "php_value[date.timezone] = Asia/Shanghai" >> /etc/opt/rh/rh-php72/php-fpm.d/zabbix.conf')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl enable zabbix-server zabbix-agent httpd rh-php72-php-fpm --now")]),t._v("\n")])])]),a("p",[t._v("验证Zabbix是否启动成功，查询服务端口(10050以及10051)，命令如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@zabbix-server ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# netstat -ntlup |grep zabbix")]),t._v("\nTcp   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(".0.0:10050   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(".0.0:* LISTEN "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2038")]),t._v("/zabbix_agentd \nTcp   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(".0.0:10051  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(".0.0:*  LISTEN "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2045")]),t._v("/zabbix_server \ntcp6   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    :::10050   :::*     LISTEN "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2038")]),t._v("/zabbix_agentd \ntcp6   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    :::10051      :::*      LISTEN "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2045")]),t._v("/zabbix_server\n")])])]),a("h3",{attrs:{id:"_4-初始化zabbix"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-初始化zabbix"}},[t._v("#")]),t._v(" 4.初始化Zabbix")]),t._v(" "),a("p",[t._v("切换至web节点（图形化界面），打开浏览器访问http://10.24.195.48/zabbix，单击“Next step”按钮，如图1-1所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082336153.jpg",alt:"img"}})]),t._v(" "),a("p",[t._v("图1-1 Zabbix初始化")]),t._v(" "),a("p",[t._v("检查Zabbix环境是否都为OK，然后单击"),a("code",[t._v("“Next step”")]),t._v("按钮，如图1-2所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082337391.jpg",alt:"img"}})]),t._v(" "),a("p",[t._v("图2 Zabbix环境检查")]),t._v(" "),a("p",[t._v("设置连接地址（根据实际地址）及数据库连接密码为"),a("code",[t._v("000000")]),t._v("，单击"),a("code",[t._v("“Next step”")]),t._v("按钮，如图1-3所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082337463.jpg",alt:"img"}})]),t._v(" "),a("p",[t._v("图1-3 配置数据库连接")]),t._v(" "),a("p",[t._v("设置Zabbix Server标题名字为“"),a("code",[t._v("云监控平台")]),t._v("”，单击"),a("code",[t._v("“Next step”")]),t._v("按钮，如图1-4所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082337102.jpg",alt:"img"}})]),t._v(" "),a("p",[t._v("图1-4 设置标题名称")]),t._v(" "),a("p",[t._v("查看配置概况，单击"),a("code",[t._v("“Next step”")]),t._v("按钮，如图1-5所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082337527.jpg",alt:"img"}})]),t._v(" "),a("p",[t._v("图1-5 查看配置概况")]),t._v(" "),a("p",[t._v("完成安装，单击"),a("code",[t._v("“Finish”")]),t._v("按钮，如图1-6所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082337679.jpg",alt:"img"}})]),t._v(" "),a("p",[t._v("图1-6 完成初始化")]),t._v(" "),a("p",[t._v("登录Zabbix云监控平台，输入用户名和密码"),a("code",[t._v("（Admin/zabbix）")]),t._v("，单击"),a("code",[t._v("“Sign in”")]),t._v("按钮进行登录，如图1-7所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082337134.png",alt:"img"}})]),t._v(" "),a("p",[t._v("图1-7 登录")]),t._v(" "),a("p",[t._v("登陆后单击左下角"),a("code",[t._v("“User settings”")]),t._v("，设置中文语言，Language设置为"),a("code",[t._v("“Chinese(zh_CN)”")]),t._v("，单击"),a("code",[t._v("“update”")]),t._v("按钮更新设置，如图1-8所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082337190.jpg",alt:"img"}})]),t._v(" "),a("p",[t._v("图1-8 设置中文语言")]),t._v(" "),a("p",[t._v("至此，Zabbix服务安装完毕，下面可以将需要监控的主机添加到Zabbix的监控列表，进行实时监控。")]),t._v(" "),a("h3",{attrs:{id:"_5-zabbix-agent配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-zabbix-agent配置"}},[t._v("#")]),t._v(" 5.Zabbix Agent配置")]),t._v(" "),a("p",[t._v("被监控主机agent节点需安装Zabbix Agent服务，将数据采集提供给server节点。下面将在云管理平台openstack节点安装Zabbix Agent服务。")]),t._v(" "),a("p",[t._v("1.Zabbix Agent服务的安装与配置")]),t._v(" "),a("p",[t._v("安装zabbix-agent服务，并修改配置文件，启动Agent服务，命令及文件内容如下。")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@openstack ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# yum install zabbix-agent -y")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@openstack ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vim /etc/zabbix/zabbix_agentd.conf")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Server")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.24")]),t._v(".195.48             //修改为server节点IP\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ServerActive")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.24")]),t._v(".195"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("48")]),t._v("     //修改为server节点IP\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Hostname")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("openstack           //主机名即可\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@openstack ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl enable zabbix-agent.service --now")]),t._v("\n")])])]),a("p",[t._v("查询Agent服务端口（10050）是否启动成功，命令如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@openstack ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# netstat -ntlup |grep zabbix")]),t._v("\ntcp   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(".0.0:10050  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(".0.0:* LISTEN "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24217")]),t._v("/zabbix_agentd \ntcp6   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" :::10050         :::*       LISTEN "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24217")]),t._v("/zabbix_agentd\n")])])]),a("p",[t._v("2.server节点添加监控主机")]),t._v(" "),a("p",[t._v("切换至Web节点，打开Zabbix Server的Web页面，选择左侧导航栏"),a("code",[t._v("“配置→主机群组”")]),t._v("菜单命令，单击右上角"),a("code",[t._v("“创建主机群组”")]),t._v("按钮，定义主机群组名称为"),a("code",[t._v("“云计算集群主机”")]),t._v("，单击"),a("code",[t._v("“添加”")]),t._v("按钮，如图2-1所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082341766.jpg",alt:"img"}})]),t._v(" "),a("p",[t._v("图2-1 定义主机群组名称")]),t._v(" "),a("p",[t._v("创建主机。选择左侧导航栏“配置→主机”菜单命令，单击右上角“创建主机”按钮，设置主机名称为"),a("code",[t._v("“openstack”")]),t._v("，选择群组“云计算集群主机”，客户端IP地址为openstack节点地址"),a("code",[t._v("（10.24.200.80）")]),t._v("，注意不需要单击"),a("code",[t._v("“添加”")]),t._v("按钮，如图2-2所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082341682.jpg",alt:"img"}})]),t._v(" "),a("p",[t._v("图2-2 定义主机信息")]),t._v(" "),a("p",[t._v("选择模板。定义模板选择"),a("code",[t._v("“Templates/Operating systems→Template OS Linux by Zabbix agent”")]),t._v("，单击“添加”按钮，如图2-3所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082341095.jpg",alt:"img"}})]),t._v(" "),a("p",[t._v("图2-3 定义模板信息")]),t._v(" "),a("p",[t._v("查看主机。选择左侧导航栏"),a("code",[t._v("“监测→主机”")]),t._v("菜单命令，单击名称"),a("code",[t._v("“openstack”")]),t._v("，选择“图形”菜单命令，如图2-4所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082341981.jpeg",alt:"img"}})]),t._v(" "),a("p",[t._v("图2-4 查看主机")]),t._v(" "),a("p",[t._v("在跳转页面可以查看资源使用情况，如图2-5所示。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/202205082342185.jpg",alt:"img"}})]),t._v(" "),a("p",[t._v("图2-5 查看监控状态")]),t._v(" "),a("p",[t._v("至此，添加被监控主机操作完成，如果监控的是多台主机，只需按照上述方法，在被监控主机上安装Agent服务并做配置即可。")])])}),[],!1,null,null,null);a.default=n.exports}}]);