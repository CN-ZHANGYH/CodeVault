(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{348:function(s,t,a){"use strict";a.r(t);var e=a(7),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"mariadb-galera-cluster"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mariadb-galera-cluster"}},[s._v("#")]),s._v(" MariaDB Galera Cluster")]),s._v(" "),t("h3",{attrs:{id:"掌握要点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#掌握要点"}},[s._v("#")]),s._v(" 掌握要点")]),s._v(" "),t("blockquote",[t("p",[s._v("（1）熟悉 Gelera Cluster 数据库集群的工作原理与方式。")]),s._v(" "),t("p",[s._v("（2）能够搭建 MariaDB Gelera Cluster 数据库集群。")]),s._v(" "),t("p",[s._v("（3）学习 Gelera Cluster 集群的使用。")])]),s._v(" "),t("h3",{attrs:{id:"mariadb-galera-cluster-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mariadb-galera-cluster-2"}},[s._v("#")]),s._v(" MariaDB Galera Cluster")]),s._v(" "),t("p",[s._v("MariaDB Galera Cluster 是一套在 MySQL InnoDB 存储引擎上面实现 multi-master 及数据实时同步的系统架构，业务层面无需做读写分离工作，数据库读写压力都能按照既定的规则分发到各个节点上去。在数据方面完全兼容 MariaDB 和 MySQL。")]),s._v(" "),t("p",[t("strong",[s._v("⚫主要功能")])]),s._v(" "),t("p",[s._v("​\t① "),t("code",[s._v("同步复制。")])]),s._v(" "),t("p",[s._v("​\t② "),t("code",[s._v("真正的 multi-master，即所有节点可以同时读写数据库。")])]),s._v(" "),t("p",[s._v("​\t③ 自动的节点成员控制，失效节点自动被清除。")]),s._v(" "),t("p",[s._v("​\t④ 新节点加入数据自动复制。")]),s._v(" "),t("p",[s._v("​\t⑤ 真正的行级别，并行复制。")]),s._v(" "),t("p",[s._v("​\t⑥ 用户可以直接连接集群，使用感受上与 MySQL 完全一致。")]),s._v(" "),t("p",[t("strong",[s._v("⚫局限性")])]),s._v(" "),t("p",[s._v("​\t① 目前复制仅仅支持 InnoDB 存储引擎，任何写入其他引擎的表，包括 mysql.*表将不会复制，但是 DDL 语句会被复制的，因此创建用户将会被复制，\t但是插入用户将不会被复制的。")]),s._v(" "),t("p",[s._v("​\t② DELETE 操作不支持没有主键的表，没有主键的表在不同的节点顺序将不同，如果执行 SELECT…LIMIT…，将出现不同的结果集。")]),s._v(" "),t("p",[s._v("​\t③ 在多主环境下，不支持 LOCK/UNLOCK TABLES（锁定表/解锁表），以及 GET_LOCK()，RELEASE_LOCK()…（锁函数）")]),s._v(" "),t("p",[s._v("​\t④ 查询日志不能保存在表中。如果开启查询日志，只能保存到文件中。")]),s._v(" "),t("p",[s._v("​\t⑤ 允许最大的事务大小由wsrep_max_ws_rows和wsrep_max_ws_size定义，任何大型操作将被拒绝，如大型的 LOAD DATA 操作。")]),s._v(" "),t("p",[s._v("​\t⑥ 由于集群是乐观的并发控制，事务 commit 可能在该阶段中止。如果有两个事务向在集群中不同的节点向同一行写入并提交，失败的节点将中止。对于\t集群级别的中止，集群返回死锁错误代码为 Error: 1213 SQLSTATE: 40001(ER_LOCK_DEADLOCK)。")]),s._v(" "),t("p",[s._v("​\t⑦ XA 事务不支持，因为在提交上可能回滚。")]),s._v(" "),t("p",[s._v("​\t⑧ 整个集群的写入吞吐量是由最弱的节点限制，如果有一个节点变得缓慢，那么整个集群将变得缓慢。为了稳定的高性能要求，所有的节点应使用统一\t的硬件。")]),s._v(" "),t("p",[s._v("​\t⑨ 集群节点建议最少 3 个。")]),s._v(" "),t("p",[s._v("​\t⑩ 如果 DDL 语句有问题将破坏集群。")]),s._v(" "),t("h3",{attrs:{id:"规划节点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#规划节点"}},[s._v("#")]),s._v(" 规划节点")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("主机名")]),s._v(" "),t("th",[s._v("系统")]),s._v(" "),t("th",[t("strong",[s._v("IP")]),s._v(" 地址")]),s._v(" "),t("th",[s._v("节点")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("node1")]),s._v(" "),t("td",[s._v("CentOS7.5-1708")]),s._v(" "),t("td",[s._v("192.168.1.18")]),s._v(" "),t("td",[s._v("高可用集群中一节点")])]),s._v(" "),t("tr",[t("td",[s._v("node2")]),s._v(" "),t("td",[s._v("CentOS7.5-1708")]),s._v(" "),t("td",[s._v("192.168.1.5")]),s._v(" "),t("td",[s._v("高可用集群中一节点")])]),s._v(" "),t("tr",[t("td",[s._v("node3")]),s._v(" "),t("td",[s._v("CentOS7.5-1708")]),s._v(" "),t("td",[s._v("192.168.1.13")]),s._v(" "),t("td",[s._v("高可用集群中一节点")])])])]),s._v(" "),t("h3",{attrs:{id:"集群部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#集群部署"}},[s._v("#")]),s._v(" 集群部署")]),s._v(" "),t("h5",{attrs:{id:"_1-关闭防火墙"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-关闭防火墙"}},[s._v("#")]),s._v(" 1.关闭防火墙")]),s._v(" "),t("p",[s._v("⚫将所有的节点关闭防火墙以及seLinux，实际生产环境使用firewalld-cmd.")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop firewalld  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# setenforce  0 ")]),s._v("\n")])])]),t("h5",{attrs:{id:"_2-基础环境配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-基础环境配置"}},[s._v("#")]),s._v(" 2.基础环境配置")]),s._v(" "),t("p",[s._v("⚫"),t("strong",[s._v("以下操作在所有机器上进行")])]),s._v(" "),t("p",[s._v("⚫修改并添加主机hosts的映射。")]),s._v(" "),t("p",[s._v("⚫配置mariadb-ha的yum源。 "),t("code",[s._v("(但是得先安装unzip)")])]),s._v(" "),t("p",[s._v("⚫安装MariaDB Galera。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/hosts ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n \n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.18 node1 \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.5 node2 \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.13 node3\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# unzip mariadb-ha.zip && mv mariadb-ha /opt/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/yum.repos.d/zyh.repo ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("centos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("centos \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgcheck")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("baseurl")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://192.168.1.112/file/repo/centos/\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ha"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ha \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("baseurl")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("file:///opt/mariadb-ha \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgcheck")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# for i in node1 node2 node3 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$i")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yum install -y MariaDB-server MariaDB-client galera"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])])]),t("h5",{attrs:{id:"_3-初始规数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-初始规数据库"}},[s._v("#")]),s._v(" 3.初始规数据库")]),s._v(" "),t("p",[s._v("⚫在"),t("code",[s._v("每台机器")]),s._v("上初始化数据库设置密码")]),s._v(" "),t("p",[s._v("⚫将不允许根用户远程登录设置为no")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl start mariadb ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql_secure_installation  ")]),s._v("\n \nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR \nALL MariaDB \n      SERVERS IN PRODUCTION USE"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("  PLEASE READ EACH STEP CAREFULLY"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" \n \nIn order to log into MariaDB to secure it, we"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ll need the current password for the root user.  If you'")]),s._v("ve just installed MariaDB, and you haven"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t set the root password yet, the password will be blank, so you should just press enter here. \n \nEnter current password for root (enter for none): 默认按回车 OK, successfully used password, moving on... \n \nSetting the root password ensures that nobody can log into the MariaDB root user without the proper authorisation. \n \nSet root password? [Y/n] y    #按 y 设置数据库密码 \nNew password:           \t  #输入数据库密码 \nRe-enter new password:    \t  #重复数据库密码 \nPassword updated successfully! \nReloading privilege tables.. \n ... Success! \n \n \nBy default, a MariaDB installation has an anonymous user, allowing anyone to log into MariaDB without having to have a user account created for \nthem.  This is intended only for testing, and to make the installation \ngo a bit smoother.  You should remove them before moving into a production environment. \n \nRemove anonymous users? [Y/n] y   #按 y \n ... Success! \n \nNormally, root should only be allowed to connect from '")]),s._v("localhost"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.  This ensures that someone cannot guess at the root password from the network. \n \nDisallow root login remotely? [Y/n] n   #按 n  \n... skipping. \n \nBy default, MariaDB comes with a database named '")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' that anyone can access.  This is also intended only for testing, and should be removed before moving into a production environment. \n \nRemove test database and access to it? [Y/n] y  #按 y  \n - Dropping test database... \n ... Success! \n - Removing privileges on test database... \n ... Success! \n \nReloading the privilege tables will ensure that all changes made so far will take effect immediately. \n \nReload privilege tables now? [Y/n] y   #按 y  \n... Success! \n \nCleaning up... \n \n \nAll done!  If you'")]),s._v("ve completed all of the above steps, your MariaDB \ninstallation should now be secure. \n \nThanks "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" using MariaDB"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" \n\n")])])]),t("h5",{attrs:{id:"_4-配置数据库文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-配置数据库文件"}},[s._v("#")]),s._v(" 4.配置数据库文件")]),s._v(" "),t("p",[s._v("⚫"),t("strong",[s._v("以下操作在每个节点上进行")])]),s._v(" "),t("p",[s._v("⚫在配置数据库文件的前提将数据库授权root所有访问权限，并赋予 root 用户远程权限。")]),s._v(" "),t("p",[s._v("⚫配置数据库的高可用，需要将配置文件不同的节点更改为不同的节点名称以及IP地址。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -uroot -p000000")]),s._v("\nWelcome to the MariaDB monitor.  Commands end with "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" or "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("g.\nYour MariaDB connection "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" is "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("\nServer version: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.3")]),s._v(".22-MariaDB MariaDB Server\n\nCopyright "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v(", Oracle, MariaDB Corporation Ab and others.\n\nType "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'help;'")]),s._v(" or "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\h'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" help. Type "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\c'")]),s._v(" to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),s._v(" the current input statement.\n\nMariaDB "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  grant all privileges on *.* to root@"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" identified by "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'000000'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nQuery OK, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" rows affected "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.020")]),s._v(" sec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("node1节点的配置文件如下：")]),s._v(" "),t("p",[s._v("⚫wsrep_node_name=node1 \t\t\t\t\t\t\t\t\t\t\t\n⚫wsrep_node_address=192.168.1.18\t\t\t\t\t\t\t\t\t\n⚫wsrep_sst_method=rsync\n⚫wsrep_causal_reads=ON\n⚫innodb_buffer_pool_size=120M")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/my.cnf.d/server.cnf  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("galera"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Mandatory settings")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_on")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ON\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_provider")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/lib64/galera/libgalera_smm.so\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_cluster_address")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("gcomm://192.168.1.18,192.168.1.5,192.168.1.13    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加集群的主机IP")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_node_name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("node1 \t\t\t\t\t\t\t\t\t\t\t   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改当前的主机名称")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_node_address")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.18\t\t\t\t\t\t\t\t\t    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改当前的主机IP ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_sst_method")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rsync \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_causal_reads")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ON \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_buffer_pool_size")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("120M\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_format")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("row\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("default_storage_engine")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("InnoDB\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_autoinc_lock_mode")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Allow server to accept connections on all interfaces.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\nbind-address"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.18\t\t\t\t\t\t\t\t\t\t   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改成当前的主机IP")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Optional setting")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_slave_threads")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_flush_log_at_trx_commit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("node2节点的配置文件如下：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/my.cnf.d/server.cnf  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("galera"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Mandatory settings")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_on")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ON\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_provider")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/lib64/galera/libgalera_smm.so\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_cluster_address")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("gcomm://192.168.1.18,192.168.1.5,192.168.1.13    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加集群的主机IP")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_node_name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("node2 \t\t\t\t\t\t\t\t\t\t\t   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改当前的主机名称")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_node_address")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.5\t\t\t\t\t\t\t\t   \t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改当前的主机IP ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_sst_method")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rsync \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_causal_reads")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ON \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_buffer_pool_size")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("120M\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_format")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("row\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("default_storage_engine")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("InnoDB\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_autoinc_lock_mode")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Allow server to accept connections on all interfaces.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\nbind-address"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.5\t\t\t\t\t\t\t\t\t\t   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改成当前的主机IP")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Optional setting")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_slave_threads")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_flush_log_at_trx_commit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("node3节点的配置文件如下：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/my.cnf.d/server.cnf  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("galera"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Mandatory settings")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_on")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ON\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_provider")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/lib64/galera/libgalera_smm.so\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_cluster_address")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("gcomm://192.168.1.18,192.168.1.5,192.168.1.13    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加集群的主机IP")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_node_name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("node3 \t\t\t\t\t\t\t\t\t\t\t   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改当前的主机名称")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_node_address")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.13\t\t\t\t\t\t\t\t\t    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改当前的主机IP ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_sst_method")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rsync \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_causal_reads")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ON \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_buffer_pool_size")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("120M\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_format")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("row\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("default_storage_engine")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("InnoDB\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_autoinc_lock_mode")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Allow server to accept connections on all interfaces.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\nbind-address"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.13\t\t\t\t\t\t\t\t\t\t   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改成当前的主机IP")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Optional setting")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wsrep_slave_threads")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_flush_log_at_trx_commit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("在修改完配置文件并确认无误后，将 3 个节点的数据库服务关闭。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop mariadb ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node2 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop mariadb ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node3 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop mariadb ")]),s._v("\n")])])]),t("h5",{attrs:{id:"_5-启动数据库集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-启动数据库集群"}},[s._v("#")]),s._v(" 5.启动数据库集群")]),s._v(" "),t("p",[s._v("⚫启动数据库集群，在不同的节点需要使用不同的命令，在 node1 节点单独启动 MariaDB Galera Cluster 服务。")]),s._v(" "),t("p",[s._v("⚫node2 和 node3 节点启动数据库服务。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# galera_new_cluster ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node2 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl start mariadb ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node3 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl start mariadb ")]),s._v("\n")])])]),t("p",[s._v("使用命令查看端口，若看到 3306 和 4567 端口，则 MariaDB Galera Cluster 集群配置成功。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -ntpl ")]),s._v("\nActive Internet connections "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("only servers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.18:9000       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12378")]),s._v("/haproxy       \ntcp        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.15:3306       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12378")]),s._v("/haproxy       \ntcp        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.18:3306       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1813")]),s._v("/mysqld         \ntcp        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:111             "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v("/rpcbind         \ntcp        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:22              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1173")]),s._v("/sshd           \ntcp        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:4567            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1813")]),s._v("/mysqld         \ntcp        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:25            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("978")]),s._v("/master          \ntcp6       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::111                  :::*                    LISTEN      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v("/rpcbind         \ntcp6       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::22                   :::*                    LISTEN      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1173")]),s._v("/sshd           \ntcp6       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ::1:25                  :::*                    LISTEN      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("978")]),s._v("/master  \n")])])]),t("h5",{attrs:{id:"_6-验证集群功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-验证集群功能"}},[s._v("#")]),s._v(" 6.验证集群功能")]),s._v(" "),t("p",[s._v("⚫登录 node1 节点的数据库，并查看 Galera 插件是否启动。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -uroot -p000000 ")]),s._v("\n \nMariaDB "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show status like "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wsrep_ready"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n+---------------+-------+ \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Variable_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" \n+---------------+-------+ \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_ready   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ON    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" \n+---------------+-------+ \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" row "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.002")]),s._v(" sec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n\n")])])]),t("ol",[t("li",[s._v("查看到 wsrep_ready 是“ON”状态，说明 wsrep 同步已开启，Galera 集群的同步方式不同于其他类型的数据库集群使用的是 bin-log 同步，Galera 集群使用的是更底层的 wsrep 方式同步。在使用的过程中，3 个节点都可以是主节点，用户可以直接连接集群，使用感受上与单节点完全一致。继续查看集群成员数量。")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("MariaDB "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show status like "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wsrep_cluster_size"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n+--------------------+-------+ \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Variable_name      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" \n+--------------------+-------+ \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_cluster_size "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" \n+--------------------+-------+ \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" row "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.001")]),s._v(" sec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("查看 Galera 集群状态。")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("MariaDB "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show status like "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'wsrep%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+-------------------------------+------------------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Variable_name                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Value                                                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+-------------------------------+------------------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_applier_thread_count    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_apply_oooe              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000000")]),s._v("                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_apply_oool              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000000")]),s._v("                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_apply_window            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.000000")]),s._v("                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_causal_reads            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_cert_deps_distance      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.000000")]),s._v("                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_cert_index_size         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_cert_interval           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000000")]),s._v("                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_cluster_conf_id         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_cluster_size            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_cluster_state_uuid      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("92088228")]),s._v("-8e00-11ec-9433-12f0862a42d5                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_cluster_status          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Primary                                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_cluster_weight          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_commit_oooe             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000000")]),s._v("                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_commit_oool             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000000")]),s._v("                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_commit_window           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.000000")]),s._v("                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_connected               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ON                                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_desync_count            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_evs_delayed             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_evs_evict_list          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_evs_repl_latency        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/0/0/0/0                                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_evs_state               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" OPERATIONAL                                          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_flow_control_paused     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000000")]),s._v("                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_flow_control_paused_ns  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_flow_control_recv       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_flow_control_sent       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_gcomm_uuid              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 9207531a-8e00-11ec-99bc-66bde1755ac8                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_incoming_addresses      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.18:3306,192.168.1.5:3306,192.168.1.13:3306 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_last_committed          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_bf_aborts         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_cached_downto     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_cert_failures     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_commits           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_index             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_recv_queue        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_recv_queue_avg    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.100000")]),s._v("                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_recv_queue_max    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_recv_queue_min    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_replays           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_send_queue        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_send_queue_avg    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000000")]),s._v("                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_send_queue_max    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_send_queue_min    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_state             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_state_comment     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Synced                                               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_local_state_uuid        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("92088228")]),s._v("-8e00-11ec-9433-12f0862a42d5                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_open_connections        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_open_transactions       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_protocol_version        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_provider_name           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Galera                                               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_provider_vendor         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Codership Oy "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("info@codership.com"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_provider_version        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.3")]),s._v(".28"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r3875"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_ready                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ON                                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_received                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("                                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_received_bytes          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("739")]),s._v("                                                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_repl_data_bytes         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("417")]),s._v("                                                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_repl_keys               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_repl_keys_bytes         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("                                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_repl_other_bytes        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_replicated              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_replicated_bytes        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("520")]),s._v("                                                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_rollbacker_thread_count "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_thread_count            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+-------------------------------+------------------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(" rows "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.001")]),s._v(" sec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("查看连接的主机。")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("MariaDB "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show status like "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'wsrep_incoming_addresses'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n+--------------------------+------------------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Variable_name            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Value                                                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------+------------------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wsrep_incoming_addresses "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.18:3306,192.168.1.5:3306,192.168.1.13:3306 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------+------------------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" row "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000")]),s._v(" sec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);