(window.webpackJsonp=window.webpackJsonp||[]).push([[186],{500:function(t,a,s){"use strict";s.r(a);var e=s(7),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"openssl的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#openssl的使用"}},[t._v("#")]),t._v(" OpenSSL的使用")]),t._v(" "),a("h2",{attrs:{id:"原理、流程与示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原理、流程与示例"}},[t._v("#")]),t._v(" 原理、流程与示例")]),t._v(" "),a("h3",{attrs:{id:"_1-1-生成证书的步骤与原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-生成证书的步骤与原理"}},[t._v("#")]),t._v(" 1.1 生成证书的步骤与原理")]),t._v(" "),a("p",[t._v("要理解创建证书的每一步操作必须要先理解创建证书的流程和每一步的含义。生成证书的标准流程是这样的：")]),t._v(" "),a("ol",[a("li",[t._v("生成自己的私钥文件"),a("code",[t._v("(.key)")])]),t._v(" "),a("li",[t._v("基于私钥生成证书请求文件"),a("code",[t._v("(.csr)")])]),t._v(" "),a("li",[t._v("将证书请求文件(.csr)提交给证书颁发机构（CA），CA会对提交的证书请求中的所有信息生成一个摘要，然后使用CA根证书对应的私钥进行加密，这就是所谓的“签名”操作，完成签名后就会得到真正的签发证书(.cer或.crt)用户拿到签发后的证书，可能需要导入到自己的密钥库中，如Java的keystore，或根据需要再进行各种格式转换"),a("code",[t._v("(.pem .p12 .jks等等)")])])]),t._v(" "),a("p",[t._v("注意：")]),t._v(" "),a("ul",[a("li",[t._v("第1/2两步可以通过一个命令合并完成。")]),t._v(" "),a("li",[t._v("第3步向公认可信的CA机构申请证书是线上线下都要进行操作的一系列流程，申请的公司或组织还要提交各种资质和证明，与企业申请某种执照或办理某种手续性质类似，但企业最终拿到的就是一个CA签名的证书文件。所以，对于企业内部应用来说，完全可以自己创建自己的根证书，自己给自己签发证书，然后通过域控手段强制用户浏览器接受来自相应CA签发的证书。")]),t._v(" "),a("li",[t._v("再次解释一下“签名”的含义，这个概念很关键。在CA签发的证书中，包含申请者的公钥在内，几乎所有的数据都是明文的，也都是申请者自己提供的（当然CA需要审核），签发的证书唯一多出来的信息就是基于申请者提供的所有信息生成了一份摘要，然后用CA自己的私钥对摘要进行了加密，这段加密后的密文被称之为“签名”，这部分数据是返还的签发证书(.cer或.crt)中多出来的关键数据。下图是CA签发证书的原理：")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/cn-zhangyh/image/main/img/e3490b99891d433399504299d0ee6591.png",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("汇总所有的情况来看，生成证书不外乎三种情形：")]),t._v(" "),a("ul",[a("li",[t._v("标准CA签发流程")]),t._v(" "),a("li",[t._v("生成自签名证书")]),t._v(" "),a("li",[t._v("生成私有CA签发的证书")])]),t._v(" "),a("p",[t._v("对于绝大多数的开发者而言，需要使用的其实是后两种：自签名证书和私有CA签发的证书。对这两种证书的差异，笔者现在理解的还不沟透彻，需要进一步研究。网上的说法是：自签名证书无法被吊销，私有CA签发的证书可以被吊销。从它们各自的命令行工具上看，后者确实有一个撤销操作openssl ca -revoke。此外，生成这两种证书的命令也是不一样的。")]),t._v(" "),a("p",[t._v("针对私有CA签发的证书，网上有如下的建议：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("如果你的规划需要创建多个证书，那么使用私有CA的方法比较合适，因为只要给所有的客户端都安装了CA的证书，那么以该证书签名过的证书，客户端都是信任的，也就是安装一次就够了")])]),t._v(" "),a("li",[a("p",[t._v("如果你直接用自签名证书，你需要给所有的客户端安装该证书才会被信任，如果你需要第二个证书，则还的挨个给所有的客户端安装证书2才会被信任。")])])]),t._v(" "),a("h3",{attrs:{id:"_1-2-标准的ca签发流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-标准的ca签发流程"}},[t._v("#")]),t._v(" 1.2 标准的CA签发流程")]),t._v(" "),a("p",[t._v("对应文章开头提及的证书生成流程，标准CA签发流程中的第三步是需要CA机构操作的，我们会解释CA机构要做的工作。")]),t._v(" "),a("h4",{attrs:{id:"_1-2-1-创建私钥-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-创建私钥-key"}},[t._v("#")]),t._v(" 1.2.1 创建私钥(.key)")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("openssl genrsa "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-out")]),t._v(" my.key "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2048")]),t._v("\n")])])]),a("h4",{attrs:{id:"_1-2-2-创建证书签名请求-csr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-创建证书签名请求-csr"}},[t._v("#")]),t._v(" 1.2.2 创建证书签名请求(.csr)")]),t._v(" "),a("p",[t._v("要基于私钥创建证书签名请求")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("openssl req "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-key")]),t._v(" my.key "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-out")]),t._v(" my.csr "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-subj")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/C=CN/ST=shanghai/L=shanghai/O=example/OU=it/CN=domain1/CN=domain2"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者")]),t._v("\nroot@fisco-server-2:~/ssl"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# openssl req -new -days 36500 -key server.key -out server.csr ")]),t._v("\nIgnoring -days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" not generating a certificate\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.'")]),t._v(", the field will be left blank.\n-----\nCountry Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" letter code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("AU"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":CN    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##国家地区")]),t._v("\nState or Province Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("full name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Some-State"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":HS  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##省份名称")]),t._v("\nLocality Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, city"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":ShangHai  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##城市名称")]),t._v("\nOrganization Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, company"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Internet Widgits Pty Ltd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":BTC   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##组织名称")]),t._v("\nOrganizational Unit Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, section"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":ops   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##组织单位名称")]),t._v("\nCommon Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e.g. server FQDN or YOUR name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":zyh   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##域名 ")]),t._v("\nEmail Address "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":zyh@163.com   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 邮箱")]),t._v("\n\nPlease enter the following "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'extra'")]),t._v(" attributes  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加一个而外的密码，请问文件时需要输入的，所以可有可无")]),t._v("\nto be sent with your certificate request \nA challenge password "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":\nAn optional company name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":\n")])])]),a("h4",{attrs:{id:"_1-2-3-生成私钥和证书签名请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3-生成私钥和证书签名请求"}},[t._v("#")]),t._v(" 1.2.3 生成私钥和证书签名请求")]),t._v(" "),a("p",[t._v("两个关键参数：")]),t._v(" "),a("ul",[a("li",[t._v("-newkey rsa:2048 -> 生成一个新的证书签名请求，同时生成一个2048位的RSA私钥")]),t._v(" "),a("li",[t._v("-nodes -> 不对新私钥加密")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("openssl req "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-newkey")]),t._v(" rsa:2048 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-nodes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-keyout")]),t._v(" my.key "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-out")]),t._v(" my.csr "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-subj")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/C=CN/ST=shanghai/L=shanghai/O=example/OU=it/CN=domain1/CN=domain2"')]),t._v("\n")])])]),a("p",[t._v("将证书申请请求（.csr）提交给CA认证机构申请证书（.crt）：")]),t._v(" "),a("ul",[a("li",[t._v("但是在CA机构那里，执行人员一定会使用CA自己的密钥对CSR进行签名操作，这一步操作与我们将在第4节介绍的使用私有CA证书对应的私钥进行签名性质上是一样的。")]),t._v(" "),a("li",[t._v("从CSR到CRT，就是一个签名过程，这个过程需要用签发方的私钥。走标准CA签发流程，是CA机构来操作，用的是他的根证书对应的私钥来签名；走自签名证书或私有CA证书的流程，用的就是自己的私钥。")])]),t._v(" "),a("h3",{attrs:{id:"_1-3-生成自签证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-生成自签证书"}},[t._v("#")]),t._v(" 1.3 生成自签证书")]),t._v(" "),a("h4",{attrs:{id:"_1-3-1-创建私钥-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-创建私钥-key"}},[t._v("#")]),t._v(" 1.3.1 创建私钥(.key)")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("openssl genrsa "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-out")]),t._v(" my.key "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2048")]),t._v("\n")])])]),a("h4",{attrs:{id:"_1-3-2-创建证书签名请求-csr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-创建证书签名请求-csr"}},[t._v("#")]),t._v(" 1.3.2 创建证书签名请求(.csr)")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("openssl req "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-key")]),t._v(" my.key "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-out")]),t._v(" my.csr "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-subj")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/C=CN/ST=shanghai/L=shanghai/O=example/OU=it/CN=domain1/CN=domain2"')]),t._v("\n")])])]),a("h4",{attrs:{id:"_1-3-3-生成自签名证书-crt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-生成自签名证书-crt"}},[t._v("#")]),t._v(" 1.3.3 生成自签名证书(.crt)")]),t._v(" "),a("p",[t._v("对于这条命令，要注意以下几点：")]),t._v(" "),a("ol",[a("li",[t._v("这个命令是"),a("code",[t._v("openssl x509")]),t._v("，"),a("code",[t._v("-req")]),t._v("是参数，和前面生成证书签名请求的"),a("code",[t._v("openssl req")]),t._v("命令不同。")]),t._v(" "),a("li",[a("code",[t._v("-signkey my.key")]),t._v("配置清晰地表明使用自己的私钥进行签名。")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("openssl x509 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-req")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-in")]),t._v(" my.csr "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-out")]),t._v(" my.crt "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-signkey")]),t._v(" my.key "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-days")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3650")]),t._v("\n")])])]),a("h3",{attrs:{id:"_1-4-生成私有ca签发的证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-生成私有ca签发的证书"}},[t._v("#")]),t._v(" 1.4 生成私有CA签发的证书")]),t._v(" "),a("p",[t._v("与生成自签名证书不同地方在于，生成自签名证书场景下只有一个参与方，请求证书和签发证书都是自己，而生成私有CA证书的场景里开始涉及两个角色了:")]),t._v(" "),a("ul",[a("li",[t._v("签发证书的一方：CA（主要牵涉的是CA私钥和根证书）")]),t._v(" "),a("li",[t._v("请求签发证书的一方：如服务器")])]),t._v(" "),a("p",[t._v("为了变于区别，我们把它相关的文件分别用ca和server加以区别")]),t._v(" "),a("h4",{attrs:{id:"_1-4-1-生成ca的私钥签名证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-1-生成ca的私钥签名证书"}},[t._v("#")]),t._v(" 1.4.1 生成CA的私钥签名证书")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("openssl req "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-x509")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-newkey")]),t._v(" rsa:2048 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-nodes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-keyout")]),t._v(" ca.key "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-out")]),t._v(" ca.crt "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-days")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3650")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-subj")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/C=CN/ST=shanghai/L=shanghai/O=example/OU=it/CN=domain1/CN=domain2"')]),t._v("\n")])])]),a("h4",{attrs:{id:"_1-4-2-生成server的私钥签名请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-2-生成server的私钥签名请求"}},[t._v("#")]),t._v(" 1.4.2 生成Server的私钥签名请求")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("openssl req "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-newkey")]),t._v(" rsa:2048 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-nodes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-keyout")]),t._v(" server.key "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-out")]),t._v(" server.csr "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-subj")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/C=CN/ST=shanghai/L=shanghai/O=example/OU=it/CN=domain1/CN=domain2"')]),t._v("\n")])])]),a("h4",{attrs:{id:"_1-4-3-使用ca签名证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-3-使用ca签名证书"}},[t._v("#")]),t._v(" 1.4.3 使用CA签名证书")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("openssl x509 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-req")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-in")]),t._v(" server.csr "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-CA")]),t._v(" ca.crt "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-CAkey")]),t._v(" ca.key "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-CAcreateserial")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-out")]),t._v(" server.crt "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-days")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3650")]),t._v("\n")])])]),a("p",[t._v("关于"),a("code",[t._v("-CAcreateserial")])]),t._v(" "),a("ul",[a("li",[t._v("当签署证书时，CA 需要为每个证书生成一个唯一的序列号，由于每个证书的序列号对于每个颁发者都必须是唯一的，因此颁发者需要跟踪它以前使用过哪些序列号，以确保它不会重复使用任何序列号。OpenSSL 提供了一种使用序列号文件进行跟踪的简单方法。当你指定 -CAcreateserial 时，它会将序列号 01 或一个随机数分配给签名证书，然后创建此序列号文件。在未来的签名操作中，应该使用 -CAserial 和该文件的名称，而不是-CAcreateserial，并且 OpenSSL 将为每个签名的证书增加该文件中的值。这样，你可以用一个颁发者证书签署一堆证书，并且它们的所有序列号都是唯一的。")])]),t._v(" "),a("h3",{attrs:{id:"_1-5-openssl-req命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-openssl-req命令"}},[t._v("#")]),t._v(" 1.5 openssl req命令")]),t._v(" "),a("p",[t._v("由于创建证书的关键命令是openssl req命令，此处特别罗列一个这个命令的关键参数。")]),t._v(" "),a("h4",{attrs:{id:"_1-5-1-命令详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-1-命令详解"}},[t._v("#")]),t._v(" 1.5.1 命令详解")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-days")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n指定证书有效期，默认是30天，与 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-x509")]),t._v(" 选项一起使用\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-newkey")]),t._v(" rsa:2048\n生成一个新的证书申请，同时生成一个 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2048")]),t._v(" 位的 RSA 私钥\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-keyout")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("keyfile"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n新私钥要写入的文件\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-nodes")]),t._v("\n不对新私钥加密\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-key")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("keyfile"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n读取指定的私钥文件.\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-text")]),t._v("\n同时打印纯文本版本和编码版本信息\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-noout")]),t._v("\n不打印编码后版本 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BASE64编码"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-new")]),t._v("\n生成一个新的证书申请，会提示用户输入相关字段的值，如果没有 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-key")]),t._v(" 选项，会使用指定配置文件中的信息生成一个新的 RSA 私钥.\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-x509")]),t._v("\n输出自签名的证书，而不是请求一个证书. 通常用于生成测试证书或自签名的根证书.\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-subj")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("arg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n申请人信息，格式是 /C"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("CN/O"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Corp/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("./CN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("www.ez.com，可以使用 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" 转义，不会跳过空格.\n\n-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("digets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 指定签署请求时使用的信息摘要算法，如 -md5，-sha1，-sha256\n")])])]),a("h4",{attrs:{id:"_1-5-2-subj参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-2-subj参数"}},[t._v("#")]),t._v(" 1.5.2 "),a("code",[t._v("-subj")]),t._v("参数")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("/C"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Country 国家\n/ST"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" State or Province 省\n/L"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Location or City 城市\n/O"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Organization 组织或企业\n/OU"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Organization Unit 部门\n/CN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Common Name 域名或IP\n")])])]),a("h3",{attrs:{id:"_1-6-完整创建流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-完整创建流程"}},[t._v("#")]),t._v(" 1.6 完整创建流程")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("操作系统")]),t._v(" "),a("th",[t._v("OpenSSL版本")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Ubuntu")]),t._v(" "),a("td",[t._v("1.1.1")])])])]),t._v(" "),a("h4",{attrs:{id:"_1-6-1-配置openssl"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-1-配置openssl"}},[t._v("#")]),t._v(" 1.6.1 配置OpenSSL")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("root@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vim  /etc/ssl/openssl.cnf ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("####################################################################")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" ca "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ndefault_ca      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CA_default            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The default ca section")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("####################################################################")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" CA_default "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dir")]),t._v("             "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /root/ssl/            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置一个存放证书的目录")]),t._v("\ncerts           "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/certs            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Where the issued certs are kept")]),t._v("\ncrl_dir         "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/crl              "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Where the issued crl are kept")]),t._v("\ndatabase        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/index.txt        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# database index file.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#unique_subject = no                    # Set to 'no' to allow creation of")]),t._v("\n                                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# several certs with same subject.")]),t._v("\nnew_certs_dir   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/newcerts         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# default place for new certs.")]),t._v("\n\ncertificate     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/cacert.pem       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The CA certificate")]),t._v("\nserial          "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/serial           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The current serial number")]),t._v("\ncrlnumber       "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/crlnumber        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# the current crl number")]),t._v("\n                                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# must be commented out to leave a V1 CRL")]),t._v("\ncrl             "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/crl.pem          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The current CRL")]),t._v("\nprivate_key     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/private/cakey.pem"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The private key")]),t._v("\n\nx509_extensions "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" usr_cert              "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The extensions to add to the cert")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Comment out the following two lines for the "traditional"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# (and highly broken) format.")]),t._v("\nname_opt        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ca_default            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Subject Name options")]),t._v("\ncert_opt        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ca_default            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Certificate field options")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("####################################################################")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" tsa "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\ndefault_tsa "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tsa_config1       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# the default TSA section")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" tsa_config1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# These are used by the TSA reply generation only.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dir")]),t._v("             "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /root/ssl             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# TSA的根目录")]),t._v("\nserial          "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/tsaserial        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The current serial number (mandatory)")]),t._v("\ncrypto_device   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("builtin")]),t._v("               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# OpenSSL engine to use for signing")]),t._v("\nsigner_cert     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/tsacert.pem      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The TSA signing certificate")]),t._v("\n                                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# (optional)")]),t._v("\ncerts           "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/cacert.pem       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Certificate chain to include in reply")]),t._v("\n                                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# (optional)")]),t._v("\nsigner_key      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v("/private/tsakey.pem "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The TSA private key (optional)")]),t._v("\nsigner_digest  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sha256                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Signing digest to use. (Optional)")]),t._v("\ndefault_policy  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tsa_policy1           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Policy if request did not specify it")]),t._v("\n                                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# (optional)")]),t._v("\n")])])]),a("h4",{attrs:{id:"_1-6-2-开始创建证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-2-开始创建证书"}},[t._v("#")]),t._v(" 1.6.2 开始创建证书")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("root@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pwd")]),t._v("\n/root/ssl\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建CA私钥")]),t._v("\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# openssl genrsa -out CA.key 2048")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 制作CA公钥")]),t._v("\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# openssl req -sha256 -new -x509 -days 36500 -key CA.key -out CA.crt -config /etc/pki/tls/openssl.cnf")]),t._v("\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.'")]),t._v(", the field will be left blank.\n-----\nCountry Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" letter code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("XX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":CN\nState or Province Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("full name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":SH\nLocality Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, city"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Default City"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":ShangHai\nOrganization Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, company"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Default Company Ltd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":BTC      \nOrganizational Unit Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, section"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":LAYZER  \nCommon Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, your name or your server's "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hostname")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":LayzerSign CA   \nEmail Address "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":layzer@163.com\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 当然上述的公钥制作方式需要交互式输入信息，如果不想频繁输入，那么可以使用如下命令：")]),t._v("\nopenssl req "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-sha256")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-x509")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-days")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("36500")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-key")]),t._v(" CA.key "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-out")]),t._v(" CA.crt "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-config")]),t._v(" /etc/pki/tls/openssl.cnf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-subj")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/C=CN/ST=SH/L=ShangHai/O=BTC/OU=LAYZER/CN=LayzerSign CA/emailAddress=layzer@163.com"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 上面做完之后我们看看现在我们的到了什么")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@virtual_host ssl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\nCA.crt  CA.key\n")])])]),a("h4",{attrs:{id:"_1-6-3-自签证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-3-自签证书"}},[t._v("#")]),t._v(" 1.6.3 自签证书")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#我们的操作步骤为：")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("：生成域名私钥\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("：生成证书签发请求文件\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("：使用自签署的CA，生成域名公钥\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1：生成 layzer.com.key 密钥")]),t._v("\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# openssl genrsa -out layzer.com.key 2048")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2：生成 layzer.com.csr 证书签发请求  交互式")]),t._v("\n\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# openssl req -new -sha256 -key layzer.com.key -out layzer.com.csr -config /etc/pki/tls/openssl.cnf")]),t._v("\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.'")]),t._v(", the field will be left blank.\n-----\nCountry Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" letter code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("XX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":CN\nState or Province Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("full name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":SH\nLocality Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, city"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Default City"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":ShangHai\nOrganization Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, company"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Default Company Ltd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":BTC\nOrganizational Unit Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, section"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":LAYZER\nCommon Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, your name or your server"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s hostname) []:*.layzer.com   # 这个就是要申请的泛域名\nEmail Address []:layzer@163.com\n\nPlease enter the following '")]),t._v("extra"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("' attributes\nto be sent with your certificate request\nA challenge password []:123456\nAn optional company name []:BTC\n\n# 当然了这个也有非交互式\nopenssl req -new -sha256 -key layzer.com.key -out layzer.com.csr -config /etc/pki/tls/openssl.cnf -subj \"/C=CN/ST=SH/L=ShangHai/O=BTC/OU=LAYZER/CN=*.layzer.com/emailAddress=layzer@163.com\"\n\n# 查看签名请求文件信息\nroot@server-2:~# openssl req -in layzer.com.csr -text\n\n# 使用自签署的CA，签署layzer.com.crt\nroot@server-2:~# openssl ca -in layzer.com.csr -md sha256 -days 36500 -out layzer.com.crt -cert CA.crt -keyfile CA.key -config /etc/pki/tls/openssl.cnf\n\n# 当然了，我们可能会遇到如下报错\nUsing configuration from /etc/pki/tls/openssl.cnf\n/etc/pki/CA/index.txt: No such file or directory\nunable to open '")]),t._v("/etc/pki/CA/index.txt"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\n140216322066320:error:02001002:system library:fopen:No such file or directory:bss_file.c:402:fopen('")]),t._v("/etc/pki/CA/index.txt"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("','")]),t._v("r"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("')\n140216322066320:error:20074002:BIO routines:FILE_CTRL:system lib:bss_file.c:404:\n\n# 解决方法如下：\nroot@server-2:~# touch /etc/pki/CA/index.txt\n\n# 还有另外的报错：\nUsing configuration from /etc/pki/tls/openssl.cnf\n/etc/pki/CA/serial: No such file or directory\nerror while loading serial number\n140152413099920:error:02001002:system library:fopen:No such file or directory:bss_file.c:402:fopen('")]),t._v("/etc/pki/CA/serial"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("','")]),t._v("r'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("140152413099920")]),t._v(":error:20074002:BIO routines:FILE_CTRL:system lib:bss_file.c:404:\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解决方法如下：")]),t._v("\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# echo "01" > /etc/pki/CA/serial')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@virtual_host ssl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# openssl ca -in layzer.com.csr -md sha256 -days 36500 -out layzer.com.crt -cert CA.crt -keyfile CA.key -config /etc/pki/tls/openssl.cnf")]),t._v("\nUsing configuration from /etc/pki/tls/openssl.cnf\nCheck that the request matches the signature\nSignature ok\nCertificate Details:\n        Serial Number: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0x1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        Validity\n            Not Before: Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":39:16 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v(" GMT\n            Not After "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Jul "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":39:16 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2122")]),t._v(" GMT\n        Subject:\n            countryName               "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CN\n            stateOrProvinceName       "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SH\n            organizationName          "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" BTC\n            organizationalUnitName    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LAYZER\n            commonName                "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" *.layzer.com\n            emailAddress              "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" layzer@163.com\n        X509v3 extensions:\n            X509v3 Basic Constraints: \n                CA:FALSE\n            Netscape Comment: \n                OpenSSL Generated Certificate\n            X509v3 Subject Key Identifier: \n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("46")]),t._v(":F3:0D:B9:6B:7F:4C:6B:C0:F6:CE:47:F8:E6:39:9E:09:F9:2F:69\n            X509v3 Authority Key Identifier: \n                keyid:9B:E9:58:13:45:7F:EF:7D:92:7D:AE:73:09:A3:9A:77:99:16:3E:30\n\nCertificate is to be certified "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("until")]),t._v(" Jul "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":39:16 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2122")]),t._v(" GMT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("36500")]),t._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nSign the certificate? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":y  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输入y确认")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" out of "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" certificate requests certified, commit? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("y   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输入y确认")]),t._v("\nWrite out database with "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" new entries\nData Base Updated\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 检查部署是否正常")]),t._v("\n\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat /etc/pki/CA/index.txt")]),t._v("\nV\t21220727173916Z\t\t01\tunknown\t/C"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("CN/ST"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("SH/O"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("BTC/OU"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("LAYZER/CN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("*.layzer.com/emailAddress"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("layzer@163.com\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat /etc/pki/CA/serial")]),t._v("\n02\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这证明我们的证书颁发已经被记录了。")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注：同一个域名不能签署多次；由于签署了*.layzer.com，且已经被记录，因此不能再次被签署。除非删除该记录。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注：注意index.txt文件和serial文件的关系。serial文件内容为index.txt文件内容行数加1。")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看证书信息")]),t._v("\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# openssl x509 -in layzer.com.crt -text")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 验证签发证书是否有效")]),t._v("\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# openssl verify -CAfile CA.crt layzer.com.crt ")]),t._v("\nlayzer.com.crt: OK\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 看看目前我们有什么")]),t._v("\n\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ll")]),t._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1399")]),t._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(":27 CA.crt\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1675")]),t._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v(" CA.key\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4576")]),t._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(":39 layzer.com.crt\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1041")]),t._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(":35 layzer.com.csr\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1675")]),t._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(":31 layzer.com.key\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 转换证书给Nginx使用")]),t._v("\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# openssl x509 -in layzer.com.crt -out layzer.com.pem -outform PEM")]),t._v("\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ll")]),t._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1399")]),t._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(":27 CA.crt\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1675")]),t._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v(" CA.key\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4576")]),t._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(":39 layzer.com.crt\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1041")]),t._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(":35 layzer.com.csr\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1675")]),t._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(":31 layzer.com.key\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1419")]),t._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(":44 layzer.com.pem\n")])])]),a("h4",{attrs:{id:"_1-6-4-测试证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-4-测试证书"}},[t._v("#")]),t._v(" 1.6.4 测试证书")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("root@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mkdir /etc/nginx/ssl")]),t._v("\nroot@server-2:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cp layzer.com.pem layzer.com.key /etc/nginx/ssl/")]),t._v("\n")])])]),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("   layzer.com")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(" https://layzer.com")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v(" ssl http2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  layzer.com")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("   /usr/share/nginx/html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v("  index.html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate")]),t._v("     /etc/nginx/ssl/layzer.com.pem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate_key")]),t._v(" /etc/nginx/ssl/layzer.com.key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_protocols")]),t._v(" TLSv1 TLSv1.1 TLSv1.2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_session_cache")]),t._v("   shared:SSL:10m")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_session_timeout")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10m")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);