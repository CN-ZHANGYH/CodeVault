<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>慈善公益解决方案 | CodeVault文档站</title>
    <meta name="generator" content="VuePress 1.9.2">
    <link rel="icon" href="/CodeVault/img/Aj.svg">
    <meta name="description" content="CodeVault一个记录云计算、云原生、Java开发的文档站。">
    <meta name="keywords" content="vuepress,theme,blog,vdoing">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/CodeVault/assets/css/0.styles.bcdd6f38.css" as="style"><link rel="preload" href="/CodeVault/assets/js/app.ef278985.js" as="script"><link rel="preload" href="/CodeVault/assets/js/2.f96441c8.js" as="script"><link rel="preload" href="/CodeVault/assets/js/225.03a64323.js" as="script"><link rel="prefetch" href="/CodeVault/assets/js/10.0b981dbd.js"><link rel="prefetch" href="/CodeVault/assets/js/100.5c06c78f.js"><link rel="prefetch" href="/CodeVault/assets/js/101.88d67c9c.js"><link rel="prefetch" href="/CodeVault/assets/js/102.70928850.js"><link rel="prefetch" href="/CodeVault/assets/js/103.ef636770.js"><link rel="prefetch" href="/CodeVault/assets/js/104.c1927b63.js"><link rel="prefetch" href="/CodeVault/assets/js/105.85c8a7cd.js"><link rel="prefetch" href="/CodeVault/assets/js/106.fb2e66ea.js"><link rel="prefetch" href="/CodeVault/assets/js/107.0f35bf63.js"><link rel="prefetch" href="/CodeVault/assets/js/108.fccb735c.js"><link rel="prefetch" href="/CodeVault/assets/js/109.682036f0.js"><link rel="prefetch" href="/CodeVault/assets/js/11.ac4d24fe.js"><link rel="prefetch" href="/CodeVault/assets/js/110.b7f8edea.js"><link rel="prefetch" href="/CodeVault/assets/js/111.fd94666b.js"><link rel="prefetch" href="/CodeVault/assets/js/112.a07708f0.js"><link rel="prefetch" href="/CodeVault/assets/js/113.63efff87.js"><link rel="prefetch" href="/CodeVault/assets/js/114.ab1099fa.js"><link rel="prefetch" href="/CodeVault/assets/js/115.f5fe6b28.js"><link rel="prefetch" href="/CodeVault/assets/js/116.6ce08e8e.js"><link rel="prefetch" href="/CodeVault/assets/js/117.48dbb04e.js"><link rel="prefetch" href="/CodeVault/assets/js/118.5b909be0.js"><link rel="prefetch" href="/CodeVault/assets/js/119.8f6e0bf7.js"><link rel="prefetch" href="/CodeVault/assets/js/12.c1e5feb4.js"><link rel="prefetch" href="/CodeVault/assets/js/120.21cc7ba5.js"><link rel="prefetch" href="/CodeVault/assets/js/121.04134de2.js"><link rel="prefetch" href="/CodeVault/assets/js/122.31567951.js"><link rel="prefetch" href="/CodeVault/assets/js/123.002f9bee.js"><link rel="prefetch" href="/CodeVault/assets/js/124.e99e860a.js"><link rel="prefetch" href="/CodeVault/assets/js/125.72c926b3.js"><link rel="prefetch" href="/CodeVault/assets/js/126.01a5e87f.js"><link rel="prefetch" href="/CodeVault/assets/js/127.1956ebe6.js"><link rel="prefetch" href="/CodeVault/assets/js/128.d65996f5.js"><link rel="prefetch" href="/CodeVault/assets/js/129.67eabc56.js"><link rel="prefetch" href="/CodeVault/assets/js/13.13f84e24.js"><link rel="prefetch" href="/CodeVault/assets/js/130.634c4ce3.js"><link rel="prefetch" href="/CodeVault/assets/js/131.a418f195.js"><link rel="prefetch" href="/CodeVault/assets/js/132.ea662f19.js"><link rel="prefetch" href="/CodeVault/assets/js/133.63b2b38b.js"><link rel="prefetch" href="/CodeVault/assets/js/134.0cd9f3da.js"><link rel="prefetch" href="/CodeVault/assets/js/135.4e8913a1.js"><link rel="prefetch" href="/CodeVault/assets/js/136.53ad8182.js"><link rel="prefetch" href="/CodeVault/assets/js/137.8d8f6ff4.js"><link rel="prefetch" href="/CodeVault/assets/js/138.1e5627de.js"><link rel="prefetch" href="/CodeVault/assets/js/139.4c335178.js"><link rel="prefetch" href="/CodeVault/assets/js/14.92742bc3.js"><link rel="prefetch" href="/CodeVault/assets/js/140.ad32a483.js"><link rel="prefetch" href="/CodeVault/assets/js/141.509650db.js"><link rel="prefetch" href="/CodeVault/assets/js/142.8a4692a4.js"><link rel="prefetch" href="/CodeVault/assets/js/143.4226943d.js"><link rel="prefetch" href="/CodeVault/assets/js/144.a04016d3.js"><link rel="prefetch" href="/CodeVault/assets/js/145.55b32ea3.js"><link rel="prefetch" href="/CodeVault/assets/js/146.d78a1fa5.js"><link rel="prefetch" href="/CodeVault/assets/js/147.c48fa78d.js"><link rel="prefetch" href="/CodeVault/assets/js/148.24a7cd95.js"><link rel="prefetch" href="/CodeVault/assets/js/149.a74e35f1.js"><link rel="prefetch" href="/CodeVault/assets/js/15.6953f44b.js"><link rel="prefetch" href="/CodeVault/assets/js/150.7f27817b.js"><link rel="prefetch" href="/CodeVault/assets/js/151.6445d326.js"><link rel="prefetch" href="/CodeVault/assets/js/152.eadc171d.js"><link rel="prefetch" href="/CodeVault/assets/js/153.2da9c7f8.js"><link rel="prefetch" href="/CodeVault/assets/js/154.a3546076.js"><link rel="prefetch" href="/CodeVault/assets/js/155.351a616f.js"><link rel="prefetch" href="/CodeVault/assets/js/156.e6bbf3b3.js"><link rel="prefetch" href="/CodeVault/assets/js/157.ee152deb.js"><link rel="prefetch" href="/CodeVault/assets/js/158.076e0f8c.js"><link rel="prefetch" href="/CodeVault/assets/js/159.9ad1744e.js"><link rel="prefetch" href="/CodeVault/assets/js/16.df859e45.js"><link rel="prefetch" href="/CodeVault/assets/js/160.c5beea39.js"><link rel="prefetch" href="/CodeVault/assets/js/161.0cf956e1.js"><link rel="prefetch" href="/CodeVault/assets/js/162.c58e81e1.js"><link rel="prefetch" href="/CodeVault/assets/js/163.63d65593.js"><link rel="prefetch" href="/CodeVault/assets/js/164.9626ab8a.js"><link rel="prefetch" href="/CodeVault/assets/js/165.fc09035b.js"><link rel="prefetch" href="/CodeVault/assets/js/166.b38be38b.js"><link rel="prefetch" href="/CodeVault/assets/js/167.8f5417ed.js"><link rel="prefetch" href="/CodeVault/assets/js/168.d636e649.js"><link rel="prefetch" href="/CodeVault/assets/js/169.dd84c459.js"><link rel="prefetch" href="/CodeVault/assets/js/17.a2971fe6.js"><link rel="prefetch" href="/CodeVault/assets/js/170.a488616f.js"><link rel="prefetch" href="/CodeVault/assets/js/171.a7896a98.js"><link rel="prefetch" href="/CodeVault/assets/js/172.90b58f0e.js"><link rel="prefetch" href="/CodeVault/assets/js/173.ce66d68a.js"><link rel="prefetch" href="/CodeVault/assets/js/174.d0a94b6a.js"><link rel="prefetch" href="/CodeVault/assets/js/175.87ea7df7.js"><link rel="prefetch" href="/CodeVault/assets/js/176.67abf34b.js"><link rel="prefetch" href="/CodeVault/assets/js/177.3b2acda5.js"><link rel="prefetch" href="/CodeVault/assets/js/178.5fe697a5.js"><link rel="prefetch" href="/CodeVault/assets/js/179.57349e36.js"><link rel="prefetch" href="/CodeVault/assets/js/18.45b06c71.js"><link rel="prefetch" href="/CodeVault/assets/js/180.a8b6136e.js"><link rel="prefetch" href="/CodeVault/assets/js/181.c96cb1ac.js"><link rel="prefetch" href="/CodeVault/assets/js/182.e13a2ed6.js"><link rel="prefetch" href="/CodeVault/assets/js/183.4982d955.js"><link rel="prefetch" href="/CodeVault/assets/js/184.123e3912.js"><link rel="prefetch" href="/CodeVault/assets/js/185.c1db2bfa.js"><link rel="prefetch" href="/CodeVault/assets/js/186.bff6dc40.js"><link rel="prefetch" href="/CodeVault/assets/js/187.3e10e06d.js"><link rel="prefetch" href="/CodeVault/assets/js/188.53f01570.js"><link rel="prefetch" href="/CodeVault/assets/js/189.53c9b973.js"><link rel="prefetch" href="/CodeVault/assets/js/19.21381c2f.js"><link rel="prefetch" href="/CodeVault/assets/js/190.f9e298a3.js"><link rel="prefetch" href="/CodeVault/assets/js/191.7055ec43.js"><link rel="prefetch" href="/CodeVault/assets/js/192.6083d608.js"><link rel="prefetch" href="/CodeVault/assets/js/193.72e5d099.js"><link rel="prefetch" href="/CodeVault/assets/js/194.cb4c2f87.js"><link rel="prefetch" href="/CodeVault/assets/js/195.add61432.js"><link rel="prefetch" href="/CodeVault/assets/js/196.cafb716f.js"><link rel="prefetch" href="/CodeVault/assets/js/197.29ad1cb1.js"><link rel="prefetch" href="/CodeVault/assets/js/198.1ca9886c.js"><link rel="prefetch" href="/CodeVault/assets/js/199.28f7095d.js"><link rel="prefetch" href="/CodeVault/assets/js/20.fe478246.js"><link rel="prefetch" href="/CodeVault/assets/js/200.cdd91d66.js"><link rel="prefetch" href="/CodeVault/assets/js/201.568571d0.js"><link rel="prefetch" href="/CodeVault/assets/js/202.0b55d1cd.js"><link rel="prefetch" href="/CodeVault/assets/js/203.c9d7036e.js"><link rel="prefetch" href="/CodeVault/assets/js/204.f877fa44.js"><link rel="prefetch" href="/CodeVault/assets/js/205.f7dcea25.js"><link rel="prefetch" href="/CodeVault/assets/js/206.266f6bb0.js"><link rel="prefetch" href="/CodeVault/assets/js/207.962cdf0e.js"><link rel="prefetch" href="/CodeVault/assets/js/208.dcbb7fb9.js"><link rel="prefetch" href="/CodeVault/assets/js/209.89cb12fb.js"><link rel="prefetch" href="/CodeVault/assets/js/21.1a17ddc5.js"><link rel="prefetch" href="/CodeVault/assets/js/210.442ced55.js"><link rel="prefetch" href="/CodeVault/assets/js/211.6d14fe33.js"><link rel="prefetch" href="/CodeVault/assets/js/212.65a1883d.js"><link rel="prefetch" href="/CodeVault/assets/js/213.21351702.js"><link rel="prefetch" href="/CodeVault/assets/js/214.bd781706.js"><link rel="prefetch" href="/CodeVault/assets/js/215.f30b644c.js"><link rel="prefetch" href="/CodeVault/assets/js/216.587501ff.js"><link rel="prefetch" href="/CodeVault/assets/js/217.8db2123f.js"><link rel="prefetch" href="/CodeVault/assets/js/218.aa6b1af6.js"><link rel="prefetch" href="/CodeVault/assets/js/219.2b27640b.js"><link rel="prefetch" href="/CodeVault/assets/js/22.7652d0d6.js"><link rel="prefetch" href="/CodeVault/assets/js/220.eafe6218.js"><link rel="prefetch" href="/CodeVault/assets/js/221.ab153f73.js"><link rel="prefetch" href="/CodeVault/assets/js/222.4f7df33b.js"><link rel="prefetch" href="/CodeVault/assets/js/223.6f5b1e03.js"><link rel="prefetch" href="/CodeVault/assets/js/224.6bed6414.js"><link rel="prefetch" href="/CodeVault/assets/js/226.2db9dc4b.js"><link rel="prefetch" href="/CodeVault/assets/js/227.6e01bc51.js"><link rel="prefetch" href="/CodeVault/assets/js/228.d06cad32.js"><link rel="prefetch" href="/CodeVault/assets/js/229.3f46b203.js"><link rel="prefetch" href="/CodeVault/assets/js/23.8a5bbf3f.js"><link rel="prefetch" href="/CodeVault/assets/js/230.b84fd605.js"><link rel="prefetch" href="/CodeVault/assets/js/231.ca2e1834.js"><link rel="prefetch" href="/CodeVault/assets/js/232.e572f662.js"><link rel="prefetch" href="/CodeVault/assets/js/233.0a7e6deb.js"><link rel="prefetch" href="/CodeVault/assets/js/234.9dddbcb6.js"><link rel="prefetch" href="/CodeVault/assets/js/235.b4ed574b.js"><link rel="prefetch" href="/CodeVault/assets/js/236.252b1f69.js"><link rel="prefetch" href="/CodeVault/assets/js/237.c529d9c4.js"><link rel="prefetch" href="/CodeVault/assets/js/238.16da920c.js"><link rel="prefetch" href="/CodeVault/assets/js/239.14f7892d.js"><link rel="prefetch" href="/CodeVault/assets/js/24.1ca1bd80.js"><link rel="prefetch" href="/CodeVault/assets/js/240.d00a46df.js"><link rel="prefetch" href="/CodeVault/assets/js/25.43c779a1.js"><link rel="prefetch" href="/CodeVault/assets/js/26.bdfe293e.js"><link rel="prefetch" href="/CodeVault/assets/js/27.330c11f5.js"><link rel="prefetch" href="/CodeVault/assets/js/28.46dfe7f4.js"><link rel="prefetch" href="/CodeVault/assets/js/29.4fc19b1e.js"><link rel="prefetch" href="/CodeVault/assets/js/3.44fcbdc8.js"><link rel="prefetch" href="/CodeVault/assets/js/30.da1d9fd7.js"><link rel="prefetch" href="/CodeVault/assets/js/31.df871787.js"><link rel="prefetch" href="/CodeVault/assets/js/32.e62268d4.js"><link rel="prefetch" href="/CodeVault/assets/js/33.b2c675b0.js"><link rel="prefetch" href="/CodeVault/assets/js/34.461e2f23.js"><link rel="prefetch" href="/CodeVault/assets/js/35.2666157f.js"><link rel="prefetch" href="/CodeVault/assets/js/36.b55a4b34.js"><link rel="prefetch" href="/CodeVault/assets/js/37.556ba5c1.js"><link rel="prefetch" href="/CodeVault/assets/js/38.8c982590.js"><link rel="prefetch" href="/CodeVault/assets/js/39.a7850266.js"><link rel="prefetch" href="/CodeVault/assets/js/4.8a0557a7.js"><link rel="prefetch" href="/CodeVault/assets/js/40.9a11a440.js"><link rel="prefetch" href="/CodeVault/assets/js/41.c3a71e10.js"><link rel="prefetch" href="/CodeVault/assets/js/42.7e9779c1.js"><link rel="prefetch" href="/CodeVault/assets/js/43.e017fec5.js"><link rel="prefetch" href="/CodeVault/assets/js/44.22c5aef3.js"><link rel="prefetch" href="/CodeVault/assets/js/45.dfe95d23.js"><link rel="prefetch" href="/CodeVault/assets/js/46.10af373d.js"><link rel="prefetch" href="/CodeVault/assets/js/47.a1e4779a.js"><link rel="prefetch" href="/CodeVault/assets/js/48.3142bf91.js"><link rel="prefetch" href="/CodeVault/assets/js/49.08546fe2.js"><link rel="prefetch" href="/CodeVault/assets/js/5.1bad1047.js"><link rel="prefetch" href="/CodeVault/assets/js/50.75c37eaf.js"><link rel="prefetch" href="/CodeVault/assets/js/51.b2f39f65.js"><link rel="prefetch" href="/CodeVault/assets/js/52.97fc3d07.js"><link rel="prefetch" href="/CodeVault/assets/js/53.1a2a51df.js"><link rel="prefetch" href="/CodeVault/assets/js/54.09f7dfd6.js"><link rel="prefetch" href="/CodeVault/assets/js/55.d112e5e2.js"><link rel="prefetch" href="/CodeVault/assets/js/56.b7b00837.js"><link rel="prefetch" href="/CodeVault/assets/js/57.5beac805.js"><link rel="prefetch" href="/CodeVault/assets/js/58.04f116f1.js"><link rel="prefetch" href="/CodeVault/assets/js/59.d660a6b3.js"><link rel="prefetch" href="/CodeVault/assets/js/6.7220274d.js"><link rel="prefetch" href="/CodeVault/assets/js/60.54783427.js"><link rel="prefetch" href="/CodeVault/assets/js/61.6e520517.js"><link rel="prefetch" href="/CodeVault/assets/js/62.78b5acff.js"><link rel="prefetch" href="/CodeVault/assets/js/63.0492d6b3.js"><link rel="prefetch" href="/CodeVault/assets/js/64.bd2a8518.js"><link rel="prefetch" href="/CodeVault/assets/js/65.8acc8c15.js"><link rel="prefetch" href="/CodeVault/assets/js/66.c2dc1d15.js"><link rel="prefetch" href="/CodeVault/assets/js/67.d584fc60.js"><link rel="prefetch" href="/CodeVault/assets/js/68.7221e725.js"><link rel="prefetch" href="/CodeVault/assets/js/69.f1a4c42c.js"><link rel="prefetch" href="/CodeVault/assets/js/7.ee190d28.js"><link rel="prefetch" href="/CodeVault/assets/js/70.8fb27ce3.js"><link rel="prefetch" href="/CodeVault/assets/js/71.2011297a.js"><link rel="prefetch" href="/CodeVault/assets/js/72.81904f20.js"><link rel="prefetch" href="/CodeVault/assets/js/73.cae4a206.js"><link rel="prefetch" href="/CodeVault/assets/js/74.41ca332e.js"><link rel="prefetch" href="/CodeVault/assets/js/75.ae7006ef.js"><link rel="prefetch" href="/CodeVault/assets/js/76.8477b765.js"><link rel="prefetch" href="/CodeVault/assets/js/77.ae764f14.js"><link rel="prefetch" href="/CodeVault/assets/js/78.b47518b4.js"><link rel="prefetch" href="/CodeVault/assets/js/79.bde0466f.js"><link rel="prefetch" href="/CodeVault/assets/js/8.e3ab8186.js"><link rel="prefetch" href="/CodeVault/assets/js/80.94af34f8.js"><link rel="prefetch" href="/CodeVault/assets/js/81.f1ba0edc.js"><link rel="prefetch" href="/CodeVault/assets/js/82.4485e21e.js"><link rel="prefetch" href="/CodeVault/assets/js/83.940dbcc3.js"><link rel="prefetch" href="/CodeVault/assets/js/84.6be8c64a.js"><link rel="prefetch" href="/CodeVault/assets/js/85.aa147bd8.js"><link rel="prefetch" href="/CodeVault/assets/js/86.0259d757.js"><link rel="prefetch" href="/CodeVault/assets/js/87.c88b420b.js"><link rel="prefetch" href="/CodeVault/assets/js/88.38f98c94.js"><link rel="prefetch" href="/CodeVault/assets/js/89.421840d7.js"><link rel="prefetch" href="/CodeVault/assets/js/9.cb249ed0.js"><link rel="prefetch" href="/CodeVault/assets/js/90.cd9b70c8.js"><link rel="prefetch" href="/CodeVault/assets/js/91.0c040f15.js"><link rel="prefetch" href="/CodeVault/assets/js/92.1ea436cf.js"><link rel="prefetch" href="/CodeVault/assets/js/93.7de38599.js"><link rel="prefetch" href="/CodeVault/assets/js/94.f2ad5a97.js"><link rel="prefetch" href="/CodeVault/assets/js/95.22f940d7.js"><link rel="prefetch" href="/CodeVault/assets/js/96.6a991248.js"><link rel="prefetch" href="/CodeVault/assets/js/97.aeccee85.js"><link rel="prefetch" href="/CodeVault/assets/js/98.79db6c16.js"><link rel="prefetch" href="/CodeVault/assets/js/99.aa13c9cb.js">
    <link rel="stylesheet" href="/CodeVault/assets/css/0.styles.bcdd6f38.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/CodeVault/" class="home-link router-link-active"><img src="/CodeVault/img/huli.svg" alt="CodeVault文档站" class="logo"> <span class="site-name can-hide">CodeVault文档站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/CodeVault/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="全栈开发" class="dropdown-title"><a href="/CodeVault/pages/d1eaf8/" class="link-title">全栈开发</a> <span class="title" style="display:none;">全栈开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>云计算运维</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/d1eaf8/" class="nav-link">云计算</a></li></ul></li><li class="dropdown-item"><h4>容器开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/e820a7/" class="nav-link">容器</a></li></ul></li><li class="dropdown-item"><h4>K8S虚拟化</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/da2470/" class="nav-link">容器虚拟化</a></li></ul></li><li class="dropdown-item"><h4>运维高级篇</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/ce761d/" class="nav-link">高可用</a></li></ul></li><li class="dropdown-item"><h4>前端开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/" class="nav-link">前端常用</a></li></ul></li><li class="dropdown-item"><h4>后端开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/" class="nav-link">后端常用</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="资源" class="dropdown-title"><a href="/CodeVault/pages/e4db9d/" class="link-title">资源</a> <span class="title" style="display:none;">资源</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/CodeVault/pages/e4db9d/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/c936ca/" class="nav-link">学习文档资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习路线" class="dropdown-title"><a href="/CodeVault/pages/f24c41/" class="link-title">学习路线</a> <span class="title" style="display:none;">学习路线</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>后端开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/f24c41/" class="nav-link">后端学习路线</a></li></ul></li><li class="dropdown-item"><h4>Web3</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/1583d1/" class="nav-link">区块链学习路线</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/CodeVault/pages/6ffa63/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>HTML5+CSS3</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/6ffa63/" class="nav-link">HTML5</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/b23e0c/" class="nav-link">CSS3</a></li></ul></li><li class="dropdown-item"><h4>JavaScript</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/0e8324/" class="nav-link">JavaScript开篇</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/4d9ec9/" class="nav-link">JavaScript面向对象</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/0505ad/" class="nav-link">JavaScript DOM</a></li></ul></li><li class="dropdown-item"><h4>API</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/845076/" class="nav-link">JQuery</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/9c8e93/" class="nav-link">Ajax</a></li><li class="dropdown-subitem"><a href="/CodeVault/" class="nav-link">Axios</a></li></ul></li><li class="dropdown-item"><h4>Vue</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/a1209f/" class="nav-link">Vuejs</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/CodeVault/pages/5e1c7d/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/5e1c7d/" class="nav-link">Java进阶</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/9b262c/" class="nav-link">Spring</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/3e651a/" class="nav-link">SpringBoot</a></li></ul></li><li class="dropdown-item"><h4>Golang</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/135518/" class="nav-link">Beego</a></li><li class="dropdown-subitem"><a href="/CodeVault/" class="nav-link">Gin</a></li><li class="dropdown-subitem"><a href="/CodeVault/" class="nav-link">Gorm</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><a href="/CodeVault/pages/7ef2c7/" class="link-title">中间件</a> <span class="title" style="display:none;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/CodeVault/pages/7ef2c7/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/516f71/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/1eaa9a/" class="nav-link">Nginx</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/1ac9b2/" class="nav-link">Ceph</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/719244/" class="nav-link">Elasticsearch</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/6ec6ec/" class="nav-link">Istio</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/30e340/" class="nav-link">Prometheus</a></li></ul></div></div><div class="nav-item"><a href="/CodeVault/pages/32fd53/" class="nav-link">Docker</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="K8S" class="dropdown-title"><a href="/CodeVault/pages/46159d/" class="link-title">K8S</a> <span class="title" style="display:none;">K8S</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>云原生</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/46159d/" class="nav-link">Kubernetes</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/f87a46/" class="nav-link">CKS认证</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/2d432e/" class="nav-link">Operator</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/CodeVault/pages/f6f110/" class="nav-link">CI/CD</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Linux" class="dropdown-title"><a href="/CodeVault/pages/f9fa7a/" class="link-title">Linux</a> <span class="title" style="display:none;">Linux</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Linux</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/f9fa7a/" class="nav-link">基础服务</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/314d26/" class="nav-link">Kvm</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/44e450/" class="nav-link">Ansible</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/8292d8/" class="nav-link">Git</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="区块链" class="dropdown-title"><a href="/CodeVault/pages/f3ea9f/" class="link-title">区块链</a> <span class="title" style="display:none;">区块链</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>FISCO BCOS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/f3ea9f/" class="nav-link">WeBASE搭建</a></li></ul></li><li class="dropdown-item"><h4>2023年TASK挑战赛上</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/685f1f/" class="nav-link">碳排放解决方案</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/3f1596/" aria-current="page" class="nav-link router-link-exact-active router-link-active">慈善公益解决方案</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/cc43be/" class="nav-link">构造交易传入AppID</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/75ddc8/" class="nav-link">合约时间触发器</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/9bcc7c/" class="nav-link">一键部署环境脚本</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/a93fcf/" class="nav-link">合约调用机制与并行合约</a></li></ul></li><li class="dropdown-item"><h4>2023年TASK挑战赛下</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/1fdb40/" class="nav-link">DDCMS后端容器化</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/795b78/" class="nav-link">DDCMS第三方登录</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/a99040/" class="nav-link">DDCMS智能合约设计</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/cb310d/" class="nav-link">DDCMS部署和运维</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/0b1c5a/" class="nav-link">DDCMS接口报错</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/99df38/" class="nav-link">合约大小限制优化</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/f8a343/" class="nav-link">并行合约最佳实践</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/3d3086/" class="nav-link">一文搞懂Truffle测试</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/CodeVault/pages/e3d908/" class="nav-link">记录</a></div> <a href="https://github.com/CN-ZHANGYH/CodeVault" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/CodeVault/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="全栈开发" class="dropdown-title"><a href="/CodeVault/pages/d1eaf8/" class="link-title">全栈开发</a> <span class="title" style="display:none;">全栈开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>云计算运维</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/d1eaf8/" class="nav-link">云计算</a></li></ul></li><li class="dropdown-item"><h4>容器开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/e820a7/" class="nav-link">容器</a></li></ul></li><li class="dropdown-item"><h4>K8S虚拟化</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/da2470/" class="nav-link">容器虚拟化</a></li></ul></li><li class="dropdown-item"><h4>运维高级篇</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/ce761d/" class="nav-link">高可用</a></li></ul></li><li class="dropdown-item"><h4>前端开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/" class="nav-link">前端常用</a></li></ul></li><li class="dropdown-item"><h4>后端开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/" class="nav-link">后端常用</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="资源" class="dropdown-title"><a href="/CodeVault/pages/e4db9d/" class="link-title">资源</a> <span class="title" style="display:none;">资源</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/CodeVault/pages/e4db9d/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/c936ca/" class="nav-link">学习文档资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习路线" class="dropdown-title"><a href="/CodeVault/pages/f24c41/" class="link-title">学习路线</a> <span class="title" style="display:none;">学习路线</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>后端开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/f24c41/" class="nav-link">后端学习路线</a></li></ul></li><li class="dropdown-item"><h4>Web3</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/1583d1/" class="nav-link">区块链学习路线</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/CodeVault/pages/6ffa63/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>HTML5+CSS3</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/6ffa63/" class="nav-link">HTML5</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/b23e0c/" class="nav-link">CSS3</a></li></ul></li><li class="dropdown-item"><h4>JavaScript</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/0e8324/" class="nav-link">JavaScript开篇</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/4d9ec9/" class="nav-link">JavaScript面向对象</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/0505ad/" class="nav-link">JavaScript DOM</a></li></ul></li><li class="dropdown-item"><h4>API</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/845076/" class="nav-link">JQuery</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/9c8e93/" class="nav-link">Ajax</a></li><li class="dropdown-subitem"><a href="/CodeVault/" class="nav-link">Axios</a></li></ul></li><li class="dropdown-item"><h4>Vue</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/a1209f/" class="nav-link">Vuejs</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/CodeVault/pages/5e1c7d/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/5e1c7d/" class="nav-link">Java进阶</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/9b262c/" class="nav-link">Spring</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/3e651a/" class="nav-link">SpringBoot</a></li></ul></li><li class="dropdown-item"><h4>Golang</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/135518/" class="nav-link">Beego</a></li><li class="dropdown-subitem"><a href="/CodeVault/" class="nav-link">Gin</a></li><li class="dropdown-subitem"><a href="/CodeVault/" class="nav-link">Gorm</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><a href="/CodeVault/pages/7ef2c7/" class="link-title">中间件</a> <span class="title" style="display:none;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/CodeVault/pages/7ef2c7/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/516f71/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/1eaa9a/" class="nav-link">Nginx</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/1ac9b2/" class="nav-link">Ceph</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/719244/" class="nav-link">Elasticsearch</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/6ec6ec/" class="nav-link">Istio</a></li><li class="dropdown-item"><!----> <a href="/CodeVault/pages/30e340/" class="nav-link">Prometheus</a></li></ul></div></div><div class="nav-item"><a href="/CodeVault/pages/32fd53/" class="nav-link">Docker</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="K8S" class="dropdown-title"><a href="/CodeVault/pages/46159d/" class="link-title">K8S</a> <span class="title" style="display:none;">K8S</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>云原生</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/46159d/" class="nav-link">Kubernetes</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/f87a46/" class="nav-link">CKS认证</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/2d432e/" class="nav-link">Operator</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/CodeVault/pages/f6f110/" class="nav-link">CI/CD</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Linux" class="dropdown-title"><a href="/CodeVault/pages/f9fa7a/" class="link-title">Linux</a> <span class="title" style="display:none;">Linux</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Linux</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/f9fa7a/" class="nav-link">基础服务</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/314d26/" class="nav-link">Kvm</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/44e450/" class="nav-link">Ansible</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/8292d8/" class="nav-link">Git</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="区块链" class="dropdown-title"><a href="/CodeVault/pages/f3ea9f/" class="link-title">区块链</a> <span class="title" style="display:none;">区块链</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>FISCO BCOS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/f3ea9f/" class="nav-link">WeBASE搭建</a></li></ul></li><li class="dropdown-item"><h4>2023年TASK挑战赛上</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/685f1f/" class="nav-link">碳排放解决方案</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/3f1596/" aria-current="page" class="nav-link router-link-exact-active router-link-active">慈善公益解决方案</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/cc43be/" class="nav-link">构造交易传入AppID</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/75ddc8/" class="nav-link">合约时间触发器</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/9bcc7c/" class="nav-link">一键部署环境脚本</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/a93fcf/" class="nav-link">合约调用机制与并行合约</a></li></ul></li><li class="dropdown-item"><h4>2023年TASK挑战赛下</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/CodeVault/pages/1fdb40/" class="nav-link">DDCMS后端容器化</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/795b78/" class="nav-link">DDCMS第三方登录</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/a99040/" class="nav-link">DDCMS智能合约设计</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/cb310d/" class="nav-link">DDCMS部署和运维</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/0b1c5a/" class="nav-link">DDCMS接口报错</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/99df38/" class="nav-link">合约大小限制优化</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/f8a343/" class="nav-link">并行合约最佳实践</a></li><li class="dropdown-subitem"><a href="/CodeVault/pages/3d3086/" class="nav-link">一文搞懂Truffle测试</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/CodeVault/pages/e3d908/" class="nav-link">记录</a></div> <a href="https://github.com/CN-ZHANGYH/CodeVault" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>FISCO BCOS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/CodeVault/pages/f3ea9f/" class="sidebar-link">搭建Fisco的联盟链(WeBase版)</a></li><li><a href="/CodeVault/pages/484318/" class="sidebar-link">FISCO BCOS Air搭建</a></li><li><a href="/CodeVault/pages/58f15c/" class="sidebar-link">FISCO BCOS Pro搭建</a></li><li><a href="/CodeVault/pages/cca1e9/" class="sidebar-link">FISCO BCOS Max搭建</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>2023 Task挑战赛上</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/CodeVault/pages/685f1f/" class="sidebar-link">企业碳排放解决方案合约案例</a></li><li><a href="/CodeVault/pages/3f1596/" aria-current="page" class="active sidebar-link">慈善公益解决方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/CodeVault/pages/3f1596/#_1-当前公益慈善组织面临突出问题" class="sidebar-link">1.当前公益慈善组织面临突出问题</a></li><li class="sidebar-sub-header level2"><a href="/CodeVault/pages/3f1596/#_2-基于fisco-bcos的解决方案" class="sidebar-link">2.基于FISCO BCOS的解决方案</a></li><li class="sidebar-sub-header level2"><a href="/CodeVault/pages/3f1596/#_3-慈善公益架构图" class="sidebar-link">3.慈善公益架构图</a></li><li class="sidebar-sub-header level2"><a href="/CodeVault/pages/3f1596/#_4-整体业务概述" class="sidebar-link">4.整体业务概述</a></li><li class="sidebar-sub-header level2"><a href="/CodeVault/pages/3f1596/#_5-用户业务视图" class="sidebar-link">5.用户业务视图</a></li><li class="sidebar-sub-header level2"><a href="/CodeVault/pages/3f1596/#_6-存储设计" class="sidebar-link">6.存储设计</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_6-1-用户存储设计" class="sidebar-link">6.1 用户存储设计</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_6-2-机构存储设计" class="sidebar-link">6.2 机构存储设计</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_6-3-物流商的存储设计" class="sidebar-link">6.3 物流商的存储设计</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/CodeVault/pages/3f1596/#_7-接口设计" class="sidebar-link">7.接口设计</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_7-1-用户接口" class="sidebar-link">7.1 用户接口</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_7-2-机构接口" class="sidebar-link">7.2 机构接口</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_7-3-物流商接口" class="sidebar-link">7.3 物流商接口</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/CodeVault/pages/3f1596/#_8-合约详细" class="sidebar-link">8.合约详细</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_8-1-用户注册业务" class="sidebar-link">8.1 用户注册业务</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_8-2-用户申请物资业务" class="sidebar-link">8.2 用户申请物资业务</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_8-3-用户捐赠物资业务" class="sidebar-link">8.3 用户捐赠物资业务</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_8-4-物流运输业务" class="sidebar-link">8.4 物流运输业务</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_8-5-用户签收物资业务" class="sidebar-link">8.5 用户签收物资业务</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_8-6-用户发起公益捐款业务" class="sidebar-link">8.6 用户发起公益捐款业务</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_8-6-用户公益捐款业务" class="sidebar-link">8.6 用户公益捐款业务</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_8-7-用户取款业务" class="sidebar-link">8.7 用户取款业务</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_8-8-用户更新所有公益状态业务" class="sidebar-link">8.8  用户更新所有公益状态业务</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_8-9-用户分页查询捐赠记录业务" class="sidebar-link">8.9 用户分页查询捐赠记录业务</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/CodeVault/pages/3f1596/#_9-合约业务测试" class="sidebar-link">9.合约业务测试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_9-1-测试用户" class="sidebar-link">9.1 测试用户</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_9-2-公益捐款活动业务" class="sidebar-link">9.2 公益捐款活动业务</a></li><li class="sidebar-sub-header level3"><a href="/CodeVault/pages/3f1596/#_9-3-公益物资捐赠业务" class="sidebar-link">9.3 公益物资捐赠业务</a></li></ul></li></ul></li><li><a href="/CodeVault/pages/cc43be/" class="sidebar-link">RawTransaction优化</a></li><li><a href="/CodeVault/pages/75ddc8/" class="sidebar-link">Solidity合约时间触发器</a></li><li><a href="/CodeVault/pages/9bcc7c/" class="sidebar-link">一键部署环境脚本</a></li><li><a href="/CodeVault/pages/a93fcf/" class="sidebar-link">合约调用机制与并行合约</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2023 Task挑战赛下</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/CodeVault/pages/1fdb40/" class="sidebar-link">DDCMS 后端容器化解决方案</a></li><li><a href="/CodeVault/pages/795b78/" class="sidebar-link">DDCMS实现第三方Github登录</a></li><li><a href="/CodeVault/pages/a99040/" class="sidebar-link">DDCMS智能合约设计与实现</a></li><li><a href="/CodeVault/pages/cb310d/" class="sidebar-link">部署DDCMS分布式数据管理</a></li><li><a href="/CodeVault/pages/0b1c5a/" class="sidebar-link">DDCMS-Service后端searchCompany接口解决报错</a></li><li><a href="/CodeVault/pages/99df38/" class="sidebar-link">Solidity智能合约大小限制优化方案</a></li><li><a href="/CodeVault/pages/f8a343/" class="sidebar-link">并行合约设计与实践</a></li><li><a href="/CodeVault/pages/3d3086/" class="sidebar-link">一文搞懂Truffle测试</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/CodeVault/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>区块链</span></li><li data-v-06225672><span data-v-06225672>2023 Task挑战赛上</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/CN-ZHANGYH" target="_blank" title="作者" class="beLink" data-v-06225672>Yyzop</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-07-15</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">慈善公益解决方案<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="慈善公益-智能合约解决方案"><a href="#慈善公益-智能合约解决方案" class="header-anchor">#</a> 慈善公益——智能合约解决方案</h1> <p><strong>基于区块链的慈善公益适用于需要保证捐款信息安全性和透明度的场景</strong>，因为区块链技术具备去中心化、不可篡改、安全可靠等特点，可以确保慈善捐款信息不被篡改。同时，使用基于区块链的慈善公益系统还可以提高捐款过程中的效率和透明度，保障捐款人权益，增强慈善机构的信誉和管理能力。因此，基于区块链的慈善公益适用于各种需要捐款和资金流转的公益场景。</p> <h2 id="_1-当前公益慈善组织面临突出问题"><a href="#_1-当前公益慈善组织面临突出问题" class="header-anchor">#</a> 1.当前公益慈善组织面临突出问题</h2> <p>我进行了查阅以及调查，总结了如下几点,从知乎上查阅到：https://zhuanlan.zhihu.com/p/150063012</p> <p><strong>信息公开程度低，监管缺乏手段</strong>传统公益慈善组织的信息公开透明度低，监管机制缺位，公信力不足。据调查，公益组织的“资金去向与使用状况”以及“善款来源”是公众关注的焦点，而传统公益机构经常信息披露不足。从本次疫情爆发的红十字会事件来看，由于物资来源不透明、去向不可知、信息公开不及时，以及政府对慈善组织的监管手段缺乏、社会监督力量薄弱，导致红十字会公信力下降，影响了公众对公益组织的信心与支持度。</p> <p><strong>“互联网+公益”无法解决信用问题</strong>“互联网+公益”创新模式已经被用到实践中，但是同样面临信用风险和监管问题。随着互联网技术的发展，网络公益众筹平台如轻松筹、水滴筹、爱心筹等快速发展，一方面有效帮助了数以万计的困难群众，缓解了政府的财政压力；另一方面也暴露出一些问题，互联网的开放性特征，使得众筹平台难以对发起者与受益者的信息进行有效筛查，个别求助者虚构病情、部分平台线上业务流程不合规、用户数据被滥用、个别平台涉嫌非法筹集资金等问题频现。这不仅对捐助者的基本权益造成了侵害，同时也削弱了群众对于网络公益众筹活动的信任，制约了公益事业的可持续发展。</p> <p>因此，急需一种合适的技术手段或合理的机制来解决社会民众持续增长的公益慈善需求与当前公益慈善组织公信力不足之间的矛盾。</p> <p><strong>区块链可以实现有效的激励，具有价值优势</strong>公益项目的参与方是不同利益主体，需要尽可能照顾各方利益，才能激发更多参与者的积极性。如在本次疫情中，存在很多社会志愿者和慈善人士。由于公益项目的非营利性，吸引各方积极参与的不再是经济利益的分配，参与方的出发点可能是同情心、家乡情、社会声誉、个人英雄主义、企业文化、社会研究等。面对参与者的不同出发点，区块链的激励相容机制可以实现多方利益的共赢，实现社会价值最大化。</p> <p>整个捐赠流程：</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304130124514.webp" alt="image-20230413012411609"></p> <p>基于区块链的慈善公益主要包括以下业务：</p> <ol><li><strong>捐款管理</strong>：基于区块链技术，建立一个去中心化的捐款管理系统，确保捐款信息不被篡改、数据的可靠性和安全性。捐款人可以通过区块链平台进行捐款记录的查询，以保证公示的透明度和真实性。</li> <li><strong>资金用途追踪</strong>：通过区块链技术实现对慈善捐赠资金的流向追踪和监管，确保资金的合法使用。比如，将慈善机构的账户信息与区块链相结合，建立一个跨机构的资金追踪平台，对慈善基金的使用情况进行实时监控。</li> <li><strong>慈善项目管理</strong>：为慈善活动和项目建立智能合约，实现自动化执行和程序化管理，避免了人为操作引起的错误和不公平。同时，也可以通过区块链平台发布慈善项目，方便社会各界了解并参与慈善事业。</li> <li><strong>公示与评估</strong>：在区块链平台上公示捐款信息和慈善项目进展情况，方便公众对慈善机构的评估和监督。同时可以建立一个可追溯的财务系统，使得慈善机构的账目记录和审核更加标准化和规范化。</li></ol> <h2 id="_2-基于fisco-bcos的解决方案"><a href="#_2-基于fisco-bcos的解决方案" class="header-anchor">#</a> 2.基于FISCO BCOS的解决方案</h2> <p>基于FISCO BCOS的区块链平台，在慈善公益方面可以提供以下几个解决方案：</p> <ol><li><p>透明化捐赠流程：区块链技术可以记录每一笔捐款的流向，确保捐赠资金的安全性和完整性。公众也可以通过区块链浏览器直接查看捐款进出账户，进而监督公益项目的实施过程。</p></li> <li><p>全民义卖：将二手物品等闲置资源进行在线交易，并将所得资金全部或部分捐给公益事业。区块链可以为义卖品拍卖价提供保证，避免出现恶意抬高价格、虚假交易情况等。</p></li> <li><p>慈善信用评级：在捐助时，采集捐赠者的身份信息以及他们的捐献历史，并基于此进行信用评级。这种数据存储在区块链上，使其不受一方或中心化机构的控制，并且捐赠者的信誉不会被恶意攻击或篡改。</p></li> <li><p>慈善数据管理：由于区块链在去中心化、所有人都能共享数据等方面的显著优势，因此还可应用于慈善数据管理。对于慈善机构来说，可以用区块链存储敏感数据，添加数据完整形式验证，在保护数据隐私基础之上，确保数据的安全和可靠性；对于公众、政府部门等用户，则可以通过去中心化的方式获取最新信息，以实现公开透明。</p></li></ol> <h2 id="_3-慈善公益架构图"><a href="#_3-慈善公益架构图" class="header-anchor">#</a> 3.慈善公益架构图</h2> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304300416961.webp" alt="image-20230430041647708"></p> <h2 id="_4-整体业务概述"><a href="#_4-整体业务概述" class="header-anchor">#</a> 4.整体业务概述</h2> <ol><li><p>角色与职责：本系统分为三个角色，机构、物流商、用户。</p> <ul><li><p><code>机构</code>：发起慈善公益活动，指定需求、目标等信息，发布活动。</p></li> <li><p><code>物流商</code>：提供物流服务，支持用户与机构间的货物运输及产品、捐款等相关服务。</p></li> <li><p><code>用户</code>：参与慈善公益活动，可按批次捐赠、参与义务劳动等方式实现公益目标。通过贡献值、捐赠额度、访问记录、评价等数据进行等级评定。</p></li></ul></li> <li><p>用户权限和限制：系统将给每个用户分配一个初始积分，花费时从积分中扣减，根据月捐赠额、贡献值等因素计算加权等级和能力。新注册的用户需要填写完整资料，并经过身份验证，才能下单或发起项目。不同等级具有不同的权利和限制，如优先抢购特价产品、免邮、免费获得代金券、优先享受售后服务等。</p></li> <li><p>捐款功能：用户可以进行慈善公益捐赠，选择慈善项目并选择捐款金额、支付方式。另可查看自己的个人公益捐赠记录，并了解其去向。</p></li> <li><p>公益活动：覆盖社区慈善、环保公益、健康公益等多个领域，用户可以根据个人性格和慈善心情选择感兴趣的公益活动。支持筛选和分类浏览公益项目、查看详细资料和成果等。</p></li> <li><p>物流服务：为用户提供快递、签收、运输等多种物流服务，确保产品及时到达目的地。采用安全可靠、高效快捷的物流方式，追踪管理订单并公开物流状态信息。</p></li> <li><p>链上记录与溯源：系统将所有关键业务数据上链存储，并通过智能合约鉴定、加密、完整性验证等技术手段，确保数据不可篡改、审计可追溯。利用区块链技术打造完整的溯源体系，对公益捐赠进展进行实时核查，确保严谨的过程管理，最大限度地保证公益捐助的目标化和有效性。同时，系统会对公开信息进行隐私保护，实现公益信息公开但个人信息保护的目的。</p></li></ol> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304281533618.webp" alt="image-20230428153313443"></p> <h2 id="_5-用户业务视图"><a href="#_5-用户业务视图" class="header-anchor">#</a> 5.用户业务视图</h2> <ol><li>代理机构：本系统支持用户与多个代理机构合作，通过代理机构实现慈善捐赠管理等主要业务操作。</li> <li>捐款功能：用户可以在代理机构处对慈善项目进行捐款管理，并发起公益账目回收。所有公益捐赠记录将被实时记录并上链存储，确保数据可追溯、透明公开且不可篡改。</li> <li>物资物流服务：针对灾区物资的捐赠，代理机构会根据实际情况选择物流商进行派送至灾区。 用户可以根据查看捐赠人的记录信息，可以查看完整公益记录溯源，保证了数据的公开性，真实可信。</li> <li>数据防伪与维护：为避免经销分润、滥竽充数等非法行为的发生，系统采用了区块链技术进行数据防伪和维护。同时引入智能合约等先进工具，确保公益项目的可信度和高效执行。</li></ol> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304291710619.webp" alt="ee966a9c35bf7c4c2dd6077aae26a6d"></p> <h2 id="_6-存储设计"><a href="#_6-存储设计" class="header-anchor">#</a> 6.存储设计</h2> <h3 id="_6-1-用户存储设计"><a href="#_6-1-用户存储设计" class="header-anchor">#</a> 6.1 用户存储设计</h3> <p>如下是一个基于区块链技术的公益慈善应用中所使用的数据结构，具体包括：<strong>用户结构体、捐赠人结构体、申请公益物资结构体以及公益记录溯源结构体</strong> 。</p> <ul><li>用户结构体包含用户的基本信息和操作记录，如用户ID、名称、地址、余额、等级、捐赠次数和历史记录；</li> <li>捐赠人结构体用于存储捐款的相关信息，包括捐赠ID、金额、捐赠人和接收方的地址以及时间；</li> <li>申请公益物资结构体则用于公益物资的禀议与申请，包括申请ID、描述、机构地址和所需物资清单等内容；</li> <li>而公益记录溯源结构体则是用于记录公益项目、经费和结果的，包括公益历史ID、发起人、金额、去向、机构地址、状态、时间等。通过该结构体可以对该项目的所有捐赠人进行查询，并确保公益记录的真实性和透明度。</li></ul> <div class="language-solidity extra-class"><pre class="language-solidity"><code>    <span class="token comment">// 用户的结构体</span>
    <span class="token keyword">struct</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
        <span class="token builtin">uint256</span> userId<span class="token punctuation">;</span>          <span class="token comment">// 用户ID</span>
        <span class="token builtin">string</span>  userName<span class="token punctuation">;</span>        <span class="token comment">// 用户名称</span>
        <span class="token builtin">address</span> userAddress<span class="token punctuation">;</span>     <span class="token comment">// 用户地址</span>
        <span class="token builtin">uint256</span> userAmount<span class="token punctuation">;</span>      <span class="token comment">// 用户的余额</span>
        Level userLevel<span class="token punctuation">;</span>         <span class="token comment">// 用户的等级</span>
        <span class="token builtin">uint256</span> userCount<span class="token punctuation">;</span>       <span class="token comment">// 用户的捐献次数</span>
        <span class="token builtin">int</span>     status<span class="token punctuation">;</span>          <span class="token comment">// 用户的状态</span>
        <span class="token builtin">uint256</span><span class="token punctuation">[</span><span class="token punctuation">]</span> donorList<span class="token punctuation">;</span>     <span class="token comment">// 捐赠的历史记录ID</span>
        <span class="token builtin">uint256</span><span class="token punctuation">[</span><span class="token punctuation">]</span> materialList<span class="token punctuation">;</span>  <span class="token comment">// 捐赠物资交易记录ID</span>
        <span class="token builtin">uint256</span><span class="token punctuation">[</span><span class="token punctuation">]</span> recordList<span class="token punctuation">;</span>    <span class="token comment">// 集资历史记录ID</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 捐赠人结构体</span>
    <span class="token keyword">struct</span> <span class="token class-name">Donor</span> <span class="token punctuation">{</span>
        <span class="token builtin">uint256</span> donorId<span class="token punctuation">;</span>         <span class="token comment">// 捐赠ID</span>
        <span class="token builtin">uint256</span> donorAmount<span class="token punctuation">;</span>     <span class="token comment">// 捐赠的金额</span>
        <span class="token builtin">address</span> donorAddress<span class="token punctuation">;</span>    <span class="token comment">// 捐赠人地址</span>
        <span class="token builtin">address</span> donorToAddress<span class="token punctuation">;</span>  <span class="token comment">// 捐赠的对方地址</span>
        <span class="token builtin">address</span> donorToOrg<span class="token punctuation">;</span>      <span class="token comment">// 捐赠的机构</span>
        <span class="token builtin">uint256</span> donorTime<span class="token punctuation">;</span>       <span class="token comment">// 捐赠的时间</span>
    <span class="token punctuation">}</span>   
    
    <span class="token comment">// 申请公益物资结构体</span>
    <span class="token keyword">struct</span> <span class="token class-name">Material</span><span class="token punctuation">{</span>
        <span class="token builtin">uint256</span> meteriaId<span class="token punctuation">;</span>          <span class="token comment">// 申请物资ID</span>
        <span class="token builtin">string</span>  meterialdesc<span class="token punctuation">;</span>       <span class="token comment">// 申请物资描述</span>
        <span class="token builtin">address</span> srcAddress<span class="token punctuation">;</span>         <span class="token comment">// 申请地址</span>
        <span class="token builtin">address</span> orgAddress<span class="token punctuation">;</span>         <span class="token comment">// 代理机构地址</span>
        <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> meterialNames<span class="token punctuation">;</span>     <span class="token comment">// 所有物资</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 公益溯源结构体 </span>
    <span class="token keyword">struct</span> <span class="token class-name">CharityRecord</span> <span class="token punctuation">{</span>
        <span class="token builtin">uint256</span>       recordId<span class="token punctuation">;</span>        <span class="token comment">// 公益历史ID</span>
        <span class="token builtin">uint256</span>       recordAmount<span class="token punctuation">;</span>    <span class="token comment">// 公益金额</span>
        <span class="token builtin">uint256</span>       overAmount<span class="token punctuation">;</span>      <span class="token comment">// 已完成金额</span>
        <span class="token builtin">address</span>       srcUser<span class="token punctuation">;</span>         <span class="token comment">// 公益发起人</span>
        <span class="token builtin">string</span>        descCharitable<span class="token punctuation">;</span>  <span class="token comment">// 公益去向</span>
        <span class="token builtin">address</span>       recordOrg<span class="token punctuation">;</span>       <span class="token comment">// 公益机构</span>
        CharityStatus recordStatus<span class="token punctuation">;</span>    <span class="token comment">// 公益状态</span>
        <span class="token builtin">uint256</span>       recordTime<span class="token punctuation">;</span>      <span class="token comment">// 公益时间</span>
        <span class="token builtin">address</span><span class="token punctuation">[</span><span class="token punctuation">]</span>     users<span class="token punctuation">;</span>           <span class="token comment">// 所有捐赠人地址</span>
    <span class="token punctuation">}</span>
    
        
    <span class="token comment">// 用户的ID</span>
    <span class="token builtin">uint256</span> userCount<span class="token punctuation">;</span>
    
    <span class="token comment">// 捐赠记录ID</span>
    <span class="token builtin">uint256</span> donorCount<span class="token punctuation">;</span>

    <span class="token comment">// 所有用户的地址记录</span>
    <span class="token builtin">address</span><span class="token punctuation">[</span><span class="token punctuation">]</span> users<span class="token punctuation">;</span>
    
    <span class="token comment">// 所有捐赠人的记录ID</span>
    <span class="token builtin">uint256</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dornors<span class="token punctuation">;</span>
    
    
    <span class="token comment">// 地址映射用户详细信息</span>
    <span class="token keyword">mapping</span><span class="token punctuation">(</span><span class="token builtin">address</span> <span class="token operator">=&gt;</span> User<span class="token punctuation">)</span> userMap<span class="token punctuation">;</span>
    <span class="token comment">// ID映射捐赠人的详细信息</span>
    <span class="token keyword">mapping</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> <span class="token operator">=&gt;</span> Donor<span class="token punctuation">)</span> donorMap<span class="token punctuation">;</span>

    
    <span class="token comment">// 用户的等级枚举 注册默认为等级一 一级可发起公益最高5W 二级10W 三级 20W</span>
    <span class="token keyword">enum</span> <span class="token class-name">Level</span> <span class="token punctuation">{</span>LEVEL_ONE<span class="token punctuation">,</span>LEVEL_TWO<span class="token punctuation">,</span>LEVEL_THREE<span class="token punctuation">}</span>
    
</code></pre></div><h3 id="_6-2-机构存储设计"><a href="#_6-2-机构存储设计" class="header-anchor">#</a> 6.2 机构存储设计</h3> <p>如下是公益慈善应用中所使用的机构结构体，该结构体包含的主要信息如下：</p> <ol><li>机构ID和名称：代表了该机构在系统中的唯一标识符及其名称；</li> <li>机构地址：指机构所在的钱包账户地址；</li> <li>机构账户余额：记录了该机构的账户余额；</li> <li>机构状态：表示机构的状态；</li> <li>所有公益溯源集合：用于存储该机构发起的所有公益项目的信息，包括公益项目ID、捐赠人地址、公益金额、机构地址、状态等信息，以方便进行公益项目的跟踪来追溯公益资金的去向；</li> <li>所有公益捐赠交易ID集合：用于存储和管理与该机构相关的所有公益捐赠交易的ID，包括捐赠金额、捐赠人地址、接收者地址等信息；</li> <li>所有物资申请记录ID集合：用于存储和管理该机构发起的所有公益物资申请交易的ID，包括申请ID、描述、机构地址和所需物资清单等内容。</li></ol> <div class="language-solidity extra-class"><pre class="language-solidity"><code>     <span class="token comment">// 慈善机构的结构体</span>
    <span class="token keyword">struct</span> <span class="token class-name">Org</span> <span class="token punctuation">{</span>
        <span class="token builtin">uint256</span>  orgId<span class="token punctuation">;</span>          <span class="token comment">// 机构ID</span>
        <span class="token builtin">string</span>   orgName<span class="token punctuation">;</span>        <span class="token comment">// 机构名称</span>
        <span class="token builtin">address</span>  orgAddress<span class="token punctuation">;</span>     <span class="token comment">// 机构的地址</span>
        <span class="token builtin">uint256</span>  orgAmount<span class="token punctuation">;</span>      <span class="token comment">// 机构的账户</span>
        <span class="token builtin">int</span>      status<span class="token punctuation">;</span>         <span class="token comment">// 机构的状态</span>
        <span class="token builtin">uint256</span><span class="token punctuation">[</span><span class="token punctuation">]</span> recordIds<span class="token punctuation">;</span>     <span class="token comment">// 机构的所有公益溯源集合</span>
        <span class="token builtin">uint256</span><span class="token punctuation">[</span><span class="token punctuation">]</span> transactions<span class="token punctuation">;</span>  <span class="token comment">// 机构的所有公益捐赠交易ID集合</span>
        <span class="token builtin">uint256</span><span class="token punctuation">[</span><span class="token punctuation">]</span> meterials<span class="token punctuation">;</span>     <span class="token comment">// 机构的所有的物资申请记录ID</span>
    <span class="token punctuation">}</span>
    
        
    <span class="token comment">// 慈善机构ID</span>
    <span class="token builtin">uint256</span> orgId<span class="token punctuation">;</span>     
    
    <span class="token comment">// 所有机构的地址</span>
    <span class="token builtin">address</span><span class="token punctuation">[</span><span class="token punctuation">]</span> orgs<span class="token punctuation">;</span>

    <span class="token comment">// 地址映射慈善机构</span>
    <span class="token keyword">mapping</span><span class="token punctuation">(</span><span class="token builtin">address</span> <span class="token operator">=&gt;</span> Org<span class="token punctuation">)</span> <span class="token keyword">public</span> orgMap<span class="token punctuation">;</span>  
</code></pre></div><h3 id="_6-3-物流商的存储设计"><a href="#_6-3-物流商的存储设计" class="header-anchor">#</a> 6.3 物流商的存储设计</h3> <p>该结构体包含了物流公司的一些基本信息，具体如下：</p> <ol><li>物流公司ID：标识该物流公司；</li> <li>物流公司名称：表示该物流公司在系统中的名称；</li> <li>物流公司地址：指该物流公司所在的钱包账户地址，该地址可以用来进行公益物资的收发和流转等操作；</li> <li>物流公司状态：表示物流公司的状态；</li></ol> <div class="language-solidity extra-class"><pre class="language-solidity"><code>    <span class="token comment">// 物流公司的结构体</span>
    <span class="token keyword">struct</span> <span class="token class-name">Logistics</span> <span class="token punctuation">{</span>
        <span class="token builtin">uint256</span> logisticsId<span class="token punctuation">;</span>        <span class="token comment">// 物流公司ID</span>
        <span class="token builtin">string</span>  logisticsName<span class="token punctuation">;</span>      <span class="token comment">// 物流公司名称 </span>
        <span class="token builtin">address</span> logisticsAddress<span class="token punctuation">;</span>   <span class="token comment">// 物流公司的地址</span>
        <span class="token builtin">int</span>     status<span class="token punctuation">;</span>             <span class="token comment">// 物流公司的状态</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 物流公司的ID</span>
    <span class="token builtin">uint256</span> logisticsCount<span class="token punctuation">;</span>
    <span class="token comment">// 所有物流公司的地址</span>
    <span class="token builtin">address</span><span class="token punctuation">[</span><span class="token punctuation">]</span> logisticsAddress<span class="token punctuation">;</span>
    <span class="token comment">// 地址映射物流公司的详细信息</span>
    <span class="token keyword">mapping</span><span class="token punctuation">(</span><span class="token builtin">address</span> <span class="token operator">=&gt;</span> Logistics<span class="token punctuation">)</span> logisticsMap<span class="token punctuation">;</span>
</code></pre></div><h2 id="_7-接口设计"><a href="#_7-接口设计" class="header-anchor">#</a> 7.接口设计</h2> <h3 id="_7-1-用户接口"><a href="#_7-1-用户接口" class="header-anchor">#</a> 7.1 用户接口</h3> <p>如下是用户的主要接口：</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code>	<span class="token comment">// 注册用户</span>
    <span class="token keyword">function</span> <span class="token function">registerUser</span><span class="token punctuation">(</span><span class="token builtin">string</span> <span class="token keyword">memory</span> _userName<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">returns</span><span class="token punctuation">(</span>User <span class="token keyword">memory</span><span class="token punctuation">)</span>
    
    <span class="token comment">/**
     * @dev 通过用户自发进行物资捐赠，向指定机构筹集公益物资
     * @param _orgAddress 指定机构的地址
     * @param _materDesc 捐赠物资的描述信息
     * @return 申请物资记录信息
    **/</span>
    <span class="token keyword">function</span> <span class="token function">raiseFunds</span><span class="token punctuation">(</span><span class="token builtin">address</span> _orgAddress<span class="token punctuation">,</span><span class="token builtin">string</span> <span class="token keyword">memory</span> _materDesc<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthUser <span class="token keyword">returns</span><span class="token punctuation">(</span>Material<span class="token punctuation">)</span>
    
    <span class="token comment">/**
     * 
     * @dev 用户签收指定交易下的捐赠物资，并更新相关的物流状态
     * @param _transactionId 待签收物资所属的交易ID
     * @param _meterialId 待签收的物资ID
     * 
    **/</span>
    <span class="token keyword">function</span> <span class="token function">signedGoods</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> _transactionId<span class="token punctuation">,</span><span class="token builtin">uint256</span> _meterialId<span class="token punctuation">)</span>
    
    
    <span class="token comment">/**
     * @dev 用户进行个人物资捐赠，并创建对应的物资捐赠交易记录
     * @param _orgAddress 捐赠的物资所属机构的地址
     * @param _toAddress 捐赠的物资目标地址
     * @param _meterName 捐赠物资名称
     * @param _isTransaport 是否需要运输：true-需要；false-不需要
     * @return 捐赠记录信息
    **/</span>
    <span class="token keyword">function</span> <span class="token function">donatedMaterial</span><span class="token punctuation">(</span><span class="token builtin">address</span> _orgAddress<span class="token punctuation">,</span><span class="token builtin">address</span> _toAddress<span class="token punctuation">,</span><span class="token builtin">string</span> <span class="token keyword">memory</span> _meterName<span class="token punctuation">,</span><span class="token builtin">bool</span> _isTransaport<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthUser <span class="token keyword">returns</span><span class="token punctuation">(</span>Transaction<span class="token punctuation">)</span>
    
    <span class="token comment">/**
     * @dev 用户进行个人金额捐赠，并创建对应的捐赠记录
     * @param _orgAddress 捐赠的公益慈善所属机构的地址
     * @param _toAddress 捐赠目标地址
     * @param _recordId 公益慈善记录 ID
     * @param _toAmount 捐赠的金额
     * @return 捐赠人的信息信息
    **/</span>
    <span class="token keyword">function</span> <span class="token function">donate</span><span class="token punctuation">(</span><span class="token builtin">address</span> _orgAddress <span class="token punctuation">,</span><span class="token builtin">address</span> _toAddress<span class="token punctuation">,</span><span class="token builtin">uint256</span> _recordId<span class="token punctuation">,</span><span class="token builtin">uint256</span> _toAmount<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthUser <span class="token keyword">returns</span><span class="token punctuation">(</span>Donor<span class="token punctuation">)</span>
    
    <span class="token comment">/**
     * @dev 用户发起公益慈善项目，并新增该项目的记录信息到平台
     * @param _orgAddress 公益慈善所属机构的地址
     * @param _amount 公益慈善筹款目标金额
     * @param _desc 公益慈善项目的描述信息
     * @return 发起公益慈善记录信息
    **/</span>
    <span class="token keyword">function</span> <span class="token function">initiate</span><span class="token punctuation">(</span><span class="token builtin">address</span> _orgAddress<span class="token punctuation">,</span><span class="token builtin">uint256</span> _amount<span class="token punctuation">,</span><span class="token builtin">string</span> _desc<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthUser <span class="token keyword">returns</span><span class="token punctuation">(</span>CharityRecord<span class="token punctuation">)</span>
    
    <span class="token comment">/**
     * @dev 确认发起公益时是否达到用户捐款等级的限制
     * @param _amount 用户在本次发起公益捐赠时选择的捐赠金额
    **/</span>
    <span class="token keyword">function</span> <span class="token function">checkLimitForInitiate</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> _amount<span class="token punctuation">)</span> 
    
    <span class="token comment">/**
     * @dev 用户通过查询指定机构的公益项目情况，然后进行取款操作
     * @param _orgAddress 机构所属地址
     * @param _recordId 需要提取资金的公益慈善记录 ID
     * @param _amount 需要提取的资金数量
     * @return (int256, address) 若成功提取资金，则返回状态码 0 及用户地址；否则返回错误状态码 -1 和空地址
    **/</span>
    <span class="token keyword">function</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token builtin">address</span> _orgAddress<span class="token punctuation">,</span><span class="token builtin">uint256</span> _recordId<span class="token punctuation">,</span><span class="token builtin">uint256</span> _amount<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthUser <span class="token keyword">returns</span><span class="token punctuation">(</span><span class="token builtin">int256</span><span class="token punctuation">,</span><span class="token builtin">address</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 用户查看当前的进度 更新所有的公益溯源变为已完成  后端使用定时器进行自动流</span>
    <span class="token keyword">function</span> <span class="token function">updateRecordPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment">/**
     * @dev 分页查询当前用户的捐赠记录
     * @param _page 需要查询的页数，从 1 开始计数
     * @param _pageSize 每页需要返回的记录数量
     * @return Donor[] 返回指定页码及每页数量的捐赠记录数组
    **/</span>
    <span class="token keyword">function</span> <span class="token function">queryUserDonorPage</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> _page<span class="token punctuation">,</span><span class="token builtin">uint256</span> _pageSize<span class="token punctuation">)</span> <span class="token keyword">public</span>  <span class="token keyword">returns</span><span class="token punctuation">(</span>Donor<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    
    <span class="token comment">/**
     * @dev 分页查询当前用户的公益记录
     * @param _page 需要查询的页数，从 1 开始计数
     * @param _pageSize 每页需要返回的记录数量
     * @return CharityRecord[] 返回指定页码及每页数量的公益记录数组
    **/</span>
    <span class="token keyword">function</span> <span class="token function">queryUserRecordPage</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> _page<span class="token punctuation">,</span><span class="token builtin">uint256</span> _pageSize<span class="token punctuation">)</span> <span class="token keyword">public</span>  <span class="token keyword">returns</span><span class="token punctuation">(</span>CharityRecord<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


    <span class="token comment">/**
     * @dev 分页查询当前用户的公益物资申请记录
     * @param _page 需要查询的页数，从 1 开始计数
     * @param _pageSize 每页需要返回的记录数量
     * @return Material[] 返回指定页码及每页数量的公益物资申请记录数组
    **/</span>
    <span class="token keyword">function</span> <span class="token function">queryUserMeterialPage</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> _page<span class="token punctuation">,</span><span class="token builtin">uint256</span> _pageSize<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">returns</span><span class="token punctuation">(</span>Material<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_7-2-机构接口"><a href="#_7-2-机构接口" class="header-anchor">#</a> 7.2 机构接口</h3> <p>如下是机构的主要接口：</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code>    <span class="token comment">// 注册慈善机构</span>
    <span class="token keyword">function</span> <span class="token function">registerOrg</span><span class="token punctuation">(</span><span class="token builtin">string</span> <span class="token keyword">memory</span> _orgName<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">returns</span><span class="token punctuation">(</span>Org <span class="token keyword">memory</span><span class="token punctuation">)</span>

    <span class="token comment">/**
     * @dev 查询指定机构的公益捐助交易信息（分页查询）
     * @param _orgAddress 机构地址
     * @param _page 查询的页数
     * @param _pageSize 每页的记录条数
     * @return 指定页码下的公益捐助交易信息数组
     * 
     **/</span>
    <span class="token keyword">function</span> <span class="token function">queryOrgTransactionPage</span><span class="token punctuation">(</span><span class="token builtin">address</span> _orgAddress<span class="token punctuation">,</span><span class="token builtin">uint256</span> _page<span class="token punctuation">,</span><span class="token builtin">uint256</span> _pageSize<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">view</span>  <span class="token keyword">returns</span><span class="token punctuation">(</span>Transaction<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 查询机构的详细信息</span>
    <span class="token keyword">function</span> <span class="token function">queryOrg</span><span class="token punctuation">(</span><span class="token builtin">address</span> _orgAddress<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">view</span> <span class="token keyword">returns</span><span class="token punctuation">(</span>Org <span class="token keyword">memory</span><span class="token punctuation">)</span>
    
</code></pre></div><h3 id="_7-3-物流商接口"><a href="#_7-3-物流商接口" class="header-anchor">#</a> 7.3 物流商接口</h3> <p>如下是物流商的主要接口：</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code>    
    <span class="token comment">// 注册物流公司</span>
    <span class="token keyword">function</span> <span class="token function">registerLogistics</span><span class="token punctuation">(</span><span class="token builtin">string</span> <span class="token keyword">memory</span> _logisticsName<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">returns</span><span class="token punctuation">(</span>Logistics<span class="token punctuation">)</span> 
    
    
    <span class="token comment">/**
     * @dev 物流公司进行物资发货操作
     * @param _transacionId 待发送的公益捐助交易 ID
     * @return 发送后的公益捐助交易信息
     *
     **/</span>
    <span class="token keyword">function</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> _transacionId<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthLogistic  <span class="token keyword">returns</span><span class="token punctuation">(</span>Transaction<span class="token punctuation">)</span>
</code></pre></div><h2 id="_8-合约详细"><a href="#_8-合约详细" class="header-anchor">#</a> 8.合约详细</h2> <p>合约的继承关系图：</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301050461.webp" alt="image-20230430105035276"></p> <h3 id="_8-1-用户注册业务"><a href="#_8-1-用户注册业务" class="header-anchor">#</a> 8.1 用户注册业务</h3> <p>​		在该合约中，通过创建一个名为 rolesAuth 的 Roles 对象，并调用其 addUser 函数，实现了用户注册时向该角色添加新用户的操作。在注册用户的时候会默认绑定用户的角色权限，有利于在后端进行判断。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">// 注册用户</span>
<span class="token keyword">function</span> <span class="token function">registerUser</span><span class="token punctuation">(</span><span class="token builtin">string</span> <span class="token keyword">memory</span> _userName<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">returns</span><span class="token punctuation">(</span>User <span class="token keyword">memory</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;当前用户已经注册&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userCount<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> _userId <span class="token operator">=</span> userCount<span class="token punctuation">;</span>
    User <span class="token keyword">storage</span> _user <span class="token operator">=</span> userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">;</span>
    _user<span class="token punctuation">.</span>userId <span class="token operator">=</span> _userId<span class="token punctuation">;</span>
    _user<span class="token punctuation">.</span>userName <span class="token operator">=</span> _userName<span class="token punctuation">;</span>
    _user<span class="token punctuation">.</span>userAddress <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    _user<span class="token punctuation">.</span>userAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    _user<span class="token punctuation">.</span>userLevel <span class="token operator">=</span> Level<span class="token punctuation">.</span>LEVEL_ONE<span class="token punctuation">;</span>
    _user<span class="token punctuation">.</span>userCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    _user<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    
    rolesAuth<span class="token punctuation">.</span><span class="token function">addUser</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">emit</span> <span class="token function">Registered</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> _user<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-2-用户申请物资业务"><a href="#_8-2-用户申请物资业务" class="header-anchor">#</a> 8.2 用户申请物资业务</h3> <p>​		用户可以向指定机构捐赠物资，并记录在链上，以便进行跟踪和查询。同时，该方法还会触发应用申请公益物资事件，通知其他相关方捐献信息的发生。公益慈善不仅限于捐款，发起人可以是用户或者是机构，我这里是用户发起公益活动，可以向灾区或者贫困地区捐赠物资，用户只需要通过我们的慈善公益平台申请该地区需要的物资，签收是本人。其他用户可以看到该公益活动，通过机构提供的物流商即可运送到灾区或者代收点地址。后端可以拿着这个订单做处理，包括接入物流系统等，以至于最后的物资溯源可以被用户查看到。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code>    <span class="token comment">/**
     * @dev 通过用户自发进行物资捐赠，向指定机构筹集公益物资
     * @param _orgAddress 指定机构的地址
     * @param _materDesc 捐赠物资的描述信息
     * @return 申请物资记录信息
    **/</span>
    <span class="token keyword">function</span> <span class="token function">raiseFunds</span><span class="token punctuation">(</span><span class="token builtin">address</span> _orgAddress<span class="token punctuation">,</span><span class="token builtin">string</span> <span class="token keyword">memory</span> _materDesc<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthUser <span class="token keyword">returns</span><span class="token punctuation">(</span>Material<span class="token punctuation">)</span><span class="token punctuation">{</span>
        
        materialCount<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token builtin">uint256</span> _materialId <span class="token operator">=</span> materialCount<span class="token punctuation">;</span>
        Material <span class="token keyword">storage</span> _material <span class="token operator">=</span> meterialMap<span class="token punctuation">[</span>_materialId<span class="token punctuation">]</span><span class="token punctuation">;</span>
        _material<span class="token punctuation">.</span>meteriaId <span class="token operator">=</span> _materialId<span class="token punctuation">;</span>
        _material<span class="token punctuation">.</span>meterialdesc  <span class="token operator">=</span> _materDesc<span class="token punctuation">;</span>
        _material<span class="token punctuation">.</span>srcAddress <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
        _material<span class="token punctuation">.</span>orgAddress <span class="token operator">=</span> _orgAddress<span class="token punctuation">;</span>
        
        meterials<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_materialId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">.</span>materialList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_materialId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        orgMap<span class="token punctuation">[</span>_orgAddress<span class="token punctuation">]</span><span class="token punctuation">.</span>meterials<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_materialId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">emit</span> <span class="token function">RaiseFunds</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span>_materDesc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> _material<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-3-用户捐赠物资业务"><a href="#_8-3-用户捐赠物资业务" class="header-anchor">#</a> 8.3 用户捐赠物资业务</h3> <p>​		用户可以向指定机构或个人捐赠物资，并创建一条与此相关的交易记录，并将其存储在链上以便日后跟踪和查询。同时，该方法还会触发捐赠物资事件，通知物流商捐献信息的发生。为公益慈善提供更加透明、高效的捐赠渠道，帮助有需要的人们获得更多的援助与帮助。用户通过代理机构进行物资的捐赠之后，产生的订单会通知物流商，物流商则会帮忙运输物资到指定灾区或者签收人地点。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">/**
 * @dev 用户进行个人物资捐赠，并创建对应的物资捐赠交易记录
 * @param _orgAddress 捐赠的物资所属机构的地址
 * @param _toAddress 捐赠的物资目标地址
 * @param _meterName 捐赠物资名称
 * @param _isTransaport 是否需要运输：true-需要；false-不需要
 * @return 捐赠记录信息
**/</span>
<span class="token keyword">function</span> <span class="token function">donatedMaterial</span><span class="token punctuation">(</span><span class="token builtin">address</span> _orgAddress<span class="token punctuation">,</span><span class="token builtin">address</span> _toAddress<span class="token punctuation">,</span><span class="token builtin">string</span> <span class="token keyword">memory</span> _meterName<span class="token punctuation">,</span><span class="token builtin">bool</span> _isTransaport<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthUser <span class="token keyword">returns</span><span class="token punctuation">(</span>Transaction<span class="token punctuation">)</span><span class="token punctuation">{</span>
    transactionCount<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> _transactionId <span class="token operator">=</span> transactionCount<span class="token punctuation">;</span>
    Transaction <span class="token keyword">storage</span> _transaction <span class="token operator">=</span> transactionMap<span class="token punctuation">[</span>_transactionId<span class="token punctuation">]</span><span class="token punctuation">;</span>
    _transaction<span class="token punctuation">.</span>transactionId <span class="token operator">=</span> _transactionId<span class="token punctuation">;</span>
    _transaction<span class="token punctuation">.</span>transactionTitle <span class="token operator">=</span> <span class="token string">&quot;物资捐赠&quot;</span><span class="token punctuation">;</span>
    _transaction<span class="token punctuation">.</span>orgAddress <span class="token operator">=</span> _orgAddress<span class="token punctuation">;</span>
    _transaction<span class="token punctuation">.</span>descAddress <span class="token operator">=</span> _toAddress<span class="token punctuation">;</span>
    _transaction<span class="token punctuation">.</span>meterialName <span class="token operator">=</span> _meterName<span class="token punctuation">;</span>
    _transaction<span class="token punctuation">.</span>isTransport <span class="token operator">=</span> _isTransaport<span class="token punctuation">;</span>
    _transaction<span class="token punctuation">.</span>transacStatus <span class="token operator">=</span> TransacStatus<span class="token punctuation">.</span>SHIPMENT<span class="token punctuation">;</span>
    _transaction<span class="token punctuation">.</span>sources<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _transaction<span class="token punctuation">.</span>sources<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_orgAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">.</span>userCount<span class="token operator">++</span><span class="token punctuation">;</span>
    transactions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_transactionId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    orgMap<span class="token punctuation">[</span>_orgAddress<span class="token punctuation">]</span><span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_transactionId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">emit</span> <span class="token function">DonatedMaterial</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span>_toAddress<span class="token punctuation">,</span>_meterName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> _transaction<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-4-物流运输业务"><a href="#_8-4-物流运输业务" class="header-anchor">#</a> 8.4 物流运输业务</h3> <p>​		解决了公益慈善中的“如何让物流公司过程更高效、透明、安全”的应用场景的痛点。物流公司可以实时更新捐赠物资的状态以及提供更多可追溯的信息，例如捐赠物资发运的时间和地点等。这将有助于增加物流过程的透明度和安全性，并使公众更有信心向公益慈善活动贡献自己的物力和智力。这里的return的返回是物流信息不存在，对后端的处理。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">/**
 * @dev 物流公司进行物资发货操作
 * @param _transacionId 待发送的公益捐助交易 ID
 * @return 发送后的公益捐助交易信息
 *
 **/</span>
<span class="token keyword">function</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> _transacionId<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthLogistic  <span class="token keyword">returns</span><span class="token punctuation">(</span>Transaction<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>transactionMap<span class="token punctuation">[</span>_transacionId<span class="token punctuation">]</span><span class="token punctuation">.</span>transacStatus <span class="token operator">==</span> TransacStatus<span class="token punctuation">.</span>SHIPMENT<span class="token punctuation">,</span><span class="token string">&quot;当前物流未出货&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>transactionMap<span class="token punctuation">[</span>_transacionId<span class="token punctuation">]</span><span class="token punctuation">.</span>isTransport<span class="token punctuation">)</span><span class="token punctuation">{</span>
        Transaction <span class="token keyword">storage</span> _transacion <span class="token operator">=</span> transactionMap<span class="token punctuation">[</span>_transacionId<span class="token punctuation">]</span><span class="token punctuation">;</span> 
        _transacion<span class="token punctuation">.</span>transacStatus <span class="token operator">=</span> TransacStatus<span class="token punctuation">.</span>LOGISTICS<span class="token punctuation">;</span>
        _transacion<span class="token punctuation">.</span>sources<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">emit</span> <span class="token function">Dispathed</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span>_transacionId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> _transacion<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-5-用户签收物资业务"><a href="#_8-5-用户签收物资业务" class="header-anchor">#</a> 8.5 用户签收物资业务</h3> <p>​		用户可以在指定交易 ID 下签收相应的捐赠物资，并将其状态更改为已签收(TransacStatus.SIGNFOR)。同时，该方法还将更新该捐赠物资的最新持有者为当前用户，并在此基础上提高链上跟踪可追溯性。这帮助公益慈善组织、志愿者等相关方及时掌握捐赠物资的去向和使用情况，提高捐赠效率和公信力。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">/**
 * 
 * @dev 用户签收指定交易下的捐赠物资，并更新相关的物流状态
 * @param _transactionId 待签收物资所属的交易ID
 * @param _meterialId 待签收的物资ID
 * 
**/</span>
<span class="token keyword">function</span> <span class="token function">signedGoods</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> _transactionId<span class="token punctuation">,</span><span class="token builtin">uint256</span> _meterialId<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthUser <span class="token punctuation">{</span>
    Transaction <span class="token keyword">storage</span> _transaction <span class="token operator">=</span> transactionMap<span class="token punctuation">[</span>_transactionId<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>_transaction<span class="token punctuation">.</span>transacStatus <span class="token operator">==</span> TransacStatus<span class="token punctuation">.</span>LOGISTICS<span class="token punctuation">,</span><span class="token string">&quot;当前物资未更新物流状态&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _transaction<span class="token punctuation">.</span>transacStatus <span class="token operator">=</span> TransacStatus<span class="token punctuation">.</span>SIGNFOR<span class="token punctuation">;</span>
    _transaction<span class="token punctuation">.</span>sources<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 更新当前的用户的物资</span>
    meterialMap<span class="token punctuation">[</span>_meterialId<span class="token punctuation">]</span><span class="token punctuation">.</span>meterialNames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_transaction<span class="token punctuation">.</span>meterialName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">emit</span> <span class="token function">SigneFor</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span>_transactionId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-6-用户发起公益捐款业务"><a href="#_8-6-用户发起公益捐款业务" class="header-anchor">#</a> 8.6 用户发起公益捐款业务</h3> <p>​		该方法解决了公益慈善中的“如何便捷地发起公益慈善项目，并将其记录到平台”和“如何限制用户在对应等级的金额数量，以保证公益慈善活动的透明度与可行性”的应用场景。公益慈善机构或个人可以在平台上发起公益慈善项目，并设定项目筹资目标金额及相关描述信息。该方法将对用户账户进行等级限制，不可篡改用户的筹资金额。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">/**
 * @dev 用户发起公益慈善项目，并新增该项目的记录信息到平台
 * @param _orgAddress 公益慈善所属机构的地址
 * @param _amount 公益慈善筹款目标金额
 * @param _desc 公益慈善项目的描述信息
 * @return 发起公益慈善记录信息
**/</span>
<span class="token keyword">function</span> <span class="token function">initiate</span><span class="token punctuation">(</span><span class="token builtin">address</span> _orgAddress<span class="token punctuation">,</span><span class="token builtin">uint256</span> _amount<span class="token punctuation">,</span><span class="token builtin">string</span> _desc<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthUser <span class="token keyword">returns</span><span class="token punctuation">(</span>CharityRecord<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 判断当前的用户是否存在 </span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">.</span>status <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;当前用户未注册&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 确认是否达到用户捐款等级的限制</span>
    <span class="token function">checkLimitForInitiate</span><span class="token punctuation">(</span>_amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 新增公益记录，并设置其属性</span>
    recordCount<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> _recordId <span class="token operator">=</span> recordCount<span class="token punctuation">;</span>  
    CharityRecord <span class="token keyword">storage</span> _charityRecord <span class="token operator">=</span> recordMap<span class="token punctuation">[</span>_recordId<span class="token punctuation">]</span><span class="token punctuation">;</span>
    _charityRecord<span class="token punctuation">.</span>recordId <span class="token operator">=</span> _recordId<span class="token punctuation">;</span>
    _charityRecord<span class="token punctuation">.</span>recordAmount <span class="token operator">=</span> _amount<span class="token punctuation">;</span>
    _charityRecord<span class="token punctuation">.</span>overAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    _charityRecord<span class="token punctuation">.</span>srcUser <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    _charityRecord<span class="token punctuation">.</span>descCharitable <span class="token operator">=</span> _desc<span class="token punctuation">;</span>
    _charityRecord<span class="token punctuation">.</span>recordOrg <span class="token operator">=</span>_orgAddress<span class="token punctuation">;</span>
    _charityRecord<span class="token punctuation">.</span>recordTime <span class="token operator">=</span> block<span class="token punctuation">.</span>timestamp<span class="token punctuation">;</span>
    _charityRecord<span class="token punctuation">.</span>recordStatus <span class="token operator">=</span> CharityStatus<span class="token punctuation">.</span>CROWDFUNDING<span class="token punctuation">;</span>
    
    chatityRecords<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_recordId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">.</span>recordList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_recordId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    orgMap<span class="token punctuation">[</span>_orgAddress<span class="token punctuation">]</span><span class="token punctuation">.</span>recordIds<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_recordId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">emit</span> <span class="token function">Initiate</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span>_recordId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> _charityRecord<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @dev 确认发起公益时是否达到用户捐款等级的限制
 * @param _amount 用户在本次发起公益捐赠时选择的筹资金额
**/</span>
<span class="token keyword">function</span> <span class="token function">checkLimitForInitiate</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> _amount<span class="token punctuation">)</span> <span class="token keyword">private</span> <span class="token keyword">view</span> <span class="token punctuation">{</span>
    Level _level <span class="token operator">=</span> <span class="token function">queryUserLevel</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> _levelLimit<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_level <span class="token operator">==</span> Level<span class="token punctuation">.</span>LEVEL_ONE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _levelLimit <span class="token operator">=</span> LEVEL_ONE_LIMIT<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_level <span class="token operator">==</span> Level<span class="token punctuation">.</span>LEVEL_TWO<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _levelLimit <span class="token operator">=</span> LEVEL_TWO_LIMIT<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_level <span class="token operator">==</span> Level<span class="token punctuation">.</span>LEVEL_THREE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _levelLimit <span class="token operator">=</span> LEVEL_THREE_LIMIT<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>_amount <span class="token operator">&lt;=</span> _levelLimit<span class="token punctuation">,</span> <span class="token string">&quot;发起公益捐款金额超过等级限制&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-6-用户公益捐款业务"><a href="#_8-6-用户公益捐款业务" class="header-anchor">#</a> 8.6 用户公益捐款业务</h3> <p>​		用户可以在指定公益机构下进行个人金额捐赠，并创建对应的捐赠记录。该方法将自动检查用户账户余额是否充足，并将捐赠金额从用户账户中扣除。此外，还将自动更新相应的机构账户和目标地址的收款信息。注意，这里捐款也是直接账户转入代理机构，不会直接落入对方用户的账户里面，取钱也是直接通过代理机构进行取钱。</p> <p>​		有助于提高公众参与公益慈善的积极性和成就感，增强公益慈善的正面能量。同时，也由于具备区块链的去中心化和不可篡改特性，避免了大规模善款管理中的信任危机和数据隐私泄露问题，进一步提高了公众对公益慈善活动的信心与支持。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">/**
 * @dev 用户进行个人金额捐赠，并创建对应的捐赠记录
 * @param _orgAddress 捐赠的公益慈善所属机构的地址
 * @param _toAddress 捐赠目标地址
 * @param _recordId 公益慈善记录 ID
 * @param _toAmount 捐赠的金额
 * @return 捐赠人的信息信息
**/</span>
<span class="token keyword">function</span> <span class="token function">donate</span><span class="token punctuation">(</span><span class="token builtin">address</span> _orgAddress <span class="token punctuation">,</span><span class="token builtin">address</span> _toAddress<span class="token punctuation">,</span><span class="token builtin">uint256</span> _recordId<span class="token punctuation">,</span><span class="token builtin">uint256</span> _toAmount<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthUser <span class="token keyword">returns</span><span class="token punctuation">(</span>Donor<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 判断当前的用户是否存在 </span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">.</span>status <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;当前用户未注册&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 判断当前的用户是否有足够的金额捐赠</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">.</span>userAmount <span class="token operator">&gt;=</span> _toAmount<span class="token punctuation">,</span><span class="token string">&quot;当前账户余额不足&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 对用户的账户进行计算</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>recordMap<span class="token punctuation">[</span>_recordId<span class="token punctuation">]</span><span class="token punctuation">.</span>recordStatus <span class="token operator">==</span> CharityStatus<span class="token punctuation">.</span>CROWDFUNDING<span class="token punctuation">,</span><span class="token string">&quot;暂无公益捐赠&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CharityRecord <span class="token keyword">storage</span> _charityRecord <span class="token operator">=</span> recordMap<span class="token punctuation">[</span>_recordId<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> finishAmount <span class="token operator">=</span> SafeMath<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>_charityRecord<span class="token punctuation">.</span>overAmount<span class="token punctuation">,</span>_toAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_charityRecord<span class="token punctuation">.</span>overAmount <span class="token operator">==</span> _charityRecord<span class="token punctuation">.</span>recordAmount <span class="token operator">||</span> finishAmount <span class="token operator">&gt;</span> _charityRecord<span class="token punctuation">.</span>recordAmount<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">revert</span><span class="token punctuation">(</span><span class="token string">&quot;当前公益慈善已完成&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">checkOrgIsIn</span><span class="token punctuation">(</span>_orgAddress<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        donorCount<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token builtin">uint256</span> _donorId <span class="token operator">=</span> donorCount<span class="token punctuation">;</span>
        Donor <span class="token keyword">storage</span> _donor <span class="token operator">=</span> donorMap<span class="token punctuation">[</span>_donorId<span class="token punctuation">]</span><span class="token punctuation">;</span>
        _donor<span class="token punctuation">.</span>donorId <span class="token operator">=</span> _donorId<span class="token punctuation">;</span>
        _donor<span class="token punctuation">.</span>donorAmount <span class="token operator">=</span> _toAmount<span class="token punctuation">;</span>
        _donor<span class="token punctuation">.</span>donorAddress <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
        _donor<span class="token punctuation">.</span>donorToAddress <span class="token operator">=</span> _toAddress<span class="token punctuation">;</span>
        _donor<span class="token punctuation">.</span>donorToOrg <span class="token operator">=</span> _orgAddress<span class="token punctuation">;</span>
        _donor<span class="token punctuation">.</span>donorTime <span class="token operator">=</span> block<span class="token punctuation">.</span>timestamp<span class="token punctuation">;</span>
        <span class="token comment">// 更新用户的捐赠记录 </span>
        userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">.</span>donorList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_donorId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">.</span>userCount<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>_charityRecord<span class="token punctuation">.</span>recordStatus <span class="token operator">==</span> CharityStatus<span class="token punctuation">.</span>CROWDFUNDING<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            _charityRecord<span class="token punctuation">.</span>overAmount <span class="token operator">=</span> SafeMath<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>_charityRecord<span class="token punctuation">.</span>overAmount<span class="token punctuation">,</span>_toAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
            _charityRecord<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 更新机构的金额</span>
            orgMap<span class="token punctuation">[</span>_orgAddress<span class="token punctuation">]</span><span class="token punctuation">.</span>orgAmount <span class="token operator">=</span> SafeMath<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>orgMap<span class="token punctuation">[</span>_orgAddress<span class="token punctuation">]</span><span class="token punctuation">.</span>orgAmount<span class="token punctuation">,</span>_toAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">emit</span> <span class="token function">Donate</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span>_toAddress<span class="token punctuation">,</span>_toAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> _donor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-7-用户取款业务"><a href="#_8-7-用户取款业务" class="header-anchor">#</a> 8.7 用户取款业务</h3> <p>​		用户可以查询目标机构下已发起的公益项目信息，并选择需要提取资金的公益慈善记录ID及对应金额数量，将其提取到自己的账户中。同时，该方法会校验当前用户是否为捐赠该笔公益项目的发起者，并确认目标机构与公益项目记录是否匹配，从而保障资金的安全性和透明度。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">/**
 * @dev 用户通过查询指定机构的公益项目情况，然后进行取款操作
 * @param _orgAddress 机构所属地址
 * @param _recordId 需要提取资金的公益慈善记录 ID
 * @param _amount 需要提取的资金数量
 * @return (int256, address) 若成功提取资金，则返回状态码 0 及用户地址；否则返回错误状态码 -1 和空地址
**/</span>
<span class="token keyword">function</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token builtin">address</span> _orgAddress<span class="token punctuation">,</span><span class="token builtin">uint256</span> _recordId<span class="token punctuation">,</span><span class="token builtin">uint256</span> _amount<span class="token punctuation">)</span> <span class="token keyword">public</span> _AuthUser <span class="token keyword">returns</span><span class="token punctuation">(</span><span class="token builtin">int256</span><span class="token punctuation">,</span><span class="token builtin">address</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token function">checkOrgIsIn</span><span class="token punctuation">(</span>_orgAddress<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token string">&quot;当前的机构不存在&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 查询当前的Record记录是否存在当前的地址</span>
    CharityRecord <span class="token keyword">memory</span> _charityRecord <span class="token operator">=</span> recordMap<span class="token punctuation">[</span>_recordId<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_charityRecord<span class="token punctuation">.</span>recordStatus <span class="token operator">==</span> CharityStatus<span class="token punctuation">.</span>ERROR<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">revert</span><span class="token punctuation">(</span><span class="token string">&quot;当前的公益状态异常&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_charityRecord<span class="token punctuation">.</span>srcUser <span class="token operator">==</span> msg<span class="token punctuation">.</span>sender <span class="token operator">&amp;&amp;</span> _charityRecord<span class="token punctuation">.</span>recordOrg <span class="token operator">==</span> _orgAddress<span class="token punctuation">)</span><span class="token punctuation">{</span>
        userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">.</span>userAmount <span class="token operator">=</span> SafeMath<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">.</span>userAmount<span class="token punctuation">,</span>_amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        orgMap<span class="token punctuation">[</span>_orgAddress<span class="token punctuation">]</span><span class="token punctuation">.</span>orgAmount <span class="token operator">=</span> SafeMath<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>orgMap<span class="token punctuation">[</span>_orgAddress<span class="token punctuation">]</span><span class="token punctuation">.</span>orgAmount<span class="token punctuation">,</span>_amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">emit</span> <span class="token function">Withdraw</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span>_amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-8-用户更新所有公益状态业务"><a href="#_8-8-用户更新所有公益状态业务" class="header-anchor">#</a> 8.8  用户更新所有公益状态业务</h3> <p>​		用户可以查询自己参与过的所有公益项目记录，并且根据项目已筹资金额与目标筹资金额之间的关系，将筹资进度处于已完成状态的公益项目状态变更为已完成。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">// 用户查看当前的进度 更新所有的公益溯源变为已完成  后端使用定时器</span>
<span class="token keyword">function</span> <span class="token function">updateRecordPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    User <span class="token keyword">memory</span> _user <span class="token operator">=</span> userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token builtin">uint256</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">memory</span> recordListArr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">uint256</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_user<span class="token punctuation">.</span>recordList<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token builtin">uint</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> chatityRecords<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">require</span><span class="token punctuation">(</span>_user<span class="token punctuation">.</span>recordList<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;当前用户没有公益记录&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>recordMap<span class="token punctuation">[</span>chatityRecords<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>recordId <span class="token operator">==</span> _user<span class="token punctuation">.</span>recordList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            recordListArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> _user<span class="token punctuation">.</span>recordList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token builtin">uint</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> recordListArr<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>recordMap<span class="token punctuation">[</span>recordListArr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>overAmount <span class="token operator">==</span> recordMap<span class="token punctuation">[</span>recordListArr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>recordAmount<span class="token punctuation">)</span><span class="token punctuation">{</span>
            recordMap<span class="token punctuation">[</span>recordListArr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>recordStatus <span class="token operator">=</span> CharityStatus<span class="token punctuation">.</span>FINISHED<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">emit</span> <span class="token function">UpdateRecordPage</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-9-用户分页查询捐赠记录业务"><a href="#_8-9-用户分页查询捐赠记录业务" class="header-anchor">#</a> 8.9 用户分页查询捐赠记录业务</h3> <p>​		用户可以通过指定页数及每页显示数量的方式来查询自己的捐赠记录，并返回一个指定页码范围内的包含所有捐赠记录的数组，方便用户进行查看和管理。避免用户一次性查询所有导致接口缓慢，消耗极大的gas。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">/**
 * @dev 分页查询当前用户的捐赠记录
 * @param _page 需要查询的页数，从 1 开始计数
 * @param _pageSize 每页需要返回的记录数量
 * @return Donor[] 返回指定页码及每页数量的捐赠记录数组
**/</span>
<span class="token keyword">function</span> <span class="token function">queryUserDonorPage</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> _page<span class="token punctuation">,</span><span class="token builtin">uint256</span> _pageSize<span class="token punctuation">)</span> <span class="token keyword">public</span>  <span class="token keyword">returns</span><span class="token punctuation">(</span>Donor<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    User <span class="token keyword">memory</span> _user <span class="token operator">=</span> userMap<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>_user<span class="token punctuation">.</span>donorList<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;当前没有捐赠记录&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>_page <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;页数不能为0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> startIndex <span class="token operator">=</span> <span class="token punctuation">(</span>_page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> _pageSize<span class="token punctuation">;</span> <span class="token comment">// 计算起始索引</span>
    <span class="token builtin">uint256</span> endIndex <span class="token operator">=</span> startIndex <span class="token operator">+</span> _pageSize <span class="token operator">&gt;</span> _user<span class="token punctuation">.</span>donorList<span class="token punctuation">.</span>length <span class="token operator">?</span>  _user<span class="token punctuation">.</span>donorList<span class="token punctuation">.</span>length <span class="token punctuation">:</span> startIndex <span class="token operator">+</span> _pageSize<span class="token punctuation">;</span> <span class="token comment">// 计算结束索引</span>
    Donor<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">memory</span> donorArr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Donor</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>endIndex <span class="token operator">-</span> startIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token builtin">uint</span> i <span class="token operator">=</span> startIndex<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> endIndex<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        donorArr<span class="token punctuation">[</span>i <span class="token operator">-</span> startIndex<span class="token punctuation">]</span> <span class="token operator">=</span> donorMap<span class="token punctuation">[</span>_user<span class="token punctuation">.</span>donorList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> donorArr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_9-合约业务测试"><a href="#_9-合约业务测试" class="header-anchor">#</a> 9.合约业务测试</h2> <h3 id="_9-1-测试用户"><a href="#_9-1-测试用户" class="header-anchor">#</a> 9.1 测试用户</h3> <ul><li><code>Org</code>： 机构测试地址</li> <li><code>Logistic</code>： 物流商测试地址</li> <li><code>User1</code>： 发起公益用户测试地址</li> <li><code>User2</code>： 参与公益用户测试地址</li></ul> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301053557.webp" alt="image-20230430105339328"></p> <h3 id="_9-2-公益捐款活动业务"><a href="#_9-2-公益捐款活动业务" class="header-anchor">#</a> 9.2 公益捐款活动业务</h3> <p>1.这里需要注意的是，直接使用Org机构地址部署合约，默认创建一个机构。</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301053788.webp" alt="image-20230430105302464"></p> <p>2.注册用户为张三、李四、王五。</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301054326.webp" alt="image-20230430105455160"></p> <p>2.注册一个物流默认公司名为物流公司。</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301056828.webp" alt="image-20230430105609714"></p> <p>3.使用User1的账户调用<code>initiate</code>函数发起一个灾区公益捐款活动，需要的资金为1000。</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301057541.webp" alt="image-20230430105727609"></p> <p>得到的回执数据：</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0xb92D76138d2EB560e601fCd9ca8959F9aa032dd9</span><span class="token punctuation">,</span>灾区地震<span class="token punctuation">,</span><span class="token number">0xD78861dE66298Ec2864Dc83480078E015e4Edccc</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1682823358418</span><span class="token punctuation">,</span>
</code></pre></div><p>4.使用User2调用<code>donate</code>函数向User1发起的公益活动捐款<code>1000</code>。</p> <ul><li>指定机构</li> <li>指定对方地址</li></ul> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301059740.webp" alt="image-20230430105921595"></p> <p>得到的回执数据：</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token number">1</span><span class="token punctuation">,</span>
<span class="token number">1000</span><span class="token punctuation">,</span>
<span class="token number">0x3B1917a4d79258688252217f33C5375E97118F68</span><span class="token punctuation">,</span>
<span class="token number">0xb92D76138d2EB560e601fCd9ca8959F9aa032dd9</span><span class="token punctuation">,</span>
<span class="token number">0xD78861dE66298Ec2864Dc83480078E015e4Edccc</span><span class="token punctuation">,</span>
<span class="token number">1682823471041</span>
</code></pre></div><p>5.User1调用<code>updateRecordPage</code>函数，刷新自己的所有公益捐款活动的进度。</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301100110.webp" alt="image-20230430110034971"></p> <p>6.查询当前的公益捐款进度。</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301110518.webp" alt="image-20230430111056375"></p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token number">1</span><span class="token punctuation">,</span>
<span class="token number">1000</span><span class="token punctuation">,</span>
<span class="token number">1000</span><span class="token punctuation">,</span>
<span class="token number">0xb92D76138d2EB560e601fCd9ca8959F9aa032dd9</span><span class="token punctuation">,</span>
灾区地震<span class="token punctuation">,</span>
<span class="token number">0xD78861dE66298Ec2864Dc83480078E015e4Edccc</span><span class="token punctuation">,</span>
<span class="token number">1</span><span class="token punctuation">,</span>										      <span class="token comment">// 已完成状态</span>
<span class="token number">1682824128562</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0x3B1917a4d79258688252217f33C5375E97118F68</span><span class="token punctuation">]</span>  <span class="token comment">// 捐赠人</span>
</code></pre></div><p>7.User1是发起人，公益捐款活动完成，调用<code>withdraw</code>函数取款。</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301114154.webp" alt="image-20230430111452038"></p> <p>8.调用<code>queryUserInfo</code>函数查询用户详细信息。</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301116065.webp" alt="image-20230430111624958"></p> <p>如下回执可以查看，账户已有1000元。</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301116632.webp" alt="image-20230430111604459"></p> <h3 id="_9-3-公益物资捐赠业务"><a href="#_9-3-公益物资捐赠业务" class="header-anchor">#</a> 9.3 公益物资捐赠业务</h3> <p>1.User1用户调用<code>raiseFunds</code>函数即可发起公益捐赠物资活动。</p> <ul><li>指定Org机构</li></ul> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301119670.webp" alt="image-20230430111949535"></p> <p>2.User2指定机构和签收人地址，调用<code>donatedMaterial</code>函数捐赠物资。</p> <ul><li>指定Org机构</li> <li>指定签收人地址</li></ul> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301120689.webp" alt="image-20230430112042538"></p> <p>如下是回执信息。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token number">1</span><span class="token punctuation">,</span>
物资捐赠<span class="token punctuation">,</span>
<span class="token number">0xD78861dE66298Ec2864Dc83480078E015e4Edccc</span><span class="token punctuation">,</span>
<span class="token number">0xb92D76138d2EB560e601fCd9ca8959F9aa032dd9</span><span class="token punctuation">,</span>
方便面<span class="token punctuation">,</span>
<span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token number">0</span><span class="token punctuation">,</span>																						 <span class="token comment">// 物流状态</span>
<span class="token punctuation">[</span><span class="token number">0x3B1917a4d79258688252217f33C5375E97118F68</span><span class="token punctuation">,</span><span class="token number">0xD78861dE66298Ec2864Dc83480078E015e4Edccc</span><span class="token punctuation">]</span>  <span class="token comment">// 物资的溯源地址</span>
</code></pre></div><p>3.物流商收到新的订单通知，调用<code>dispath</code>函数对物资进行下一步运输 。</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301122523.webp" alt="image-20230430112213311"></p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token number">1</span><span class="token punctuation">,</span>
物资捐赠<span class="token punctuation">,</span>
<span class="token number">0xD78861dE66298Ec2864Dc83480078E015e4Edccc</span><span class="token punctuation">,</span>
<span class="token number">0xb92D76138d2EB560e601fCd9ca8959F9aa032dd9</span><span class="token punctuation">,</span>
方便面<span class="token punctuation">,</span>
<span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token number">1</span><span class="token punctuation">,</span>								<span class="token comment">// 运输中</span>
<span class="token punctuation">[</span><span class="token number">0x3B1917a4d79258688252217f33C5375E97118F68</span><span class="token punctuation">,</span><span class="token number">0xD78861dE66298Ec2864Dc83480078E015e4Edccc</span><span class="token punctuation">,</span><span class="token number">0x52eE11b761040cfa3f303c6b3799b78621481184</span><span class="token punctuation">]</span>								<span class="token comment">// 添加了寄送人地址 机构地址 物流地址</span>
</code></pre></div><p>4.User1用户，收到物资之后，调用<code>signedGoods</code>函数对物资进行签收处理。</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301123605.webp" alt="image-20230430112355481"></p> <p><code>queryUserMeterialPage</code>函数可以对当前用户所发起的公益活动查看历史记录，查看当前申请的物资捐赠人寄送，签收后可以查看有哪些物资。</p> <p><img src="https://blog-1304715799.cos.ap-nanjing.myqcloud.com/imgs/202304301124793.webp" alt="image-20230430112422622"></p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token number">1</span><span class="token punctuation">,</span>
扶贫——四川<span class="token punctuation">,</span>
<span class="token number">0xb92D76138d2EB560e601fCd9ca8959F9aa032dd9</span><span class="token punctuation">,</span>
<span class="token number">0xD78861dE66298Ec2864Dc83480078E015e4Edccc</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span>方便面<span class="token punctuation">]</span>
</code></pre></div></div></div> <!----> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/CodeVault/pages/685f1f/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">企业碳排放解决方案合约案例</div></a> <a href="/CodeVault/pages/cc43be/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">RawTransaction优化</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/CodeVault/pages/685f1f/" class="prev">企业碳排放解决方案合约案例</a></span> <span class="next"><a href="/CodeVault/pages/cc43be/">RawTransaction优化</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/CodeVault/archives" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/CodeVault/pages/c936ca/"><div>
            学习文档
            <!----></div></a> <span class="date">11-28</span></dt></dl><dl><dd>02</dd> <dt><a href="/CodeVault/pages/53f082/"><div>
            如何成为FISCO社区的MVP 总结篇
            <!----></div></a> <span class="date">11-28</span></dt></dl><dl><dd>03</dd> <dt><a href="/CodeVault/pages/3d3086/"><div>
            一文搞懂Truffle测试
            <!----></div></a> <span class="date">11-28</span></dt></dl> <dl><dd></dd> <dt><a href="/CodeVault/archives" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:894072666@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/xugaoyi" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2023
    <span>YYzop & Hior | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/CodeVault/assets/js/app.ef278985.js" defer></script><script src="/CodeVault/assets/js/2.f96441c8.js" defer></script><script src="/CodeVault/assets/js/225.03a64323.js" defer></script>
  </body>
</html>
